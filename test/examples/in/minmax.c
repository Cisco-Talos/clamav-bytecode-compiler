VIRUSNAME_PREFIX("BC.testminmax")
TARGET(1)

/* Only load this on post 096 */
FUNCTIONALITY_LEVEL_MIN(FUNC_LEVEL_096_dev)

SIGNATURES_DECL_BEGIN
DECLARE_SIGNATURE(USER32_VI)
DECLARE_SIGNATURE(MSCORP_VI)
DECLARE_SIGNATURE(USER32_NOVI)
DECLARE_SIGNATURE(MSCORP_NOVI)
DECLARE_SIGNATURE(APPINIT)
SIGNATURES_DECL_END

SIGNATURES_DEF_BEGIN
DEFINE_SIGNATURE(USER32_VI,
"VI:49006e007400650072006e0061006c004e0061006d006500000075007300650072003300")
DEFINE_SIGNATURE(MSCORP_VI,
"VI:43006f006d00700061006e0079004e0061006d006500000000004d006900630072006f0073006f0066007400200043006f00720070006f007200610074006900")
DEFINE_SIGNATURE(USER32_NOVI,
"*:49006e007400650072006e0061006c004e0061006d006500000075007300650072003300")
DEFINE_SIGNATURE(MSCORP_NOVI,
"*:43006f006d00700061006e0079004e0061006d006500000000004d006900630072006f0073006f0066007400200043006f00720070006f007200610074006900")
DEFINE_SIGNATURE(APPINIT,
"*:41007000700049006e00690074005f0044004c004c00730000")
SIGNATURES_END

PE_UNPACKER_DECLARE

bool logical_trigger(void) {
    return ((matches(Signatures.USER32_VI) && matches(Signatures.MSCORP_VI)) ||
(matches(Signatures.USER32_NOVI) && matches(Signatures.MSCORP_NOVI))) &&
!matches(Signatures.APPINIT);
}

int entrypoint()
{
  debug("bytecode executed!");
  return 0;
}
