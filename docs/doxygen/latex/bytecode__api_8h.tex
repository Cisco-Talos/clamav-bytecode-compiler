\hypertarget{bytecode__api_8h}{
\subsection{bytecode\_\-api.h File Reference}
\label{bytecode__api_8h}\index{bytecode\_\-api.h@{bytecode\_\-api.h}}
}
\subsubsection*{Enumerations}
\begin{DoxyCompactItemize}
\item 
enum \hyperlink{bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91}{BytecodeKind} \{ \hyperlink{bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91aff84fbd05d167a1cf9e146d155ac90b7}{BC\_\-GENERIC} = 0
, \hyperlink{bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91aa6c849ba6dbd80a2af04a38eeea8d5c3}{BC\_\-LOGICAL} = 256, 
\hyperlink{bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91ae6b6910f9706526e49807a022b7125f1}{BC\_\-PE\_\-UNPACKER}
 \}
\item 
enum \hyperlink{bytecode__api_8h_ac2cd51dc61c1ddf642d596c7f73a6999}{FunctionalityLevels} 
\item 
enum \{ \hyperlink{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7a7f53e3798ec48e79c0897ba5138f9b05}{SEEK\_\-SET} = 0, 
\hyperlink{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7af3091144c125782cf17bcd3eb84e454c}{SEEK\_\-CUR}, 
\hyperlink{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7a060e45245be703e272d7264bafcfdc63}{SEEK\_\-END}
 \}
\end{DoxyCompactItemize}
\subsubsection*{Functions}
\begin{DoxyCompactItemize}
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_af445932f85a581e254806f034225ecf1}{test1} (uint32\_\-t a, uint32\_\-t b)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_afa4f1c799291804204aea54ce23077d6}{read} (uint8\_\-t $\ast$data, int32\_\-t size)
\begin{DoxyCompactList}\small\item\em Reads specified amount of bytes from the current file into a buffer. Also moves current position in the file. \item\end{DoxyCompactList}\item 
int32\_\-t \hyperlink{bytecode__api_8h_a01d98e416d08e0eabd02d2e8aa56f28e}{write} (uint8\_\-t $\ast$data, int32\_\-t size)
\begin{DoxyCompactList}\small\item\em Writes the specified amount of bytes from a buffer to the current temporary file. \item\end{DoxyCompactList}\item 
int32\_\-t \hyperlink{bytecode__api_8h_aac5ea598a656985291c56321ad2140ea}{seek} (int32\_\-t pos, uint32\_\-t whence)
\begin{DoxyCompactList}\small\item\em Changes the current file position to the specified one. \item\end{DoxyCompactList}\item 
uint32\_\-t \hyperlink{bytecode__api_8h_a77cd19560715e7a2f658fc3ac519d18e}{setvirusname} (const uint8\_\-t $\ast$name, uint32\_\-t len)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_aa6d82179ea15d32450fefbc6d1bd8934}{debug\_\-print\_\-str} (const uint8\_\-t $\ast$str, uint32\_\-t len)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_a6e0cdd4d4c76ed46a8627bee56eee1c1}{debug\_\-print\_\-uint} (uint32\_\-t a)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_a95e7d1048a56c98dec19335a6aa7afca}{disasm\_\-x86} (struct \hyperlink{struct_d_i_s_a_s_m___r_e_s_u_l_t}{DISASM\_\-RESULT} $\ast$result, uint32\_\-t len)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_a0d081f8f58263eb99d68690f1f9b2a81}{pe\_\-rawaddr} (uint32\_\-t rva)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a56355a07d9fb739dd483dd756f7fe821}{file\_\-find} (const uint8\_\-t $\ast$data, uint32\_\-t len)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a1e192cd4fe94e68dbac5023a1e2481c9}{file\_\-byteat} (uint32\_\-t offset)
\item 
void $\ast$ \hyperlink{bytecode__api_8h_a8704c31c2d7a73953f3c1c320447c24a}{malloc} (uint32\_\-t size)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_abf709b9bcdfd2da159ec288df9dc7ad9}{test2} (uint32\_\-t a)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_ae7e5e9cef42c34a52cfe814910a1e293}{get\_\-pe\_\-section} (struct \hyperlink{structcli__exe__section}{cli\_\-exe\_\-section} $\ast$section, uint32\_\-t num)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a5c25c11f12899883af10f3ba75cfc5c5}{fill\_\-buffer} (uint8\_\-t $\ast$buffer, uint32\_\-t len, uint32\_\-t filled, uint32\_\-t cursor, uint32\_\-t fill)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_aed98502eb13f9e2209d9c6b1620eb17a}{extract\_\-new} (int32\_\-t id)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a50b84b15fbaf03aa39b41ef7ffb5243e}{read\_\-number} (uint32\_\-t radix)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_ab791b1626efae568e0fb62c36ce8aa74}{hashset\_\-new} (void)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_adb42ee13e5883410846a392513d6866b}{hashset\_\-add} (int32\_\-t hs, uint32\_\-t key)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a06c14cce8ec4cc839a02094547964a00}{hashset\_\-remove} (int32\_\-t hs, uint32\_\-t key)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a0907920e08ec8e80f3ff829e8aaf58de}{hashset\_\-contains} (int32\_\-t hs, uint32\_\-t key)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_abd5e701c80bf5346a72fb145834b865a}{hashset\_\-done} (int32\_\-t id)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a854fcc65ad8cc0578c55aea6bc88b193}{hashset\_\-empty} (int32\_\-t id)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_ae755b425ff65feddef7b86092dcdeed7}{buffer\_\-pipe\_\-new} (uint32\_\-t size)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_adccae1152247859c54706b7d1753b689}{buffer\_\-pipe\_\-new\_\-fromfile} (uint32\_\-t pos)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_a53de1d976b1536c5b6a0d5d31de201b2}{buffer\_\-pipe\_\-read\_\-avail} (int32\_\-t id)
\item 
uint8\_\-t $\ast$ \hyperlink{bytecode__api_8h_ac4df62495f080f7885911d71c6a379c7}{buffer\_\-pipe\_\-read\_\-get} (int32\_\-t id, uint32\_\-t amount)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_ae67b360d1ab3c9dc4ac9d0f90208f6fe}{buffer\_\-pipe\_\-read\_\-stopped} (int32\_\-t id, uint32\_\-t amount)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_a1b9d87fbb40620d92b57549e24b189e6}{buffer\_\-pipe\_\-write\_\-avail} (int32\_\-t id)
\item 
uint8\_\-t $\ast$ \hyperlink{bytecode__api_8h_a8268aaabee12eed25ab561f678128ddd}{buffer\_\-pipe\_\-write\_\-get} (int32\_\-t id, uint32\_\-t size)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a57b76f82f0fb9bdabaad6c3d98037e94}{buffer\_\-pipe\_\-write\_\-stopped} (int32\_\-t id, uint32\_\-t amount)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a984890c1d3b68b99e68c2e6b1a7704d0}{buffer\_\-pipe\_\-done} (int32\_\-t id)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a65eec3722a1e992e9e4104c037503fdc}{inflate\_\-init} (int32\_\-t from\_\-buffer, int32\_\-t to\_\-buffer, int32\_\-t windowBits)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a10ad344e58c26566defe1780b303f0a4}{inflate\_\-process} (int32\_\-t id)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a123c12ca76a5b736217b68fdb126066e}{inflate\_\-done} (int32\_\-t id)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_ad7ea886d4274f1f389acf0d5cdc50b7d}{bytecode\_\-rt\_\-error} (int32\_\-t locationid)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_afb97628e1638c524b0cf45190403553d}{jsnorm\_\-init} (int32\_\-t from\_\-buffer)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a5c0da722aa4ccb9618052c5a2361ed8e}{jsnorm\_\-process} (int32\_\-t id)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a7445bceea42b0a4d1d841b2c8826db4a}{jsnorm\_\-done} (int32\_\-t id)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a59893a4520a13171c94d6ce63fce6c4b}{ilog2} (uint32\_\-t a, uint32\_\-t b)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_abd69b1aa30157a6d87658db53ece8f5a}{ipow} (int32\_\-t a, int32\_\-t b, int32\_\-t c)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_abf9b679512a0b9b290f3a40ce1a45df4}{iexp} (int32\_\-t a, int32\_\-t b, int32\_\-t c)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_acca08245d3d1a190375a92d5c51b2a90}{isin} (int32\_\-t a, int32\_\-t b, int32\_\-t c)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a6aeece8bfb39a8499b44d67c8bebb716}{icos} (int32\_\-t a, int32\_\-t b, int32\_\-t c)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a5d46e3fbbec8277f894d998a9b0dfdbc}{memstr} (const uint8\_\-t $\ast$haystack, int32\_\-t haysize, const uint8\_\-t $\ast$needle, int32\_\-t needlesize)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a231265b2ef73573c38d51a385697ae57}{hex2ui} (uint32\_\-t hex1, uint32\_\-t hex2)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_aa07799442f1560666449446eac438ee4}{atoi} (const uint8\_\-t $\ast$str, int32\_\-t size)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_a43707290a22915315c960422a88ba4d4}{debug\_\-print\_\-str\_\-start} (const uint8\_\-t $\ast$str, uint32\_\-t len)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_a02f173e084fc9a4b9eaf3017aa4243ba}{debug\_\-print\_\-str\_\-nonl} (const uint8\_\-t $\ast$str, uint32\_\-t len)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_a2df1f1f4823085b4956f1bce3f5b059c}{entropy\_\-buffer} (uint8\_\-t $\ast$buffer, int32\_\-t size)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a8350ff5a10c6d2b8aa5c9b20bd0b032f}{map\_\-new} (int32\_\-t keysize, int32\_\-t valuesize)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a962d8bc4658ba7dd411c75d7561c2fee}{map\_\-addkey} (const uint8\_\-t $\ast$key, int32\_\-t ksize, int32\_\-t id)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_afdae99c4fa909e017962e8b869950005}{map\_\-setvalue} (const uint8\_\-t $\ast$value, int32\_\-t vsize, int32\_\-t id)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_aeadbaac505160a820fe766cdaf95aba6}{map\_\-remove} (const uint8\_\-t $\ast$key, int32\_\-t ksize, int32\_\-t id)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_ac45a2c7ac861578b8001b2116eee10aa}{map\_\-find} (const uint8\_\-t $\ast$key, int32\_\-t ksize, int32\_\-t id)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_aac4176bebb0d4896ad64452bec023012}{map\_\-getvaluesize} (int32\_\-t id)
\item 
uint8\_\-t $\ast$ \hyperlink{bytecode__api_8h_a6a8bbb58c0ccad537eec575949e5f9f7}{map\_\-getvalue} (int32\_\-t id, int32\_\-t size)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a2603885df2096dc840d887461c3b1aac}{map\_\-done} (int32\_\-t id)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_ad7479f2fd346e59217f50726be9502a3}{file\_\-find\_\-limit} (const uint8\_\-t $\ast$data, uint32\_\-t len, int32\_\-t maxpos)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_addc54afadb3d660c92e4e350548086d8}{engine\_\-functionality\_\-level} (void)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_a4fa59c900fefd4a4441fcc4b3e44830d}{engine\_\-dconf\_\-level} (void)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_a0cd507ebdbadaa5899ca032cb5f69e3c}{engine\_\-scan\_\-options} (void)
\item 
uint32\_\-t \hyperlink{bytecode__api_8h_afc1eab4e86797378b5c1e7186894c1a7}{engine\_\-db\_\-options} (void)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a0f6e898d3a55355835fccb1f6d15abc1}{extract\_\-set\_\-container} (uint32\_\-t container)
\item 
int32\_\-t \hyperlink{bytecode__api_8h_a86179c9beb10be3f66cb5cae9902fec3}{input\_\-switch} (int32\_\-t extracted\_\-file)
\end{DoxyCompactItemize}
\subsubsection*{Variables}
\begin{DoxyCompactItemize}
\item 
const uint32\_\-t \hyperlink{bytecode__api_8h_a35a0a4f1219a792c77b7207924c3c4ec}{\_\-\_\-clambc\_\-match\_\-counts} \mbox{[}64\mbox{]}
\begin{DoxyCompactList}\small\item\em Logical signature match counts. \item\end{DoxyCompactList}\item 
\hypertarget{bytecode__api_8h_ae39872934c5879706b3cedaef090d227}{
const uint32\_\-t \hyperlink{bytecode__api_8h_ae39872934c5879706b3cedaef090d227}{\_\-\_\-clambc\_\-match\_\-offsets} \mbox{[}64\mbox{]}}
\label{bytecode__api_8h_ae39872934c5879706b3cedaef090d227}

\begin{DoxyCompactList}\small\item\em Logical signature match offsets This is a low-\/level variable, use the Macros in \hyperlink{bytecode__local_8h}{bytecode\_\-local.h} instead to access it. \item\end{DoxyCompactList}\item 
struct \hyperlink{structcli__pe__hook__data}{cli\_\-pe\_\-hook\_\-data} \hyperlink{bytecode__api_8h_a3d386181912bdbc2b90ee559b0cccde3}{\_\-\_\-clambc\_\-pedata}
\item 
const uint32\_\-t \hyperlink{bytecode__api_8h_ab8d6c50474be3ba69906161a3e520ce7}{\_\-\_\-clambc\_\-filesize} \mbox{[}1\mbox{]}
\item 
const uint16\_\-t \hyperlink{bytecode__api_8h_a6eb3802e21949cfdf6b91570d3c62c99}{\_\-\_\-clambc\_\-kind}
\end{DoxyCompactItemize}


\subsubsection{Detailed Description}


\subsubsection{Enumeration Type Documentation}
\hypertarget{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7}{
\paragraph[{"@1}]{\setlength{\rightskip}{0pt plus 5cm}anonymous enum}\hfill}
\label{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7}
\begin{Desc}
\item[Enumerator: ]\par
\begin{description}
\index{SEEK\_\-SET@{SEEK\_\-SET}!bytecode\_\-api.h@{bytecode\_\-api.h}}\index{bytecode\_\-api.h@{bytecode\_\-api.h}!SEEK\_\-SET@{SEEK\_\-SET}}\item[{\em 
\hypertarget{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7a7f53e3798ec48e79c0897ba5138f9b05}{
SEEK\_\-SET}
\label{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7a7f53e3798ec48e79c0897ba5138f9b05}
}]set file position to specified absolute position \index{SEEK\_\-CUR@{SEEK\_\-CUR}!bytecode\_\-api.h@{bytecode\_\-api.h}}\index{bytecode\_\-api.h@{bytecode\_\-api.h}!SEEK\_\-CUR@{SEEK\_\-CUR}}\item[{\em 
\hypertarget{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7af3091144c125782cf17bcd3eb84e454c}{
SEEK\_\-CUR}
\label{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7af3091144c125782cf17bcd3eb84e454c}
}]set file position relative to current position \index{SEEK\_\-END@{SEEK\_\-END}!bytecode\_\-api.h@{bytecode\_\-api.h}}\index{bytecode\_\-api.h@{bytecode\_\-api.h}!SEEK\_\-END@{SEEK\_\-END}}\item[{\em 
\hypertarget{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7a060e45245be703e272d7264bafcfdc63}{
SEEK\_\-END}
\label{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7a060e45245be703e272d7264bafcfdc63}
}]set file position relative to file end \end{description}
\end{Desc}

\hypertarget{bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!BytecodeKind@{BytecodeKind}}
\index{BytecodeKind@{BytecodeKind}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{BytecodeKind}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf BytecodeKind}}\hfill}
\label{bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91}
Bytecode trigger kind \begin{Desc}
\item[Enumerator: ]\par
\begin{description}
\index{BC\_\-GENERIC@{BC\_\-GENERIC}!bytecode\_\-api.h@{bytecode\_\-api.h}}\index{bytecode\_\-api.h@{bytecode\_\-api.h}!BC\_\-GENERIC@{BC\_\-GENERIC}}\item[{\em 
\hypertarget{bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91aff84fbd05d167a1cf9e146d155ac90b7}{
BC\_\-GENERIC}
\label{bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91aff84fbd05d167a1cf9e146d155ac90b7}
}]generic bytecode, not tied a specific hook \index{BC\_\-LOGICAL@{BC\_\-LOGICAL}!bytecode\_\-api.h@{bytecode\_\-api.h}}\index{bytecode\_\-api.h@{bytecode\_\-api.h}!BC\_\-LOGICAL@{BC\_\-LOGICAL}}\item[{\em 
\hypertarget{bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91aa6c849ba6dbd80a2af04a38eeea8d5c3}{
BC\_\-LOGICAL}
\label{bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91aa6c849ba6dbd80a2af04a38eeea8d5c3}
}]triggered by a logical signature \index{BC\_\-PE\_\-UNPACKER@{BC\_\-PE\_\-UNPACKER}!bytecode\_\-api.h@{bytecode\_\-api.h}}\index{bytecode\_\-api.h@{bytecode\_\-api.h}!BC\_\-PE\_\-UNPACKER@{BC\_\-PE\_\-UNPACKER}}\item[{\em 
\hypertarget{bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91ae6b6910f9706526e49807a022b7125f1}{
BC\_\-PE\_\-UNPACKER}
\label{bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91ae6b6910f9706526e49807a022b7125f1}
}]a PE unpacker \end{description}
\end{Desc}

\hypertarget{bytecode__api_8h_ac2cd51dc61c1ddf642d596c7f73a6999}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!FunctionalityLevels@{FunctionalityLevels}}
\index{FunctionalityLevels@{FunctionalityLevels}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{FunctionalityLevels}]{\setlength{\rightskip}{0pt plus 5cm}enum {\bf FunctionalityLevels}}\hfill}
\label{bytecode__api_8h_ac2cd51dc61c1ddf642d596c7f73a6999}
LibClamAV functionality level constants 

\subsubsection{Function Documentation}
\hypertarget{bytecode__api_8h_aa07799442f1560666449446eac438ee4}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!atoi@{atoi}}
\index{atoi@{atoi}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{atoi}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t atoi (const uint8\_\-t $\ast$ {\em str}, \/  int32\_\-t {\em size})}\hfill}
\label{bytecode__api_8h_aa07799442f1560666449446eac438ee4}
Converts string to positive number. 
\begin{DoxyParams}{Parameters}
\item[{\em str}]buffer \item[{\em size}]size of {\ttfamily str} \end{DoxyParams}
\begin{DoxyReturn}{Returns}
$>$0 string converted to number if possible, -\/1 on error 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a984890c1d3b68b99e68c2e6b1a7704d0}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!buffer\_\-pipe\_\-done@{buffer\_\-pipe\_\-done}}
\index{buffer\_\-pipe\_\-done@{buffer\_\-pipe\_\-done}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{buffer\_\-pipe\_\-done}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t buffer\_\-pipe\_\-done (int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_a984890c1d3b68b99e68c2e6b1a7704d0}
Deallocate memory used by buffer. After this all attempts to use this buffer will result in error. All buffer\_\-pipes are automatically deallocated when bytecode finishes execution. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]ID of buffer\_\-pipe \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_ae755b425ff65feddef7b86092dcdeed7}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!buffer\_\-pipe\_\-new@{buffer\_\-pipe\_\-new}}
\index{buffer\_\-pipe\_\-new@{buffer\_\-pipe\_\-new}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{buffer\_\-pipe\_\-new}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t buffer\_\-pipe\_\-new (uint32\_\-t {\em size})}\hfill}
\label{bytecode__api_8h_ae755b425ff65feddef7b86092dcdeed7}
Creates a new pipe with the specified buffer size 
\begin{DoxyParams}{Parameters}
\item[{\em size}]size of buffer \end{DoxyParams}
\begin{DoxyReturn}{Returns}
ID of newly created buffer\_\-pipe 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_adccae1152247859c54706b7d1753b689}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!buffer\_\-pipe\_\-new\_\-fromfile@{buffer\_\-pipe\_\-new\_\-fromfile}}
\index{buffer\_\-pipe\_\-new\_\-fromfile@{buffer\_\-pipe\_\-new\_\-fromfile}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{buffer\_\-pipe\_\-new\_\-fromfile}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t buffer\_\-pipe\_\-new\_\-fromfile (uint32\_\-t {\em pos})}\hfill}
\label{bytecode__api_8h_adccae1152247859c54706b7d1753b689}
Same as buffer\_\-pipe\_\-new, except the pipe's input is tied to the current file, at the specified position. 
\begin{DoxyParams}{Parameters}
\item[{\em pos}]starting position of pipe input in current file \end{DoxyParams}
\begin{DoxyReturn}{Returns}
ID of newly created buffer\_\-pipe 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a53de1d976b1536c5b6a0d5d31de201b2}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!buffer\_\-pipe\_\-read\_\-avail@{buffer\_\-pipe\_\-read\_\-avail}}
\index{buffer\_\-pipe\_\-read\_\-avail@{buffer\_\-pipe\_\-read\_\-avail}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{buffer\_\-pipe\_\-read\_\-avail}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t buffer\_\-pipe\_\-read\_\-avail (int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_a53de1d976b1536c5b6a0d5d31de201b2}
Returns the amount of bytes available to read. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]ID of buffer\_\-pipe \end{DoxyParams}
\begin{DoxyReturn}{Returns}
amount of bytes available to read 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_ac4df62495f080f7885911d71c6a379c7}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!buffer\_\-pipe\_\-read\_\-get@{buffer\_\-pipe\_\-read\_\-get}}
\index{buffer\_\-pipe\_\-read\_\-get@{buffer\_\-pipe\_\-read\_\-get}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{buffer\_\-pipe\_\-read\_\-get}]{\setlength{\rightskip}{0pt plus 5cm}uint8\_\-t$\ast$ buffer\_\-pipe\_\-read\_\-get (int32\_\-t {\em id}, \/  uint32\_\-t {\em amount})}\hfill}
\label{bytecode__api_8h_ac4df62495f080f7885911d71c6a379c7}
Returns a pointer to the buffer for reading. The 'amount' parameter should be obtained by a call to \hyperlink{bytecode__api_8h_a53de1d976b1536c5b6a0d5d31de201b2}{buffer\_\-pipe\_\-read\_\-avail()}. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]ID of buffer\_\-pipe \item[{\em amount}]to read \end{DoxyParams}
\begin{DoxyReturn}{Returns}
pointer to buffer, or NULL if buffer has less than specified amount 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_ae67b360d1ab3c9dc4ac9d0f90208f6fe}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!buffer\_\-pipe\_\-read\_\-stopped@{buffer\_\-pipe\_\-read\_\-stopped}}
\index{buffer\_\-pipe\_\-read\_\-stopped@{buffer\_\-pipe\_\-read\_\-stopped}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{buffer\_\-pipe\_\-read\_\-stopped}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t buffer\_\-pipe\_\-read\_\-stopped (int32\_\-t {\em id}, \/  uint32\_\-t {\em amount})}\hfill}
\label{bytecode__api_8h_ae67b360d1ab3c9dc4ac9d0f90208f6fe}
Updates read cursor in buffer\_\-pipe. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]ID of buffer\_\-pipe \item[{\em amount}]amount of bytes to move read cursor \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a1b9d87fbb40620d92b57549e24b189e6}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!buffer\_\-pipe\_\-write\_\-avail@{buffer\_\-pipe\_\-write\_\-avail}}
\index{buffer\_\-pipe\_\-write\_\-avail@{buffer\_\-pipe\_\-write\_\-avail}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{buffer\_\-pipe\_\-write\_\-avail}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t buffer\_\-pipe\_\-write\_\-avail (int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_a1b9d87fbb40620d92b57549e24b189e6}
Returns the amount of bytes available for writing. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]ID of buffer\_\-pipe \end{DoxyParams}
\begin{DoxyReturn}{Returns}
amount of bytes available for writing 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a8268aaabee12eed25ab561f678128ddd}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!buffer\_\-pipe\_\-write\_\-get@{buffer\_\-pipe\_\-write\_\-get}}
\index{buffer\_\-pipe\_\-write\_\-get@{buffer\_\-pipe\_\-write\_\-get}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{buffer\_\-pipe\_\-write\_\-get}]{\setlength{\rightskip}{0pt plus 5cm}uint8\_\-t$\ast$ buffer\_\-pipe\_\-write\_\-get (int32\_\-t {\em id}, \/  uint32\_\-t {\em size})}\hfill}
\label{bytecode__api_8h_a8268aaabee12eed25ab561f678128ddd}
Returns pointer to writable buffer. The 'amount' parameter should be obtained by a call to \hyperlink{bytecode__api_8h_a1b9d87fbb40620d92b57549e24b189e6}{buffer\_\-pipe\_\-write\_\-avail()}. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]ID of buffer\_\-pipe \item[{\em size}]amount of bytes to write \end{DoxyParams}
\begin{DoxyReturn}{Returns}
pointer to write buffer, or NULL if requested amount is more than what is available in the buffer 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a57b76f82f0fb9bdabaad6c3d98037e94}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!buffer\_\-pipe\_\-write\_\-stopped@{buffer\_\-pipe\_\-write\_\-stopped}}
\index{buffer\_\-pipe\_\-write\_\-stopped@{buffer\_\-pipe\_\-write\_\-stopped}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{buffer\_\-pipe\_\-write\_\-stopped}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t buffer\_\-pipe\_\-write\_\-stopped (int32\_\-t {\em id}, \/  uint32\_\-t {\em amount})}\hfill}
\label{bytecode__api_8h_a57b76f82f0fb9bdabaad6c3d98037e94}
Updates the write cursor in buffer\_\-pipe. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]ID of buffer\_\-pipe \item[{\em amount}]amount of bytes to move write cursor \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_ad7ea886d4274f1f389acf0d5cdc50b7d}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!bytecode\_\-rt\_\-error@{bytecode\_\-rt\_\-error}}
\index{bytecode\_\-rt\_\-error@{bytecode\_\-rt\_\-error}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{bytecode\_\-rt\_\-error}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t bytecode\_\-rt\_\-error (int32\_\-t {\em locationid})}\hfill}
\label{bytecode__api_8h_ad7ea886d4274f1f389acf0d5cdc50b7d}
Report a runtime error at the specified locationID. 
\begin{DoxyParams}{Parameters}
\item[{\em locationid}](line $<$$<$ 8) $|$ (column\&0xff) \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_aa6d82179ea15d32450fefbc6d1bd8934}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!debug\_\-print\_\-str@{debug\_\-print\_\-str}}
\index{debug\_\-print\_\-str@{debug\_\-print\_\-str}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{debug\_\-print\_\-str}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t debug\_\-print\_\-str (const uint8\_\-t $\ast$ {\em str}, \/  uint32\_\-t {\em len})}\hfill}
\label{bytecode__api_8h_aa6d82179ea15d32450fefbc6d1bd8934}
Prints a debug message.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em str}]Message to print \item[\mbox{$\leftarrow$} {\em len}]length of message to print \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a02f173e084fc9a4b9eaf3017aa4243ba}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!debug\_\-print\_\-str\_\-nonl@{debug\_\-print\_\-str\_\-nonl}}
\index{debug\_\-print\_\-str\_\-nonl@{debug\_\-print\_\-str\_\-nonl}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{debug\_\-print\_\-str\_\-nonl}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t debug\_\-print\_\-str\_\-nonl (const uint8\_\-t $\ast$ {\em str}, \/  uint32\_\-t {\em len})}\hfill}
\label{bytecode__api_8h_a02f173e084fc9a4b9eaf3017aa4243ba}
Prints a debug message with a trailing newline, and not preceded by 'LibClamAV debug'. 
\begin{DoxyParams}{Parameters}
\item[{\em str}]the string \item[{\em len}]length of {\ttfamily str} \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a43707290a22915315c960422a88ba4d4}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!debug\_\-print\_\-str\_\-start@{debug\_\-print\_\-str\_\-start}}
\index{debug\_\-print\_\-str\_\-start@{debug\_\-print\_\-str\_\-start}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{debug\_\-print\_\-str\_\-start}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t debug\_\-print\_\-str\_\-start (const uint8\_\-t $\ast$ {\em str}, \/  uint32\_\-t {\em len})}\hfill}
\label{bytecode__api_8h_a43707290a22915315c960422a88ba4d4}
Prints a debug message with a trailing newline, but preceded by 'LibClamAV debug'. 
\begin{DoxyParams}{Parameters}
\item[{\em str}]the string \item[{\em len}]length of {\ttfamily str} \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a6e0cdd4d4c76ed46a8627bee56eee1c1}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!debug\_\-print\_\-uint@{debug\_\-print\_\-uint}}
\index{debug\_\-print\_\-uint@{debug\_\-print\_\-uint}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{debug\_\-print\_\-uint}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t debug\_\-print\_\-uint (uint32\_\-t {\em a})}\hfill}
\label{bytecode__api_8h_a6e0cdd4d4c76ed46a8627bee56eee1c1}
Prints a number as a debug message.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em a}]number to print \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a95e7d1048a56c98dec19335a6aa7afca}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!disasm\_\-x86@{disasm\_\-x86}}
\index{disasm\_\-x86@{disasm\_\-x86}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{disasm\_\-x86}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t disasm\_\-x86 (struct {\bf DISASM\_\-RESULT} $\ast$ {\em result}, \/  uint32\_\-t {\em len})}\hfill}
\label{bytecode__api_8h_a95e7d1048a56c98dec19335a6aa7afca}
Disassembles starting from current file position, the specified amount of bytes. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\rightarrow$} {\em result}]pointer to struct holding result \item[\mbox{$\leftarrow$} {\em len}]how many bytes to disassemble \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 for success
\end{DoxyReturn}
You can use lseek to disassemble starting from a different location. This is a low-\/level API, the result is in ClamAV type-\/8 signature format (64 bytes/instruction). \begin{DoxySeeAlso}{See also}
\hyperlink{bytecode__local_8h_a1a801c0806f1cb7ed433f139e5769f99}{DisassembleAt} 
\end{DoxySeeAlso}
\hypertarget{bytecode__api_8h_afc1eab4e86797378b5c1e7186894c1a7}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!engine\_\-db\_\-options@{engine\_\-db\_\-options}}
\index{engine\_\-db\_\-options@{engine\_\-db\_\-options}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{engine\_\-db\_\-options}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t engine\_\-db\_\-options (void)}\hfill}
\label{bytecode__api_8h_afc1eab4e86797378b5c1e7186894c1a7}
Returns the current engine's db options. \hypertarget{bytecode__api_8h_a4fa59c900fefd4a4441fcc4b3e44830d}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!engine\_\-dconf\_\-level@{engine\_\-dconf\_\-level}}
\index{engine\_\-dconf\_\-level@{engine\_\-dconf\_\-level}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{engine\_\-dconf\_\-level}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t engine\_\-dconf\_\-level (void)}\hfill}
\label{bytecode__api_8h_a4fa59c900fefd4a4441fcc4b3e44830d}
Returns the current engine (dconf) functionality level. \hypertarget{bytecode__api_8h_addc54afadb3d660c92e4e350548086d8}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!engine\_\-functionality\_\-level@{engine\_\-functionality\_\-level}}
\index{engine\_\-functionality\_\-level@{engine\_\-functionality\_\-level}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{engine\_\-functionality\_\-level}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t engine\_\-functionality\_\-level (void)}\hfill}
\label{bytecode__api_8h_addc54afadb3d660c92e4e350548086d8}
-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ engine query -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Returns the current engine (feature) functionality level. \hypertarget{bytecode__api_8h_a0cd507ebdbadaa5899ca032cb5f69e3c}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!engine\_\-scan\_\-options@{engine\_\-scan\_\-options}}
\index{engine\_\-scan\_\-options@{engine\_\-scan\_\-options}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{engine\_\-scan\_\-options}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t engine\_\-scan\_\-options (void)}\hfill}
\label{bytecode__api_8h_a0cd507ebdbadaa5899ca032cb5f69e3c}
Returns the current engine's scan options. \hypertarget{bytecode__api_8h_a2df1f1f4823085b4956f1bce3f5b059c}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!entropy\_\-buffer@{entropy\_\-buffer}}
\index{entropy\_\-buffer@{entropy\_\-buffer}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{entropy\_\-buffer}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t entropy\_\-buffer (uint8\_\-t $\ast$ {\em buffer}, \/  int32\_\-t {\em size})}\hfill}
\label{bytecode__api_8h_a2df1f1f4823085b4956f1bce3f5b059c}
Returns an approximation for the entropy of {\ttfamily buffer}. 
\begin{DoxyParams}{Parameters}
\item[{\em buffer}]input buffer \item[{\em size}]size of buffer \end{DoxyParams}
\begin{DoxyReturn}{Returns}
entropy estimation $\ast$ 2$^\wedge$26 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_aed98502eb13f9e2209d9c6b1620eb17a}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!extract\_\-new@{extract\_\-new}}
\index{extract\_\-new@{extract\_\-new}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{extract\_\-new}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t extract\_\-new (int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_aed98502eb13f9e2209d9c6b1620eb17a}
Prepares for extracting a new file, if we've already extracted one it scans it. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em id}]an id for the new file (for example position in container) \end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if previous extracted file was infected 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a0f6e898d3a55355835fccb1f6d15abc1}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!extract\_\-set\_\-container@{extract\_\-set\_\-container}}
\index{extract\_\-set\_\-container@{extract\_\-set\_\-container}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{extract\_\-set\_\-container}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t extract\_\-set\_\-container (uint32\_\-t {\em container})}\hfill}
\label{bytecode__api_8h_a0f6e898d3a55355835fccb1f6d15abc1}
Sets the container type for the currently extracted file. 
\begin{DoxyParams}{Parameters}
\item[{\em container}]container type (CL\_\-TYPE\_\-$\ast$) \end{DoxyParams}
\begin{DoxyReturn}{Returns}
current setting for container (CL\_\-TYPE\_\-ANY default) 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a1e192cd4fe94e68dbac5023a1e2481c9}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!file\_\-byteat@{file\_\-byteat}}
\index{file\_\-byteat@{file\_\-byteat}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{file\_\-byteat}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t file\_\-byteat (uint32\_\-t {\em offset})}\hfill}
\label{bytecode__api_8h_a1e192cd4fe94e68dbac5023a1e2481c9}
Read a single byte from current file 
\begin{DoxyParams}{Parameters}
\item[{\em offset}]file offset \end{DoxyParams}
\begin{DoxyReturn}{Returns}
byte at offset {\ttfamily off} in the current file, or -\/1 if offset is invalid 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a56355a07d9fb739dd483dd756f7fe821}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!file\_\-find@{file\_\-find}}
\index{file\_\-find@{file\_\-find}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{file\_\-find}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t file\_\-find (const uint8\_\-t $\ast$ {\em data}, \/  uint32\_\-t {\em len})}\hfill}
\label{bytecode__api_8h_a56355a07d9fb739dd483dd756f7fe821}
Looks for the specified sequence of bytes in the current file. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em data}]the sequence of bytes to look for \item[{\em len}]length of {\ttfamily data}, cannot be more than 1024 \end{DoxyParams}
\begin{DoxyReturn}{Returns}
offset in the current file if match is found, -\/1 otherwise 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_ad7479f2fd346e59217f50726be9502a3}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!file\_\-find\_\-limit@{file\_\-find\_\-limit}}
\index{file\_\-find\_\-limit@{file\_\-find\_\-limit}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{file\_\-find\_\-limit}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t file\_\-find\_\-limit (const uint8\_\-t $\ast$ {\em data}, \/  uint32\_\-t {\em len}, \/  int32\_\-t {\em maxpos})}\hfill}
\label{bytecode__api_8h_ad7479f2fd346e59217f50726be9502a3}
-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ file operations -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Looks for the specified sequence of bytes in the current file, up to the specified position. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em data}]the sequence of bytes to look for \item[{\em len}]length of {\ttfamily data}, cannot be more than 1024 \end{DoxyParams}
\begin{DoxyReturn}{Returns}
offset in the current file if match is found, -\/1 otherwise 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a5c25c11f12899883af10f3ba75cfc5c5}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!fill\_\-buffer@{fill\_\-buffer}}
\index{fill\_\-buffer@{fill\_\-buffer}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{fill\_\-buffer}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t fill\_\-buffer (uint8\_\-t $\ast$ {\em buffer}, \/  uint32\_\-t {\em len}, \/  uint32\_\-t {\em filled}, \/  uint32\_\-t {\em cursor}, \/  uint32\_\-t {\em fill})}\hfill}
\label{bytecode__api_8h_a5c25c11f12899883af10f3ba75cfc5c5}
Fills the specified buffer with at least {\ttfamily fill} bytes. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\rightarrow$} {\em buffer}]the buffer to fill \item[\mbox{$\leftarrow$} {\em len}]length of buffer \item[\mbox{$\leftarrow$} {\em filled}]how much of the buffer is currently filled \item[\mbox{$\leftarrow$} {\em cursor}]position of cursor in buffer \item[\mbox{$\leftarrow$} {\em fill}]amount of bytes to fill in (0 is valid) \end{DoxyParams}
\begin{DoxyReturn}{Returns}
$<$0 on error, 0 on EOF, number bytes available in buffer (starting from 0) The character at the cursor will be at position 0 after this call. 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_ae7e5e9cef42c34a52cfe814910a1e293}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!get\_\-pe\_\-section@{get\_\-pe\_\-section}}
\index{get\_\-pe\_\-section@{get\_\-pe\_\-section}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{get\_\-pe\_\-section}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t get\_\-pe\_\-section (struct {\bf cli\_\-exe\_\-section} $\ast$ {\em section}, \/  uint32\_\-t {\em num})}\hfill}
\label{bytecode__api_8h_ae7e5e9cef42c34a52cfe814910a1e293}
Gets information about the specified PE section. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\rightarrow$} {\em section}]PE section information will be stored here \item[\mbox{$\leftarrow$} {\em num}]PE section number \end{DoxyParams}
\hypertarget{bytecode__api_8h_adb42ee13e5883410846a392513d6866b}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!hashset\_\-add@{hashset\_\-add}}
\index{hashset\_\-add@{hashset\_\-add}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{hashset\_\-add}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t hashset\_\-add (int32\_\-t {\em hs}, \/  uint32\_\-t {\em key})}\hfill}
\label{bytecode__api_8h_adb42ee13e5883410846a392513d6866b}
Add a new 32-\/bit key to the hashset. 
\begin{DoxyParams}{Parameters}
\item[{\em hs}]ID of hashset (from hashset\_\-new) \item[{\em key}]the key to add \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a0907920e08ec8e80f3ff829e8aaf58de}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!hashset\_\-contains@{hashset\_\-contains}}
\index{hashset\_\-contains@{hashset\_\-contains}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{hashset\_\-contains}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t hashset\_\-contains (int32\_\-t {\em hs}, \/  uint32\_\-t {\em key})}\hfill}
\label{bytecode__api_8h_a0907920e08ec8e80f3ff829e8aaf58de}
Returns whether the hashset contains the specified key. 
\begin{DoxyParams}{Parameters}
\item[{\em hs}]ID of hashset (from hashset\_\-new) \item[{\em key}]the key to lookup \end{DoxyParams}
\begin{DoxyReturn}{Returns}
1 if found, 0 if not found, $<$0 on invalid hashset ID 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_abd5e701c80bf5346a72fb145834b865a}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!hashset\_\-done@{hashset\_\-done}}
\index{hashset\_\-done@{hashset\_\-done}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{hashset\_\-done}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t hashset\_\-done (int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_abd5e701c80bf5346a72fb145834b865a}
Deallocates the memory used by the specified hashset. Trying to use the hashset after this will result in an error. The hashset may not be used after this. All hashsets are automatically deallocated when bytecode finishes execution. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]ID of hashset (from hashset\_\-new) \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a854fcc65ad8cc0578c55aea6bc88b193}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!hashset\_\-empty@{hashset\_\-empty}}
\index{hashset\_\-empty@{hashset\_\-empty}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{hashset\_\-empty}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t hashset\_\-empty (int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_a854fcc65ad8cc0578c55aea6bc88b193}
Returns whether the hashset is empty. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]of hashset (from hashset\_\-new) \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_ab791b1626efae568e0fb62c36ce8aa74}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!hashset\_\-new@{hashset\_\-new}}
\index{hashset\_\-new@{hashset\_\-new}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{hashset\_\-new}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t hashset\_\-new (void)}\hfill}
\label{bytecode__api_8h_ab791b1626efae568e0fb62c36ce8aa74}
Creates a new hashset and returns its id. \begin{DoxyReturn}{Returns}
ID for new hashset 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a06c14cce8ec4cc839a02094547964a00}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!hashset\_\-remove@{hashset\_\-remove}}
\index{hashset\_\-remove@{hashset\_\-remove}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{hashset\_\-remove}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t hashset\_\-remove (int32\_\-t {\em hs}, \/  uint32\_\-t {\em key})}\hfill}
\label{bytecode__api_8h_a06c14cce8ec4cc839a02094547964a00}
Remove a 32-\/bit key from the hashset. 
\begin{DoxyParams}{Parameters}
\item[{\em hs}]ID of hashset (from hashset\_\-new) \item[{\em key}]the key to add \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a231265b2ef73573c38d51a385697ae57}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!hex2ui@{hex2ui}}
\index{hex2ui@{hex2ui}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{hex2ui}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t hex2ui (uint32\_\-t {\em hex1}, \/  uint32\_\-t {\em hex2})}\hfill}
\label{bytecode__api_8h_a231265b2ef73573c38d51a385697ae57}
Returns hexadecimal characters {\ttfamily hex1} and {\ttfamily hex2} converted to 8-\/bit number. 
\begin{DoxyParams}{Parameters}
\item[{\em hex1}]hexadecimal character \item[{\em hex2}]hexadecimal character \end{DoxyParams}
\begin{DoxyReturn}{Returns}
hex1 hex2 converted to 8-\/bit integer, -\/1 on error 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a6aeece8bfb39a8499b44d67c8bebb716}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!icos@{icos}}
\index{icos@{icos}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{icos}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t icos (int32\_\-t {\em a}, \/  int32\_\-t {\em b}, \/  int32\_\-t {\em c})}\hfill}
\label{bytecode__api_8h_a6aeece8bfb39a8499b44d67c8bebb716}
Returns c$\ast$cos(a/b). 
\begin{DoxyParams}{Parameters}
\item[{\em a}]integer \item[{\em b}]integer \item[{\em c}]integer \end{DoxyParams}
\begin{DoxyReturn}{Returns}
c$\ast$sin(a/b) 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_abf9b679512a0b9b290f3a40ce1a45df4}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!iexp@{iexp}}
\index{iexp@{iexp}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{iexp}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t iexp (int32\_\-t {\em a}, \/  int32\_\-t {\em b}, \/  int32\_\-t {\em c})}\hfill}
\label{bytecode__api_8h_abf9b679512a0b9b290f3a40ce1a45df4}
Returns exp(a/b)$\ast$c 
\begin{DoxyParams}{Parameters}
\item[{\em a}]integer \item[{\em b}]integer \item[{\em c}]integer \end{DoxyParams}
\begin{DoxyReturn}{Returns}
c$\ast$exp(a/b) 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a59893a4520a13171c94d6ce63fce6c4b}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!ilog2@{ilog2}}
\index{ilog2@{ilog2}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{ilog2}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t ilog2 (uint32\_\-t {\em a}, \/  uint32\_\-t {\em b})}\hfill}
\label{bytecode__api_8h_a59893a4520a13171c94d6ce63fce6c4b}
-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ math -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Returns 2$^\wedge$26$\ast$log2(a/b) 
\begin{DoxyParams}{Parameters}
\item[{\em a}]input \item[{\em b}]input \end{DoxyParams}
\begin{DoxyReturn}{Returns}
2$^\wedge$26$\ast$log2(a/b) 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a123c12ca76a5b736217b68fdb126066e}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!inflate\_\-done@{inflate\_\-done}}
\index{inflate\_\-done@{inflate\_\-done}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{inflate\_\-done}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t inflate\_\-done (int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_a123c12ca76a5b736217b68fdb126066e}
Deallocates inflate data structure. Using the inflate data structure after this will result in an error. All inflate data structures are automatically deallocated when bytecode finishes execution. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]ID of inflate data structure \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success. 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a65eec3722a1e992e9e4104c037503fdc}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!inflate\_\-init@{inflate\_\-init}}
\index{inflate\_\-init@{inflate\_\-init}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{inflate\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t inflate\_\-init (int32\_\-t {\em from\_\-buffer}, \/  int32\_\-t {\em to\_\-buffer}, \/  int32\_\-t {\em windowBits})}\hfill}
\label{bytecode__api_8h_a65eec3722a1e992e9e4104c037503fdc}
Initializes inflate data structures for decompressing data 'from\_\-buffer' and writing uncompressed uncompressed data 'to\_\-buffer'. 
\begin{DoxyParams}{Parameters}
\item[{\em from\_\-buffer}]ID of buffer\_\-pipe to read compressed data from \item[{\em to\_\-buffer}]ID of buffer\_\-pipe to write decompressed data to \item[{\em windowBits}](see zlib documentation) \end{DoxyParams}
\begin{DoxyReturn}{Returns}
ID of newly created inflate data structure, $<$0 on failure 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a10ad344e58c26566defe1780b303f0a4}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!inflate\_\-process@{inflate\_\-process}}
\index{inflate\_\-process@{inflate\_\-process}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{inflate\_\-process}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t inflate\_\-process (int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_a10ad344e58c26566defe1780b303f0a4}
Inflate all available data in the input buffer, and write to output buffer. Stops when the input buffer becomes empty, or write buffer becomes full. Also attempts to recover from corrupted inflate stream (via inflateSync). This function can be called repeatedly on success after filling the input buffer, and flushing the output buffer. The inflate stream is done processing when 0 bytes are available from output buffer, and input buffer is not empty. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]ID of inflate data structure \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, zlib error code otherwise 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a86179c9beb10be3f66cb5cae9902fec3}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!input\_\-switch@{input\_\-switch}}
\index{input\_\-switch@{input\_\-switch}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{input\_\-switch}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t input\_\-switch (int32\_\-t {\em extracted\_\-file})}\hfill}
\label{bytecode__api_8h_a86179c9beb10be3f66cb5cae9902fec3}
Toggles the read/seek API to read from the currently extracted file, and back. 
\begin{DoxyParams}{Parameters}
\item[{\em extracted\_\-file}]1 -\/ switch to reading from extracted file, 0 -\/ switch back to original input \end{DoxyParams}
\begin{DoxyReturn}{Returns}
-\/1 on error (if no extracted file exists) 0 on success 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_abd69b1aa30157a6d87658db53ece8f5a}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!ipow@{ipow}}
\index{ipow@{ipow}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{ipow}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t ipow (int32\_\-t {\em a}, \/  int32\_\-t {\em b}, \/  int32\_\-t {\em c})}\hfill}
\label{bytecode__api_8h_abd69b1aa30157a6d87658db53ece8f5a}
Returns c$\ast$a$^\wedge$b. 
\begin{DoxyParams}{Parameters}
\item[{\em a}]integer \item[{\em b}]integer \item[{\em c}]integer \end{DoxyParams}
\begin{DoxyReturn}{Returns}
c$\ast$pow(a,b) 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_acca08245d3d1a190375a92d5c51b2a90}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!isin@{isin}}
\index{isin@{isin}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{isin}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t isin (int32\_\-t {\em a}, \/  int32\_\-t {\em b}, \/  int32\_\-t {\em c})}\hfill}
\label{bytecode__api_8h_acca08245d3d1a190375a92d5c51b2a90}
Returns c$\ast$sin(a/b). 
\begin{DoxyParams}{Parameters}
\item[{\em a}]integer \item[{\em b}]integer \item[{\em c}]integer \end{DoxyParams}
\begin{DoxyReturn}{Returns}
c$\ast$sin(a/b) 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a7445bceea42b0a4d1d841b2c8826db4a}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!jsnorm\_\-done@{jsnorm\_\-done}}
\index{jsnorm\_\-done@{jsnorm\_\-done}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{jsnorm\_\-done}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t jsnorm\_\-done (int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_a7445bceea42b0a4d1d841b2c8826db4a}
Flushes JS normalizer. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]ID of js normalizer to flush \end{DoxyParams}
\hypertarget{bytecode__api_8h_afb97628e1638c524b0cf45190403553d}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!jsnorm\_\-init@{jsnorm\_\-init}}
\index{jsnorm\_\-init@{jsnorm\_\-init}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{jsnorm\_\-init}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t jsnorm\_\-init (int32\_\-t {\em from\_\-buffer})}\hfill}
\label{bytecode__api_8h_afb97628e1638c524b0cf45190403553d}
Initializes JS normalizer for reading 'from\_\-buffer'. Normalized JS will be written to a single tempfile, one normalized JS per line, and automatically scanned when the bytecode finishes execution. 
\begin{DoxyParams}{Parameters}
\item[{\em from\_\-buffer}]ID of buffer\_\-pipe to read javascript from \end{DoxyParams}
\begin{DoxyReturn}{Returns}
ID of JS normalizer, $<$0 on failure 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a5c0da722aa4ccb9618052c5a2361ed8e}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!jsnorm\_\-process@{jsnorm\_\-process}}
\index{jsnorm\_\-process@{jsnorm\_\-process}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{jsnorm\_\-process}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t jsnorm\_\-process (int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_a5c0da722aa4ccb9618052c5a2361ed8e}
Normalize all javascript from the input buffer, and write to tempfile. You can call this function repeatedly on success, if you (re)fill the input buffer. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]ID of JS normalizer \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, $<$0 on failure 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a8704c31c2d7a73953f3c1c320447c24a}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!malloc@{malloc}}
\index{malloc@{malloc}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{malloc}]{\setlength{\rightskip}{0pt plus 5cm}void$\ast$ malloc (uint32\_\-t {\em size})}\hfill}
\label{bytecode__api_8h_a8704c31c2d7a73953f3c1c320447c24a}
Allocates memory. Currently this memory is freed automatically on exit from the bytecode, and there is no way to free it sooner. 
\begin{DoxyParams}{Parameters}
\item[{\em size}]amount of memory to allocate in bytes \end{DoxyParams}
\begin{DoxyReturn}{Returns}
pointer to allocated memory 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a962d8bc4658ba7dd411c75d7561c2fee}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!map\_\-addkey@{map\_\-addkey}}
\index{map\_\-addkey@{map\_\-addkey}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{map\_\-addkey}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t map\_\-addkey (const uint8\_\-t $\ast$ {\em key}, \/  int32\_\-t {\em ksize}, \/  int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_a962d8bc4658ba7dd411c75d7561c2fee}
Inserts the specified key/value pair into the map. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]id of table \item[{\em key}]key \item[{\em ksize}]size of {\ttfamily key} \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 -\/ if key didn't exist before 1 -\/ if key existed -\/1 -\/ if ksize doesn't match keysize specified at table creation 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a2603885df2096dc840d887461c3b1aac}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!map\_\-done@{map\_\-done}}
\index{map\_\-done@{map\_\-done}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{map\_\-done}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t map\_\-done (int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_a2603885df2096dc840d887461c3b1aac}
Deallocates the memory used by the specified map. Trying to use the map after this will result in an error. All maps are automatically deallocated when the bytecode finishes execution. \hypertarget{bytecode__api_8h_ac45a2c7ac861578b8001b2116eee10aa}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!map\_\-find@{map\_\-find}}
\index{map\_\-find@{map\_\-find}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{map\_\-find}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t map\_\-find (const uint8\_\-t $\ast$ {\em key}, \/  int32\_\-t {\em ksize}, \/  int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_ac45a2c7ac861578b8001b2116eee10aa}
Looks up key in map. The map remember the last looked up key (so you can retrieve the value).


\begin{DoxyParams}{Parameters}
\item[{\em id}]id of map \item[{\em key}]key \item[{\em ksize}]size of key \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 -\/ if not found 1 -\/ if found -\/1 -\/ if ksize doesn't match the size specified at table creation 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a6a8bbb58c0ccad537eec575949e5f9f7}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!map\_\-getvalue@{map\_\-getvalue}}
\index{map\_\-getvalue@{map\_\-getvalue}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{map\_\-getvalue}]{\setlength{\rightskip}{0pt plus 5cm}uint8\_\-t$\ast$ map\_\-getvalue (int32\_\-t {\em id}, \/  int32\_\-t {\em size})}\hfill}
\label{bytecode__api_8h_a6a8bbb58c0ccad537eec575949e5f9f7}
Returns the value obtained during last map\_\-find. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]id of map. \item[{\em size}]size of value (obtained from map\_\-getvaluesize) \end{DoxyParams}
\begin{DoxyReturn}{Returns}
value 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_aac4176bebb0d4896ad64452bec023012}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!map\_\-getvaluesize@{map\_\-getvaluesize}}
\index{map\_\-getvaluesize@{map\_\-getvaluesize}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{map\_\-getvaluesize}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t map\_\-getvaluesize (int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_aac4176bebb0d4896ad64452bec023012}
Returns the size of value obtained during last map\_\-find. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]id of map. \end{DoxyParams}
\begin{DoxyReturn}{Returns}
size of value 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a8350ff5a10c6d2b8aa5c9b20bd0b032f}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!map\_\-new@{map\_\-new}}
\index{map\_\-new@{map\_\-new}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{map\_\-new}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t map\_\-new (int32\_\-t {\em keysize}, \/  int32\_\-t {\em valuesize})}\hfill}
\label{bytecode__api_8h_a8350ff5a10c6d2b8aa5c9b20bd0b032f}
Creates a new map and returns its id. 
\begin{DoxyParams}{Parameters}
\item[{\em keysize}]size of key \item[{\em valuesize}]size of value, if 0 then value is allocated separately \end{DoxyParams}
\begin{DoxyReturn}{Returns}
ID of new map 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_aeadbaac505160a820fe766cdaf95aba6}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!map\_\-remove@{map\_\-remove}}
\index{map\_\-remove@{map\_\-remove}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{map\_\-remove}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t map\_\-remove (const uint8\_\-t $\ast$ {\em key}, \/  int32\_\-t {\em ksize}, \/  int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_aeadbaac505160a820fe766cdaf95aba6}
Remove an element from the map. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]id of map \item[{\em key}]key \item[{\em ksize}]size of key \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 on success, key was present 1 if key was not present -\/1 if ksize doesn't match keysize specified at table creation 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_afdae99c4fa909e017962e8b869950005}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!map\_\-setvalue@{map\_\-setvalue}}
\index{map\_\-setvalue@{map\_\-setvalue}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{map\_\-setvalue}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t map\_\-setvalue (const uint8\_\-t $\ast$ {\em value}, \/  int32\_\-t {\em vsize}, \/  int32\_\-t {\em id})}\hfill}
\label{bytecode__api_8h_afdae99c4fa909e017962e8b869950005}
Sets the value for the last inserted key with map\_\-addkey. 
\begin{DoxyParams}{Parameters}
\item[{\em id}]id of table \item[{\em value}]value \item[{\em vsize}]size of {\ttfamily value} \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 -\/ if update was successful -\/1 -\/ if there is no last key 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a5d46e3fbbec8277f894d998a9b0dfdbc}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!memstr@{memstr}}
\index{memstr@{memstr}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{memstr}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t memstr (const uint8\_\-t $\ast$ {\em haystack}, \/  int32\_\-t {\em haysize}, \/  const uint8\_\-t $\ast$ {\em needle}, \/  int32\_\-t {\em needlesize})}\hfill}
\label{bytecode__api_8h_a5d46e3fbbec8277f894d998a9b0dfdbc}
-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ string operations -\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/-\/ Return position of match, -\/1 otherwise. 
\begin{DoxyParams}{Parameters}
\item[{\em haystack}]buffer to search \item[{\em haysize}]size of {\ttfamily haystack} \item[{\em needle}]substring to search \item[{\em needlesize}]size of needle \end{DoxyParams}
\begin{DoxyReturn}{Returns}
location of match, -\/1 otherwise 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a0d081f8f58263eb99d68690f1f9b2a81}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!pe\_\-rawaddr@{pe\_\-rawaddr}}
\index{pe\_\-rawaddr@{pe\_\-rawaddr}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{pe\_\-rawaddr}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t pe\_\-rawaddr (uint32\_\-t {\em rva})}\hfill}
\label{bytecode__api_8h_a0d081f8f58263eb99d68690f1f9b2a81}
Converts a RVA (Relative Virtual Address) to an absolute PE file offset. 
\begin{DoxyParams}{Parameters}
\item[{\em rva}]a rva address from the PE file \end{DoxyParams}
\begin{DoxyReturn}{Returns}
absolute file offset mapped to the {\ttfamily rva}, or PE\_\-INVALID\_\-RVA if the {\ttfamily rva} is invalid. 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_afa4f1c799291804204aea54ce23077d6}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!read@{read}}
\index{read@{read}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{read}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t read (uint8\_\-t $\ast$ {\em data}, \/  int32\_\-t {\em size})}\hfill}
\label{bytecode__api_8h_afa4f1c799291804204aea54ce23077d6}


Reads specified amount of bytes from the current file into a buffer. Also moves current position in the file. 


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em size}]amount of bytes to read \item[\mbox{$\rightarrow$} {\em data}]pointer to buffer where data is read into \end{DoxyParams}
\begin{DoxyReturn}{Returns}
amount read. 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a50b84b15fbaf03aa39b41ef7ffb5243e}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!read\_\-number@{read\_\-number}}
\index{read\_\-number@{read\_\-number}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{read\_\-number}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t read\_\-number (uint32\_\-t {\em radix})}\hfill}
\label{bytecode__api_8h_a50b84b15fbaf03aa39b41ef7ffb5243e}
Reads a number in the specified radix starting from the current position. Non-\/numeric characters are ignored. 
\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em radix}]10 or 16 \end{DoxyParams}
\begin{DoxyReturn}{Returns}
the number read 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_aac5ea598a656985291c56321ad2140ea}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!seek@{seek}}
\index{seek@{seek}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{seek}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t seek (int32\_\-t {\em pos}, \/  uint32\_\-t {\em whence})}\hfill}
\label{bytecode__api_8h_aac5ea598a656985291c56321ad2140ea}


Changes the current file position to the specified one. 

\begin{DoxySeeAlso}{See also}
\hyperlink{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7a7f53e3798ec48e79c0897ba5138f9b05}{SEEK\_\-SET}, \hyperlink{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7af3091144c125782cf17bcd3eb84e454c}{SEEK\_\-CUR}, \hyperlink{bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7a060e45245be703e272d7264bafcfdc63}{SEEK\_\-END} 
\end{DoxySeeAlso}

\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em pos}]offset (absolute or relative depending on {\ttfamily whence} param) \item[\mbox{$\leftarrow$} {\em whence}]one of {\ttfamily SEEK\_\-SET}, {\ttfamily SEEK\_\-CUR}, {\ttfamily SEEK\_\-END} \end{DoxyParams}
\begin{DoxyReturn}{Returns}
absolute position in file 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a77cd19560715e7a2f658fc3ac519d18e}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!setvirusname@{setvirusname}}
\index{setvirusname@{setvirusname}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{setvirusname}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t setvirusname (const uint8\_\-t $\ast$ {\em name}, \/  uint32\_\-t {\em len})}\hfill}
\label{bytecode__api_8h_a77cd19560715e7a2f658fc3ac519d18e}
Sets the name of the virus found.


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em name}]the name of the virus \item[\mbox{$\leftarrow$} {\em len}]length of the virusname \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_af445932f85a581e254806f034225ecf1}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!test1@{test1}}
\index{test1@{test1}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{test1}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t test1 (uint32\_\-t {\em a}, \/  uint32\_\-t {\em b})}\hfill}
\label{bytecode__api_8h_af445932f85a581e254806f034225ecf1}
Test api. 
\begin{DoxyParams}{Parameters}
\item[{\em a}]0xf00dbeef \item[{\em b}]0xbeeff00d \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0x12345678 if parameters match, 0x55 otherwise 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_abf709b9bcdfd2da159ec288df9dc7ad9}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!test2@{test2}}
\index{test2@{test2}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{test2}]{\setlength{\rightskip}{0pt plus 5cm}uint32\_\-t test2 (uint32\_\-t {\em a})}\hfill}
\label{bytecode__api_8h_abf709b9bcdfd2da159ec288df9dc7ad9}
Test api2. 
\begin{DoxyParams}{Parameters}
\item[{\em a}]0xf00d \end{DoxyParams}
\begin{DoxyReturn}{Returns}
0xd00f if parameter matches, 0x5555 otherwise 
\end{DoxyReturn}
\hypertarget{bytecode__api_8h_a01d98e416d08e0eabd02d2e8aa56f28e}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!write@{write}}
\index{write@{write}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{write}]{\setlength{\rightskip}{0pt plus 5cm}int32\_\-t write (uint8\_\-t $\ast$ {\em data}, \/  int32\_\-t {\em size})}\hfill}
\label{bytecode__api_8h_a01d98e416d08e0eabd02d2e8aa56f28e}


Writes the specified amount of bytes from a buffer to the current temporary file. 


\begin{DoxyParams}{Parameters}
\item[\mbox{$\leftarrow$} {\em data}]pointer to buffer of data to write \item[\mbox{$\leftarrow$} {\em size}]amount of bytes to write {\ttfamily size} bytes to temporary file, from the buffer pointed to byte \end{DoxyParams}
\begin{DoxyReturn}{Returns}
amount of bytes successfully written 
\end{DoxyReturn}


\subsubsection{Variable Documentation}
\hypertarget{bytecode__api_8h_ab8d6c50474be3ba69906161a3e520ce7}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!\_\-\_\-clambc\_\-filesize@{\_\-\_\-clambc\_\-filesize}}
\index{\_\-\_\-clambc\_\-filesize@{\_\-\_\-clambc\_\-filesize}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{\_\-\_\-clambc\_\-filesize}]{\setlength{\rightskip}{0pt plus 5cm}const uint32\_\-t {\bf \_\-\_\-clambc\_\-filesize}\mbox{[}1\mbox{]}}\hfill}
\label{bytecode__api_8h_ab8d6c50474be3ba69906161a3e520ce7}
File size (max 4G) \hypertarget{bytecode__api_8h_a6eb3802e21949cfdf6b91570d3c62c99}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!\_\-\_\-clambc\_\-kind@{\_\-\_\-clambc\_\-kind}}
\index{\_\-\_\-clambc\_\-kind@{\_\-\_\-clambc\_\-kind}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{\_\-\_\-clambc\_\-kind}]{\setlength{\rightskip}{0pt plus 5cm}const uint16\_\-t {\bf \_\-\_\-clambc\_\-kind}}\hfill}
\label{bytecode__api_8h_a6eb3802e21949cfdf6b91570d3c62c99}
Kind of the bytecode \hypertarget{bytecode__api_8h_a35a0a4f1219a792c77b7207924c3c4ec}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!\_\-\_\-clambc\_\-match\_\-counts@{\_\-\_\-clambc\_\-match\_\-counts}}
\index{\_\-\_\-clambc\_\-match\_\-counts@{\_\-\_\-clambc\_\-match\_\-counts}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{\_\-\_\-clambc\_\-match\_\-counts}]{\setlength{\rightskip}{0pt plus 5cm}const uint32\_\-t {\bf \_\-\_\-clambc\_\-match\_\-counts}\mbox{[}64\mbox{]}}\hfill}
\label{bytecode__api_8h_a35a0a4f1219a792c77b7207924c3c4ec}


Logical signature match counts. 

This is a low-\/level variable, use the Macros in \hyperlink{bytecode__local_8h}{bytecode\_\-local.h} instead to access it. \hypertarget{bytecode__api_8h_a3d386181912bdbc2b90ee559b0cccde3}{
\index{bytecode\_\-api.h@{bytecode\_\-api.h}!\_\-\_\-clambc\_\-pedata@{\_\-\_\-clambc\_\-pedata}}
\index{\_\-\_\-clambc\_\-pedata@{\_\-\_\-clambc\_\-pedata}!bytecode_api.h@{bytecode\_\-api.h}}
\paragraph[{\_\-\_\-clambc\_\-pedata}]{\setlength{\rightskip}{0pt plus 5cm}struct {\bf cli\_\-pe\_\-hook\_\-data} {\bf \_\-\_\-clambc\_\-pedata}}\hfill}
\label{bytecode__api_8h_a3d386181912bdbc2b90ee559b0cccde3}
PE data, if this is a PE hook 