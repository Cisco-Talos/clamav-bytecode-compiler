<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"  
  "http://www.w3.org/TR/html4/loose.dtd">  
<html > 
<head><title></title> 
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"> 
<meta name="generator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<meta name="originator" content="TeX4ht (http://www.cse.ohio-state.edu/~gurari/TeX4ht/)"> 
<!-- html --> 
<meta name="src" content="clambc-user.tex"> 
<meta name="date" content="2011-10-11 12:12:00"> 
<link rel="stylesheet" type="text/css" href="clambc-user.css"> 
</head><body 
>
                                                                                

                                                                                
<!--l. 234--><p class="noindent" >
                                                                                

                                                                                
<!--l. 237--><p class="noindent" ><img 
src="clambc-user0x.png" alt="PIC" class="graphics" width="353.0pt" height="347.00977pt" ><!--tex4ht:graphics  
name="clambc-user0x.png" src="clam.eps"  
-->
                                                                                <div class="flushright" 
>
<!--l. 239--><p class="noindent" >
 ____________________________________________________________________<br />
<span 
class="ec-lmr-17x-x-120">ClamAV Bytecode Compiler</span><br />
<span 
class="ec-lmri-12x-x-172">User Manual</span><br />
</div>
<!--l. 244--><p class="noindent" >
                                                                                

                                                                                
<!--l. 247--><p class="noindent" ><span 
class="ec-lmbx-12x-x-207">Contents</span>
<!--l. 249--><p class="noindent" ><span class="boxedminipage"> ClamAV Bytecode Compiler - Internals Manual,<br 
class="newline" /><span 
class="ts1-lmr10-">©</span>&#x00A0;2009 Sourcefire, Inc.<br 
class="newline" />Authors: Török Edvin<br 
class="newline" />This document is distributed under the terms of the GNU General Public License v2.<br 
class="newline" />
 Clam AntiVirus is free software; you can redistribute it and/or modify it under the terms of
 the GNU General Public License as published by the Free Software Foundation; version 2 of
 the License.<br 
class="newline" />
 This  program  is  distributed  in  the  hope  that  it  will  be  useful,  but  WITHOUT  ANY
 WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR
 A PARTICULAR PURPOSE. See the GNU General Public License for more details.<br 
class="newline" />
 You should have received a copy of the GNU General Public License along with this program;
 if not, write to the Free Software Foundation, Inc., 51 Franklin Street, Fifth Floor, Boston, MA
 02110-1301, USA.
</span>
<!--l. 273--><p class="noindent" ><span class="boxedminipage"> ClamAV and Clam AntiVirus are trademarks of Sourcefire, Inc.
</span>
                                                                                

                                                                                
                                                                                

                                                                                
                                                                                

                                                                                
                                                                                

                                                                                
                                                                                

                                                                                
                                                                                

                                                                                
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;1</span><br /><a 
 id="x1-10001"></a>Installation</h2>
<a 
 id="x1-1001r1"></a>
<h3 class="sectionHead"><span class="titlemark">1.1. </span> <a 
 id="x1-20001"></a>Requirements</h3>
<!--l. 3--><p class="noindent" >The ClamAV Bytecode Compiler uses the LLVM compiler framework, thus requires an Operating
System where building LLVM is supported:
     <ul class="itemize1">
     <li class="itemize">FreeBSD/x86
     </li>
     <li class="itemize">Linux/{x86,x86_64,ppc}
     </li>
     <li class="itemize">Mac OS X/{x86,ppc}
     </li>
     <li class="itemize">Solaris/sparcv9
     </li>
     <li class="itemize">Windows/x86 using mingw32 or Visual Studio</li></ul>
<!--l. 13--><p class="indent" >   The following packages are required to compile the ClamAV Bytecode Compiler:
     <ul class="itemize1">
     <li class="itemize">GCC C and C++ compilers (minimum 4.1.3, recommended: 4.3.4 or newer) <span class="footnote-mark"><a 
href="clambc-user2.html#fn1x1"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-2001f1"></a> .
     </li>
     <li class="itemize">Perl (version 5.6.0+)
     </li>
     <li class="itemize">GNU make (version 3.79+, recommended 3.81)</li></ul>
<!--l. 22--><p class="indent" >   The following packages are optional, but highly recommended:
     <ul class="itemize1">
     <li class="itemize">Python (version 2.5.4+?) - for running the tests</li></ul>
<a 
 id="x1-2002r2"></a>
<h3 class="sectionHead"><span class="titlemark">1.2. </span> <a 
 id="x1-30002"></a>Obtaining the ClamAV Bytecode Compiler</h3>
<!--l. 28--><p class="noindent" >You can obtain the source code in one of the following ways
<span class="footnote-mark"><a 
href="clambc-user3.html#fn2x1"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-3001f2"></a>
     <ul class="itemize1">
     <li class="itemize">Check out the source code using git native protocol:
     <!--l. 33--><p class="noindent" ><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">git</span><span 
class="ec-lmtt-10">&#x00A0;clone</span><span 
class="ec-lmtt-10">&#x00A0;git://git.clamav.net/git/clamav-bytecode-compiler</span></span></span>
     </li>
     <li class="itemize">Check out the source code using HTTP:
     <!--l. 36--><p class="noindent" ><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">git</span><span 
class="ec-lmtt-10">&#x00A0;clone</span><span 
class="ec-lmtt-10">&#x00A0;http://git.clamav.net/git/clamav-bytecode-compiler.git</span></span></span></li></ul>
                                                                                

                                                                                
<!--l. 39--><p class="indent" >   You can keep the source code updated using:
<!--l. 41--><p class="indent" >   <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">git</span><span 
class="ec-lmtt-10">&#x00A0;pull</span></span></span>
<a 
 id="x1-3002r3"></a>
<h3 class="sectionHead"><span class="titlemark">1.3. </span> <a 
 id="x1-40003"></a>Building</h3>
<a 
 id="x1-4001r1"></a>
<h4 class="subsectionHead"><span class="titlemark">1.3.1. </span> <a 
 id="x1-50001"></a>Disk space</h4>
<!--l. 45--><p class="noindent" >A minimalistic release build requires &#x00A0;100M of disk space.
<!--l. 47--><p class="indent" >   Testing the compiler requires a full build, &#x00A0;320M of disk space. A debug build requires significantly
more disk space (1.4G for a minimalistic debug build).
<!--l. 51--><p class="indent" >   Note that this only needed during the build process, once installed only &#x00A0;12M is needed.
<a 
 id="x1-5001r5"></a>
<h4 class="subsectionHead"><span class="titlemark">1.3.2. </span> <a 
 id="x1-60002"></a>Create build directory</h4>
<!--l. 55--><p class="noindent" >Building requires a separate object directory, building in the source directory is not supported. Create a
build directory:
<!--l. 58--><p class="indent" >   <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">$</span><span 
class="ec-lmtt-10">&#x00A0;cd</span><span 
class="ec-lmtt-10">&#x00A0;clamav-bytecode-compiler</span><span 
class="ec-lmtt-10">&#x00A0;&amp;&amp;</span><span 
class="ec-lmtt-10">&#x00A0;mkdir</span><span 
class="ec-lmtt-10">&#x00A0;obj</span></span></span>
<!--l. 60--><p class="indent" >   Run configure (you can use any prefix you want, this example uses <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">/usr/local/clamav</span></span></span>):
                                                                                

                                                                                
   <div class="verbatim" id="verbatim-1">
$&#x00A0;cd&#x00A0;obj&#x00A0;&amp;&amp;&#x00A0;../llvm/configure&#x00A0;--enable-optimized&#x00A0;\
&#x00A0;<br />&#x00A0;--enable-targets=host-only&#x00A0;--disable-bindings&#x00A0;\
&#x00A0;<br />--prefix=/usr/local/clamav
</div>
<!--l. 65--><p class="nopar" >
<!--l. 67--><p class="indent" >   Run the build under ulimit <span class="footnote-mark"><a 
href="clambc-user4.html#fn3x1"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-6001f1"></a> :
                                                                                

                                                                                
   <div class="verbatim" id="verbatim-2">
$&#x00A0;(ulimit&#x00A0;-t&#x00A0;3600&#x00A0;-v&#x00A0;512000&#x00A0;&amp;&amp;&#x00A0;make&#x00A0;clambc-only&#x00A0;-j4)
</div>
<!--l. 70--><p class="nopar" >
<a 
 id="x1-6002r4"></a>
<h3 class="sectionHead"><span class="titlemark">1.4. </span> <a 
 id="x1-70004"></a>Testing</h3>
                                                                                

                                                                                
   <div class="verbatim" id="verbatim-3">
$&#x00A0;(ulimit&#x00A0;-t&#x00A0;3600&#x00A0;v&#x00A0;512000&#x00A0;&amp;&amp;&#x00A0;make&#x00A0;-j4)
&#x00A0;<br />$&#x00A0;make&#x00A0;check-all
</div>
<!--l. 76--><p class="nopar" >
<!--l. 78--><p class="indent" >   If make check reports errors, check that your compiler is NOT on this list:
<a 
href="http://llvm.org/docs/GettingStarted.html#brokengcc" class="url" ><span 
class="ec-lmtt-10">http://llvm.org/docs/GettingStarted.html#brokengcc</span></a>.
<!--l. 81--><p class="indent" >   If it is, then your compiler is buggy, and you need to do one of the following: upgrade your compiler
to a non-buggy version, upgrade the OS to one that has a non-buggy compiler, compile with
<span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">export</span><span 
class="ec-lmtt-10">&#x00A0;OPTMIZE_OPTION=-O2</span></span></span>, or <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">export</span><span 
class="ec-lmtt-10">&#x00A0;OPTIMIZE_OPTION=-O1</span></span></span>, or <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">export</span><span 
class="ec-lmtt-10">&#x00A0;OPTIMIZE_OPTION=\-O1</span></span></span>.
<!--l. 85--><p class="indent" >   If not you probably found a bug, report it at <a 
href="http://bugs.clamav.net" class="url" ><span 
class="ec-lmtt-10">http://bugs.clamav.net</span></a>
<a 
 id="x1-7001r7"></a>
<h3 class="sectionHead"><span class="titlemark">1.5. </span> <a 
 id="x1-80005"></a>Installing</h3>
<!--l. 88--><p class="noindent" >Install it:
                                                                                

                                                                                
   <div class="verbatim" id="verbatim-4">
$&#x00A0;make&#x00A0;install-clambc&#x00A0;-j8
</div>
<!--l. 91--><p class="nopar" >
<a 
 id="x1-8001r6"></a>
<h4 class="subsectionHead"><span class="titlemark">1.5.1. </span> <a 
 id="x1-90001"></a>Structure of installed files</h4>
     <ol  class="enumerate1" >
     <li 
  class="enumerate" id="x1-9002x1">The ClamAV Bytecode compiler driver: <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">$PREFIX/bin/clambc-compiler</span></span></span>
     </li>
     <li 
  class="enumerate" id="x1-9004x2">ClamAV bytecode header files:
                                                                                

                                                                                
     <div class="verbatim" id="verbatim-5">
     $PREFIX/lib/clang/1.1/include:
     &#x00A0;<br />bcfeatures.h
     &#x00A0;<br />bytecode_{api_decl.c,api,disasm,execs,features}.h
     &#x00A0;<br />bytecode.h
     &#x00A0;<br />bytecode_{local,pe,types}.h
</div>
     <!--l. 104--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x1-9006x3">clang compiler (with ClamAV bytecode backend) compiler include files:
                                                                                

                                                                                
     <div class="verbatim" id="verbatim-6">
     $PREFIX/lib/clang/1.1/include:
     &#x00A0;<br />emmintrin.h
     &#x00A0;<br />float.h
     &#x00A0;<br />iso646.h
     &#x00A0;<br />limits.h
     &#x00A0;<br />{,p,t,x}mmintrin.h
     &#x00A0;<br />mm_malloc.h
     &#x00A0;<br />std{arg,bool,def,int}.h
     &#x00A0;<br />tgmath.h
</div>
     <!--l. 116--><p class="nopar" >
     </li>
     <li 
  class="enumerate" id="x1-9008x4">User manual
                                                                                

                                                                                
     <div class="verbatim" id="verbatim-7">
     $PREFIX/docs/clamav/clambc-user.pdf
</div>
     <!--l. 120--><p class="nopar" ></li></ol>
                                                                                

                                                                                
                                                                                

                                                                                
                                                                                

                                                                                
<!--l. 1--><p class="indent" >
                                                                                

                                                                                
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;2</span><br /><a 
 id="x1-100002"></a>Tutorial</h2>
<a 
 id="x1-10001r8"></a>
<h3 class="sectionHead"><span class="titlemark">2.1. </span> <a 
 id="x1-110001"></a>Short introduction to the bytecode language</h3>
<a 
 id="x1-11001r9"></a>
<h4 class="subsectionHead"><span class="titlemark">2.1.1. </span> <a 
 id="x1-120001"></a>Types, variables and constants</h4>
<a 
 id="x1-12001r12"></a>
<h4 class="subsectionHead"><span class="titlemark">2.1.2. </span> <a 
 id="x1-130002"></a>Arrays and pointers</h4>
<a 
 id="x1-13001r13"></a>
<h4 class="subsectionHead"><span class="titlemark">2.1.3. </span> <a 
 id="x1-140003"></a>Arithmetics</h4>
<a 
 id="x1-14001r14"></a>
<h4 class="subsectionHead"><span class="titlemark">2.1.4. </span> <a 
 id="x1-150004"></a>Functions</h4>
<a 
 id="x1-15001r15"></a>
<h4 class="subsectionHead"><span class="titlemark">2.1.5. </span> <a 
 id="x1-160005"></a>Control flow</h4>
<a 
 id="x1-16001r16"></a>
<h4 class="subsectionHead"><span class="titlemark">2.1.6. </span> <a 
 id="x1-170006"></a>Common functions</h4>
<a 
 id="x1-17001r11"></a>
<h3 class="sectionHead"><span class="titlemark">2.2. </span> <a 
 id="x1-180002"></a>Writing logical signature bytecodes</h3>
<!--l. 11--><p class="noindent" ><span class="footnote-mark"><a 
href="clambc-user5.html#fn1x2"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-18001f1"></a>
Logical signatures can be used as triggers for executing bytecode. However, instead of describing a
logical signature as a <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">.ldb</span></span></span> pattern, you use (simple) C code which is later translated to a <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">.ldb</span></span></span>-style
logical signature by the ClamAV Bytecode Compiler.
<!--l. 17--><p class="indent" >   A bytecode triggered by a logical signature is much more powerful than a logical signature itself:
you can write complex algorithmic detections, and use the logical signature as a <span 
class="ec-lmri-10">filter </span>(to speed up
matching). Thus another name for &#8220;logical signature bytecodes&#8221; is &#8220;algorithmic detection bytecodes&#8221;.
The detection you write in bytecode has read-only access to the file being scanned and its metadata
(PE sections, EP, etc.).
<a 
 id="x1-18002r17"></a>
<h4 class="subsectionHead"><span class="titlemark">2.2.1. </span> <a 
 id="x1-190001"></a>Structure of a bytecode for algorithmic detection</h4>
<!--l. 24--><p class="noindent" >Algorithmic detection bytecodes are triggered when a logical signature matches. They can execute an
algorithm that determines whether the file is infected and with which virus.
<!--l. 28--><p class="indent" >   A bytecode can be either algorithmic or an unpacker (or other hook), but not both.
<!--l. 30--><p class="indent" >   It consists of:
     <ul class="itemize1">
     <li class="itemize">Definition of virusnames used in the bytecode
     </li>
     <li class="itemize">Pattern definitions (for logical subexpressions)
     </li>
     <li class="itemize">The logical signature as C function: <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">bool</span><span 
class="ec-lmtt-10">&#x00A0;logical_trigger(void)</span></span></span>
                                                                                

                                                                                
     </li>
     <li class="itemize">The  <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">int</span><span 
class="ec-lmtt-10">&#x00A0;entrypoint(void)</span></span></span> function  which  gets  executed  when  the  logical  signature
     matches
     </li>
     <li class="itemize">(Optional) Other functions and global constants used in <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">entrypoint</span></span></span></li></ul>
<!--l. 39--><p class="indent" >   The syntax for defining logical signatures, and an example is described in Section&#x00A0;<a 
href="#x1-220004">2.2.4<!--tex4ht:ref: sec:lsigstut --></a>.
<!--l. 41--><p class="indent" >   The function <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">entrypoint</span></span></span> must report the detected virus by calling <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">foundVirus</span></span></span> and
returning <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">0</span></span></span>. It is recommended that you always return <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">0</span></span></span>, otherwise a warning is shown and the
file is considered clean. If <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">foundVirus</span></span></span> is not called, then ClamAV also assumes the file is
clean.
<a 
 id="x1-19001r19"></a>
<h4 class="subsectionHead"><span class="titlemark">2.2.2. </span> <a 
 id="x1-200002"></a>Virusnames</h4>
<!--l. 46--><p class="noindent" >Each logical signature bytecode must have a virusname prefix, and one or more virusnames. The
virusname prefix is used by the SI to ensure unique virusnames (a unique number is appended for
duplicate prefixes).
                                                                                

                                                                                
<!--l. 50--><p class="indent" >   <a 
 id="x1-20007r1"></a><hr class="float"><div class="float" 
>
                                                                                

                                                                                
<!--l. 50-->
<div class="lstlisting" id="listing-1"><span class="label"><a 
 id="x1-20001r1"></a><span 
class="ec-lmr-5">1</span></span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">Prefix</span><span 
class="ec-lmr-8">,</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">used</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">for</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">duplicate</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">detection</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">and</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">fixing</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20002r2"></a></span><span 
class="ec-lmtt-8">VIRUSNAME_PREFIX</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">Trojan</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">Foo</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20003r3"></a><span 
class="ec-lmr-5">3</span></span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">You</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">are</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">only</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">allowed</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">to</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">set</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">these</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">virusnames</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">as</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">found</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20004r4"></a></span><span 
class="ec-lmtt-8">VIRUSNAMES</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">A</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">B</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20005r5"></a><span 
class="ec-lmr-5">5</span></span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">File</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">type</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-20006r6"></a></span><span 
class="ec-lmtt-8">TARGET</span><span 
class="ec-lmtt-8">(2)</span>
</div>
<br /> <div class="caption" 
><span class="id">Program 1: </span><span  
class="content">Declaring virusnames</span></div><!--tex4ht:label?: x1-20007r1 -->
                                                                                

                                                                                
   </div><hr class="endfloat" />
<!--l. 62--><p class="indent" >   In Program&#x00A0;<a 
href="#x1-20007r1">1<!--tex4ht:ref: prg:virname --></a> 3 predefied macros are used:
     <ul class="itemize1">
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">VIRUSNAME_PREFIX</span></span></span> which must have exactly one string argument
     </li>
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">VIRUSNAMES</span></span></span> which must have one or more string arguments
     </li>
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">TARGET</span></span></span> which must have exactly one integer argument</li></ul>
<!--l. 69--><p class="indent" >   In this example, the bytecode could generate one of these virusnames: <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">Trojan.Foo.A</span></span></span>, or
<span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">Trojan.Foo.B</span></span></span>, by calling <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">foundVirus("A")</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">foundVirus("B")</span></span></span> respectively (notice that the prefix is
not part of these calls).
<a 
 id="x1-20008r20"></a>
<h4 class="subsectionHead"><span class="titlemark">2.2.3. </span> <a 
 id="x1-210003"></a>Patterns</h4>
<!--l. 74--><p class="noindent" >Logical signatures use <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">.ndb</span></span></span> style patterns, an example on how to define these is shown in
Program&#x00A0;<a 
href="#x1-21012r2">2<!--tex4ht:ref: prg:patterns --></a>.
                                                                                

                                                                                
<!--l. 77--><p class="indent" >   <a 
 id="x1-21012r2"></a><hr class="float"><div class="float" 
>
                                                                                

                                                                                
<!--l. 77-->
<div class="lstlisting" id="listing-2"><span class="label"><a 
 id="x1-21001r1"></a></span><span 
class="ec-lmtt-8">SIGNATURES_DECL_BEGIN</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21002r2"></a><span 
class="ec-lmr-5">2</span></span><span 
class="ec-lmtt-8">DECLARE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">magic</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21003r3"></a></span><span 
class="ec-lmtt-8">DECLARE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">check</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21004r4"></a><span 
class="ec-lmr-5">4</span></span><span 
class="ec-lmtt-8">DECLARE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">zero</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21005r5"></a></span><span 
class="ec-lmtt-8">SIGNATURES_DECL_END</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21006r6"></a><span 
class="ec-lmr-5">6</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21007r7"></a></span><span 
class="ec-lmtt-8">SIGNATURES_DEF_BEGIN</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21008r8"></a><span 
class="ec-lmr-5">8</span></span><span 
class="ec-lmtt-8">DEFINE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">magic</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">EP</span><span 
class="ec-lmtt-8">+0:</span><span 
class="ec-lmtt-8">aabb</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21009r9"></a></span><span 
class="ec-lmtt-8">DEFINE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">check</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">f00d</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21010r10"></a><span 
class="ec-lmr-5">10</span></span><span 
class="ec-lmtt-8">DEFINE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">zero</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">ffff</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21011r11"></a></span><span 
class="ec-lmtt-8">SIGNATURES_END</span>
</div>
<br /> <div class="caption" 
><span class="id">Program 2: </span><span  
class="content">Declaring patterns</span></div><!--tex4ht:label?: x1-21012r2 -->
                                                                                

                                                                                
   </div><hr class="endfloat" />
<!--l. 94--><p class="indent" >   Each pattern has a name (like a variable), and a string that is the hex pattern itself. The
declarations are delimited by the macros <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">SIGNATURES_DECL_BEGIN</span></span></span>, and <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">SIGNATURES_DECL_END</span></span></span>. The
definitions are delimited by the macros <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">SIGNATURES_DEF_BEGIN</span></span></span>, and <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">SIGNATURES_END</span></span></span>. Declarations
must always come before definitions, and you can have only one declaration and declaration section!
(think of declaration like variable declarations, and definitions as variable assignments, since that what
they are under the hood). The order in which you declare the signatures is the order in which they
appear in the generated logical signature.
<!--l. 104--><p class="indent" >   You can use any name for the patterns that is a valid record field name in C, and doesn&#8217;t conflict
with anything else declared.
<!--l. 107--><p class="indent" >   After using the above macros, the global variable <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">Signatures</span></span></span> will have two new fields: <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">magic</span></span></span>, and
<span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">zero</span></span></span>. These can be used as arguments to the functions <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">count_match()</span></span></span>, and <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">matches()</span></span></span> anywhere in
the program as shown in Program&#x00A0;<a 
href="#x1-21019r3">3<!--tex4ht:ref: prg:counting --></a>:
     <ul class="itemize1">
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">matches(Signatures.match)</span></span></span> will return true when the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">match</span></span></span> signature matches (at least
     once)
     </li>
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">count_match(Signatures.zero)</span></span></span> will  return  the  number  of  times  the  <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">zero</span></span></span> signature
     matched
     </li>
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">count_match(Signatures.check)</span></span></span> will return the number of times the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">check</span></span></span> signature
     matched</li></ul>
<!--l. 117--><p class="indent" >   The condition in the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">if</span></span></span> can be interpreted as: if the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">match</span></span></span> signature has matched at
least once, and the number of times the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">zero</span></span></span> signature matched is higher than the number
of times the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">check</span></span></span> signature matched, then we have found a virus <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">A</span></span></span>, otherwise the file is
clean.
                                                                                

                                                                                
<!--l. 122--><p class="indent" >   <a 
 id="x1-21019r3"></a><hr class="float"><div class="float" 
>
                                                                                

                                                                                
<!--l. 122-->
<div class="lstlisting" id="listing-3"><span class="label"><a 
 id="x1-21013r1"></a><span 
class="ec-lmr-5">1</span></span><span 
class="ec-lmtt-8">int</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">entrypoint</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">void</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21014r2"></a></span><span 
class="ec-lmtt-8">{</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21015r3"></a><span 
class="ec-lmr-5">3</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">if</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">matches</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">Signatures</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">match</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&amp;&amp;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">count_match</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">Signatures</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">zero</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x003E;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">count_match</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">Signatures</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">check</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21016r4"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">foundVirus</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">A</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21017r5"></a><span 
class="ec-lmr-5">5</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">return</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-21018r6"></a></span><span 
class="ec-lmtt-8">}</span>
</div>
<br /> <div class="caption" 
><span class="id">Program 3: </span><span  
class="content">Using patterns</span></div><!--tex4ht:label?: x1-21019r3 -->
                                                                                

                                                                                
   </div><hr class="endfloat" />
<a 
 id="x1-21020r22"></a>
<h4 class="subsectionHead"><span class="titlemark">2.2.4. </span> <a 
 id="x1-220004"></a>Single subsignature</h4>
<!--l. 136--><p class="noindent" >The simplest logical signature is like a <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">.ndb</span></span></span> signature: a virus name, signature target, 0 as logical expression
<span class="footnote-mark"><a 
href="clambc-user6.html#fn2x2"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-22001f1"></a>, and a
<span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">ndb</span></span></span>-style pattern.
<!--l. 139--><p class="indent" >   The code for this is shown in Program&#x00A0;<a 
href="#x1-22038r4">4<!--tex4ht:ref: prg:singlesig --></a>
                                                                                

                                                                                
<!--l. 141--><p class="indent" >   <a 
 id="x1-22038r4"></a><hr class="float"><div class="float" 
>
                                                                                

                                                                                
<!--l. 141--><div class="lstinputlisting">
<a 
 id="x1-22002"></a>
<span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22003r1"></a></span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">Declare</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">the</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">prefix</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">of</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">the</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">virusname</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22004r2"></a><span 
class="ec-lmr-5">2</span></span><span 
class="ec-lmtt-8">VIRUSNAME_PREFIX</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">Trojan</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">Foo</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22005r3"></a></span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">Declare</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">the</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">suffix</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">of</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">the</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">virusname</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22006r4"></a><span 
class="ec-lmr-5">4</span></span><span 
class="ec-lmtt-8">VIRUSNAMES</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">A</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22007r5"></a></span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">Declare</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">the</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">signature</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">target</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">type</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">(1</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">=</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">PE</span><span 
class="ec-lmr-8">)</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22008r6"></a><span 
class="ec-lmr-5">6</span></span><span 
class="ec-lmtt-8">TARGET</span><span 
class="ec-lmtt-8">(1)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22009r7"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22010r8"></a><span 
class="ec-lmr-5">8</span></span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">Declare</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">the</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">name</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">of</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">all</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">subsignatures</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">used</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22011r9"></a></span><span 
class="ec-lmtt-8">SIGNATURES_DECL_BEGIN</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22012r10"></a><span 
class="ec-lmr-5">10</span></span><span 
class="ec-lmtt-8">DECLARE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">magic</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22013r11"></a></span><span 
class="ec-lmtt-8">SIGNATURES_DECL_END</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22014r12"></a><span 
class="ec-lmr-5">12</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22015r13"></a></span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">Define</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">the</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">pattern</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">for</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">each</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">subsignature</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22016r14"></a><span 
class="ec-lmr-5">14</span></span><span 
class="ec-lmtt-8">SIGNATURES_DEF_BEGIN</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22017r15"></a></span><span 
class="ec-lmtt-8">DEFINE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">magic</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">aabb</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22018r16"></a><span 
class="ec-lmr-5">16</span></span><span 
class="ec-lmtt-8">SIGNATURES_END</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22019r17"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22020r18"></a><span 
class="ec-lmr-5">18</span></span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">All</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">bytecode</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">triggered</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">by</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">logical</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">signatures</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">must</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">have</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">this</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22021r19"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">function</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22022r20"></a><span 
class="ec-lmr-5">20</span></span><span 
class="ec-lmtt-8">bool</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">logical_trigger</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">void</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22023r21"></a></span><span 
class="ec-lmtt-8">{</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22024r22"></a><span 
class="ec-lmr-5">22</span></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">return</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">true</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">if</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">the</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">magic</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">subsignature</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">matched</span><span 
class="ec-lmr-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22025r23"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">its</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">pattern</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">is</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">defined</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">above</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">to</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">"</span><span 
class="ec-lmr-8">aabb</span><span 
class="ec-lmr-8">"</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22026r24"></a><span 
class="ec-lmr-5">24</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">return</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">count_match</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">Signatures</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">magic</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">!=</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">2;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22027r25"></a></span><span 
class="ec-lmtt-8">}</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22028r26"></a><span 
class="ec-lmr-5">26</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22029r27"></a></span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">This</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">is</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">the</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">bytecode</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">function</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">that</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">is</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">actually</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">executed</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">when</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">the</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">logical</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22030r28"></a><span 
class="ec-lmr-5">28</span></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">signature</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">matched</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22031r29"></a></span><span 
class="ec-lmtt-8">int</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">entrypoint</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">void</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22032r30"></a><span 
class="ec-lmr-5">30</span></span><span 
class="ec-lmtt-8">{</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22033r31"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">call</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">this</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">function</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">to</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">set</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">the</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">suffix</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">of</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">the</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">virus</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">found</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22034r32"></a><span 
class="ec-lmr-5">32</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">foundVirus</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">A</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22035r33"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">success</span><span 
class="ec-lmr-8">,</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">return</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">0</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22036r34"></a><span 
class="ec-lmr-5">34</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">return</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-22037r35"></a></span><span 
class="ec-lmtt-8">}</span>
</div>
<br /> <div class="caption" 
><span class="id">Program 4: </span><span  
class="content">Single subsignature example</span></div><!--tex4ht:label?: x1-22038r4 -->
                                                                                

                                                                                
   </div><hr class="endfloat" />
<!--l. 146--><p class="indent" >   The logical signature (created by the compiler) looks like this: <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">Trojan.Foo.{A};Target:2;0;aabb</span></span></span>
<!--l. 149--><p class="indent" >   Of course you should use a <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">.ldb</span></span></span> signature in this case when all the processing in <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">entrypoint</span></span></span> is
only setting a virusname and returning. However, you can do more complex checks in <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">entrypoint</span></span></span>, once
the bytecode was triggered by the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">logical_trigger</span></span></span>
<!--l. 153--><p class="indent" >   In the example in Program&#x00A0;<a 
href="#x1-22038r4">4<!--tex4ht:ref: prg:singlesig --></a> the pattern was used without an anchor; such a pattern matches at
any offset. You can use offsets though, the same way as in <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">.ndb</span></span></span> signatures, see Program&#x00A0;<a 
href="#x1-23053r5">5<!--tex4ht:ref: prg:multisig --></a> for an
example.
<a 
 id="x1-22039r25"></a>
<h4 class="subsectionHead"><span class="titlemark">2.2.5. </span> <a 
 id="x1-230005"></a>Multiple subsignatures</h4>
<!--l. 157--><p class="noindent" >An example for this is shown in Program&#x00A0;<a 
href="#x1-23053r5">5<!--tex4ht:ref: prg:multisig --></a>. Here you see the following new features used:
<span class="footnote-mark"><a 
href="clambc-user6.html#fn2x2"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-23001f1"></a><span class="footnote-mark"><a 
 id="fn2x2">   <sup class="textsuperscript">1</sup></a></span><span 
class="ec-lmr-8">In case of a duplicate virusname the prefix is appended a unique number by the SI</span>
     <ul class="itemize1">
     <li class="itemize">Multiple virusnames returned from a single bytecode (with common prefix)
     </li>
     <li class="itemize">Multiple subsignatures, each with a name of your choice
     </li>
     <li class="itemize">A pattern with an anchor (<span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">EP+0:aabb</span></span></span>)
     </li>
     <li class="itemize">More subsignatures defined than used in the logical expression</li></ul>
<!--l. 168--><p class="indent" >   The logical signature looks like this:
<!--l. 170--><p class="noindent" ><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-8">Trojan.Foo.{A,B};Target:2;(((0|1|2)=42,2)|(3=10));EP+0:aabb;ffff;aaccee;f00d;dead</span></span></span>
<!--l. 175--><p class="indent" >   Notice how the subsignature that is not used in the logical expression (number 4, <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">dead</span></span></span>) is
used in <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">entrypoint</span></span></span> to decide the virus name. This works because ClamAV does collect the
match counts for all subsignatures (regardless if they are used or not in a signature). The
<span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">count_match(Signatures.check2)</span></span></span> call is thus a simple memory read of the count already determined
by ClamAV.
<!--l. 180--><p class="indent" >   Also notice that comments can be used freely: they are ignored by the compiler. You can use either
C-style multiline comments (start comment with <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">/*</span></span></span>, end with <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">*/</span></span></span>), or C++-style single-line comments
(start comment with <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">//</span></span></span>, automatically ended by newline).
                                                                                

                                                                                
<!--l. 185--><p class="indent" >   <a 
 id="x1-23053r5"></a><hr class="float"><div class="float" 
>
                                                                                

                                                                                
<!--l. 185--><div class="lstinputlisting">
<a 
 id="x1-23002"></a>
<span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23003r1"></a><span 
class="ec-lmr-5">1</span></span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">You</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">are</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">only</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">allowed</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">to</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">set</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">these</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">virusnames</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">as</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">found</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23004r2"></a></span><span 
class="ec-lmtt-8">VIRUSNAME_PREFIX</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">Test</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23005r3"></a><span 
class="ec-lmr-5">3</span></span><span 
class="ec-lmtt-8">VIRUSNAMES</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">A</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">B</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23006r4"></a></span><span 
class="ec-lmtt-8">TARGET</span><span 
class="ec-lmtt-8">(1)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23007r5"></a><span 
class="ec-lmr-5">5</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23008r6"></a></span><span 
class="ec-lmtt-8">SIGNATURES_DECL_BEGIN</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23009r7"></a><span 
class="ec-lmr-5">7</span></span><span 
class="ec-lmtt-8">DECLARE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">magic</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23010r8"></a></span><span 
class="ec-lmtt-8">DECLARE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">zero</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23011r9"></a><span 
class="ec-lmr-5">9</span></span><span 
class="ec-lmtt-8">DECLARE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">check</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23012r10"></a></span><span 
class="ec-lmtt-8">DECLARE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">fivetoten</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23013r11"></a><span 
class="ec-lmr-5">11</span></span><span 
class="ec-lmtt-8">DECLARE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">check2</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23014r12"></a></span><span 
class="ec-lmtt-8">SIGNATURES_DECL_END</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23015r13"></a><span 
class="ec-lmr-5">13</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23016r14"></a></span><span 
class="ec-lmtt-8">SIGNATURES_DEF_BEGIN</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23017r15"></a><span 
class="ec-lmr-5">15</span></span><span 
class="ec-lmtt-8">DEFINE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">magic</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">EP</span><span 
class="ec-lmtt-8">+0:</span><span 
class="ec-lmtt-8">aabb</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23018r16"></a></span><span 
class="ec-lmtt-8">DEFINE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">zero</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">ffff</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23019r17"></a><span 
class="ec-lmr-5">17</span></span><span 
class="ec-lmtt-8">DEFINE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">fivetoten</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">aaccee</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23020r18"></a></span><span 
class="ec-lmtt-8">DEFINE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">check</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">f00d</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23021r19"></a><span 
class="ec-lmr-5">19</span></span><span 
class="ec-lmtt-8">DEFINE_SIGNATURE</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">check2</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">dead</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23022r20"></a></span><span 
class="ec-lmtt-8">SIGNATURES_END</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23023r21"></a><span 
class="ec-lmr-5">21</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23024r22"></a></span><span 
class="ec-lmtt-8">bool</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">logical_trigger</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">void</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23025r23"></a><span 
class="ec-lmr-5">23</span></span><span 
class="ec-lmtt-8">{</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23026r24"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">unsigned</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">sum_matches</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">=</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">count_match</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">Signatures</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">magic</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">+</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23027r25"></a><span 
class="ec-lmr-5">25</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">count_match</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">Signatures</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">zero</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">+</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">count_match</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">Signatures</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">fivetoten</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23028r26"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">unsigned</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">unique_matches</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">=</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">matches</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">Signatures</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">magic</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">+</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23029r27"></a><span 
class="ec-lmr-5">27</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">matches</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">Signatures</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">zero</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">+</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">matches</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">Signatures</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">fivetoten</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23030r28"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">if</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">sum_matches</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">==</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">42</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&amp;&amp;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">unique_matches</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">==</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">2)</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">{</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23031r29"></a><span 
class="ec-lmr-5">29</span></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">//</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">The</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">above</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">3</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">signatures</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">have</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">matched</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">a</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">total</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">of</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">42</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">times</span><span 
class="ec-lmr-8">,</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">and</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">at</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">least</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23032r30"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">//</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">2</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">of</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">them</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">have</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">matched</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23033r31"></a><span 
class="ec-lmr-5">31</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">return</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">true</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23034r32"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">}</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23035r33"></a><span 
class="ec-lmr-5">33</span></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">//</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">If</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">the</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">check</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">signature</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">matches</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">10</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">times</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">we</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">still</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">have</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">a</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">match</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23036r34"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">if</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">count_match</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">Signatures</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">check</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">==</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">10)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23037r35"></a><span 
class="ec-lmr-5">35</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">return</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">true</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23038r36"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">//</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">No</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">match</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23039r37"></a><span 
class="ec-lmr-5">37</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">return</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">false</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23040r38"></a></span><span 
class="ec-lmtt-8">}</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23041r39"></a><span 
class="ec-lmr-5">39</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23042r40"></a></span><span 
class="ec-lmtt-8">int</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">entrypoint</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">void</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23043r41"></a><span 
class="ec-lmr-5">41</span></span><span 
class="ec-lmtt-8">{</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23044r42"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">unsigned</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">count</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">=</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">count_match</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">Signatures</span><span 
class="ec-lmtt-8">.</span><span 
class="ec-lmtt-8">check2</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23045r43"></a><span 
class="ec-lmr-5">43</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">if</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">count</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x003E;=</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">2)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23046r44"></a></span><span 
class="ec-lmr-8">//</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">foundVirus</span><span 
class="ec-lmr-8">(</span><span 
class="ec-lmr-8">count</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">==</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">2</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">?</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">"</span><span 
class="ec-lmr-8">A</span><span 
class="ec-lmr-8">"</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">:</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">"</span><span 
class="ec-lmr-8">B</span><span 
class="ec-lmr-8">")</span><span 
class="ec-lmr-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23047r45"></a><span 
class="ec-lmr-5">45</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">if</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">count</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">==</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">2)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23048r46"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">foundVirus</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">A</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23049r47"></a><span 
class="ec-lmr-5">47</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">else</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23050r48"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">foundVirus</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">B</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23051r49"></a><span 
class="ec-lmr-5">49</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">return</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-23052r50"></a></span><span 
class="ec-lmtt-8">}</span>
</div>
<br /> <div class="caption" 
><span class="id">Program 5: </span><span  
class="content">Multiple subsignatures</span></div><!--tex4ht:label?: x1-23053r5 -->
                                                                                

                                                                                
   </div><hr class="endfloat" />
<a 
 id="x1-23054r28"></a>
<h4 class="subsectionHead"><span class="titlemark">2.2.6. </span> <a 
 id="x1-240006"></a>W32.Polipos.A detector rewritten as bytecode</h4>
<a 
 id="x1-24001r31"></a>
<h4 class="subsectionHead"><span class="titlemark">2.2.7. </span> <a 
 id="x1-250007"></a>Virut detector in bytecode</h4>
<a 
 id="x1-25001r18"></a>
<h3 class="sectionHead"><span class="titlemark">2.3. </span> <a 
 id="x1-260003"></a>Writing regular expressions in bytecode</h3>
<!--l. 193--><p class="noindent" >ClamAV only supports a limited set of regular expressions in <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">.ndb</span><span 
class="ec-lmtt-10">&#x00A0;format</span></span></span> : wildcards. The bytecode
compiler allows you to compile fully generic regular expressions to bytecode directly. When libclamav
loads the bytecode, it will compile to native code (if using the JIT), so it should offer quite good
performance.
<!--l. 197--><p class="indent" >   The compiler currently uses <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">re2c</span></span></span> to compile regular expressions to C code, and then compile that
to bytecode. The internal workings are all transparent to the user: the compiler automatically uses
<span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">re2c</span></span></span> when needed, and <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">re2c</span></span></span> is embedded in the compiler, so you don&#8217;t need to install
it.
<!--l. 201--><p class="indent" >   The syntax of regular expressions are similar to the one used by <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">POSIX</span><span 
class="ec-lmtt-10">&#x00A0;regular</span><span 
class="ec-lmtt-10">&#x00A0;expressions</span></span></span>,
except you have to quote literals, since unquoted they are interpreted as regular expression
names.
<a 
 id="x1-26001r32"></a>
<h4 class="subsectionHead"><span class="titlemark">2.3.1. </span> <a 
 id="x1-270001"></a>A very simple regular expression</h4>
<!--l. 206--><p class="noindent" >Lets start with a simple example, to match this POSIX regular expression:
<span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">eval([a-zA-Z_][a-zA-Z0-9_]*\.unescape</span></span></span>.
<!--l. 209--><p class="indent" >   See Program&#x00A0;<a 
href="#x1-27027r6">6<!--tex4ht:ref: prg:reg1 --></a> <span class="footnote-mark"><a 
href="clambc-user6.html#fn2x2"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-27001f1"></a><span class="footnote-mark"><a 
 id="fn2x2">    <sup class="textsuperscript">1</sup></a></span><span 
class="ec-lmr-8">This omits the virusname, and logical signature declarations</span> .
                                                                                

                                                                                
<!--l. 211--><p class="indent" >   <a 
 id="x1-27027r6"></a><hr class="float"><div class="float" 
>
                                                                                

                                                                                
<!--l. 211--><div class="lstinputlisting">
<a 
 id="x1-27002"></a>
<span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27003r1"></a></span><span 
class="ec-lmtt-8">int</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">entrypoint</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">void</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27004r2"></a><span 
class="ec-lmr-5">2</span></span><span 
class="ec-lmtt-8">{</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27005r3"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">REGEX_SCANNER</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27006r4"></a><span 
class="ec-lmr-5">4</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">seek</span><span 
class="ec-lmtt-8">(0,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">SEEK_SET</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27007r5"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">for</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">(;;)</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">{</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27008r6"></a><span 
class="ec-lmr-5">6</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">REGEX_LOOP_BEGIN</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27009r7"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27010r8"></a><span 
class="ec-lmr-5">8</span></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">!</span><span 
class="ec-lmr-8">re2c</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27011r9"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">ANY</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">=</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">[^];</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27012r10"></a><span 
class="ec-lmr-5">10</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27013r11"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">"</span><span 
class="ec-lmr-8">eval</span><span 
class="ec-lmr-8">("[</span><span 
class="ec-lmr-8">a</span><span 
class="lmsy8-">&minus;</span><span 
class="ec-lmr-8">zA</span><span 
class="lmsy8-">&minus;</span><span 
class="ec-lmr-8">Z_</span><span 
class="ec-lmr-8">][</span><span 
class="ec-lmr-8">a</span><span 
class="lmsy8-">&minus;</span><span 
class="ec-lmr-8">zA</span><span 
class="lmsy8-">&minus;</span><span 
class="ec-lmr-8">Z_0</span><span 
class="lmsy8-">&minus;</span><span 
class="ec-lmr-8">9]</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">".</span><span 
class="ec-lmr-8">unescape</span><span 
class="ec-lmr-8">"</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">{</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27014r12"></a><span 
class="ec-lmr-5">12</span></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">long</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">pos</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">=</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">REGEX_POS</span><span 
class="ec-lmr-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27015r13"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">if</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">(</span><span 
class="ec-lmr-8">pos</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x003C;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">0)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27016r14"></a><span 
class="ec-lmr-5">14</span></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">continue</span><span 
class="ec-lmr-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27017r15"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">debug</span><span 
class="ec-lmr-8">("</span><span 
class="ec-lmr-8">unescape</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">found</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">at</span><span 
class="ec-lmr-8">:")</span><span 
class="ec-lmr-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27018r16"></a><span 
class="ec-lmr-5">16</span></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">debug</span><span 
class="ec-lmr-8">(</span><span 
class="ec-lmr-8">pos</span><span 
class="ec-lmr-8">)</span><span 
class="ec-lmr-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27019r17"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">}</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27020r18"></a><span 
class="ec-lmr-5">18</span></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">ANY</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">{</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">continue</span><span 
class="ec-lmr-8">;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">}</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27021r19"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27022r20"></a><span 
class="ec-lmr-5">20</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">}</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27023r21"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">return</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-27024r22"></a><span 
class="ec-lmr-5">22</span></span><span 
class="ec-lmtt-8">}</span>
</div>
<br /> <div class="caption" 
><span class="id">Program 6: </span><span  
class="content">Simple regular expression example</span></div><!--tex4ht:label?: x1-27027r6 -->
                                                                                

                                                                                
   </div><hr class="endfloat" />
<!--l. 216--><p class="indent" >   There are several new features introduced here, here is a step by step breakdown:
     <dl class="description"><dt class="description">
 </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">REGEX_SCANNER</span></span></span> this declares the data structures needed by the regular expression matcher
     </dd><dt class="description">
 </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">seek(0,</span><span 
class="ec-lmtt-10">&#x00A0;SEEK_SET)</span></span></span> this sets the current file offset to position <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">0</span></span></span>, matching will start at this
     position. For offset 0 it is not strictly necessary to do this, but it serves as a reminder that
     you might want to start matching somewhere, that is not necessarily 0.
     </dd><dt class="description">
 </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">&#x00A0;for(;;)</span><span 
class="ec-lmtt-10">&#x00A0;{</span><span 
class="ec-lmtt-10">&#x00A0;REGEX_LOOP_BEGIN</span></span></span> this creates the regular expression matcher main loop. It takes
     the current file byte-by-byte <span class="footnote-mark"><a 
href="clambc-user6.html#fn2x2"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-27028f1"></a><span class="footnote-mark"><a 
 id="fn2x2">    <sup class="textsuperscript">1</sup></a></span><span 
class="ec-lmr-8">it is not really reading byte-by-byte, it is using a buffer to speed things up</span> 
     and tries to match one of the regular expressions.
     </dd><dt class="description">
 </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">/*!re2c</span></span></span> This mark the beginning of the regular expression description. The entire regular
     expression block is a C comment, starting with <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">!re2c</span></span></span>
     </dd><dt class="description">
 </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">ANY</span><span 
class="ec-lmtt-10">&#x00A0;=</span><span 
class="ec-lmtt-10">&#x00A0;[^];</span></span></span> This declares a regular expression named <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">ANY</span></span></span> that matches any byte.
     </dd><dt class="description">
 </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">"eval("[a-zA-Z_][a-zA-Z_0-9]*".unescape"</span><span 
class="ec-lmtt-10">&#x00A0;{</span></span></span> This is the actual regular expression.
         <dl class="description"><dt class="description">
      </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">"eval("</span></span></span> This matches the literal string <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">eval(</span></span></span>. Literals have to be placed in double quotes
         <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">"</span></span></span> here, unlike in POSIX regular expressions or PCRE. If you want case-insensitive
         matching, you can use <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">&#8217;</span></span></span>.
         </dd><dt class="description">
      </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">[a-zA-Z_]</span></span></span> This is a character class, it matches any lowercase, uppercase or <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">_</span></span></span> characters.
         </dd><dt class="description">
      </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">[a-zA-Z_0-9]*"</span></span></span> Same as before, but with repetition. <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">*</span></span></span> means match zero or more times,
         <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">+</span></span></span> means match one or more times, just like in POSIX regular expressions.
         </dd><dt class="description">
      </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">".unescape"</span></span></span> A literal string again
         </dd><dt class="description">
      </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">{</span></span></span> start of the <span 
class="ec-lmri-10">action </span>block for this regular expression. Whenever the regular expression
         matches, the attached C code is executed.</dd></dl>
     </dd><dt class="description">
 </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">long</span><span 
class="ec-lmtt-10">&#x00A0;pos</span><span 
class="ec-lmtt-10">&#x00A0;=</span><span 
class="ec-lmtt-10">&#x00A0;REGEX_POS;</span></span></span> this determines the absolute file offset where the regular expression has
     matched. Note that because the regular expression matcher uses a buffer, using just
     <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">seek(0,</span><span 
class="ec-lmtt-10">&#x00A0;SEEK_CUR)</span></span></span> would give the current position of the end of that buffer, and not the current
     position during regular expression matching. You have to use the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">REGEX_POS</span></span></span> macro to get the
     correct position.
     </dd><dt class="description">
 </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">debug(...)</span></span></span> Shows a debug message about what was found and where. This is extremely helpful when
     you start writing regular expressions, and nothing works: you can determine whether your regular
                                                                                

                                                                                
     expression matched at all, and if it matched where you thought it would. There is also
     a <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">DEBUG_PRINT_MATCH</span></span></span> that prints the entire matched string to the debug output.
     Of course before publishing the bytecode you might want to turn off these debug
     messages.
     </dd><dt class="description">
 </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">}</span></span></span> closes the <span 
class="ec-lmri-10">action </span>block for this regular expression
     </dd><dt class="description">
 </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">ANY</span><span 
class="ec-lmtt-10">&#x00A0;{</span><span 
class="ec-lmtt-10">&#x00A0;continue;</span><span 
class="ec-lmtt-10">&#x00A0;}</span></span></span> If none of the regular expressions matched so far, just keep running the matcher,
     at the next byte
     </dd><dt class="description">
 </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">*/</span></span></span> closes the regular expression description block
     </dd><dt class="description">
 </dt><dd 
class="description"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">}</span></span></span> closes the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">for()</span></span></span> loop</dd></dl>
<!--l. 249--><p class="indent" >   You may have multiple regular expressions, or declare multiple regular expressions with a name,
and use those names to build more complex regular expressions.
<a 
 id="x1-27029r34"></a>
<h4 class="subsectionHead"><span class="titlemark">2.3.2. </span> <a 
 id="x1-280002"></a>Named regular expressions</h4>
<a 
 id="x1-28001r33"></a>
<h3 class="sectionHead"><span class="titlemark">2.4. </span> <a 
 id="x1-290004"></a>Writing unpackers</h3>
<a 
 id="x1-29001r37"></a>
<h4 class="subsectionHead"><span class="titlemark">2.4.1. </span> <a 
 id="x1-300001"></a>Structure of a bytecode for unpacking (and other hooks)</h4>
<!--l. 258--><p class="noindent" >When writing an unpacker, the bytecode should consist of:
     <ul class="itemize1">
     <li class="itemize">Define which hook you use (for example <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">PE_UNPACKER_DECLARE</span></span></span> for a PE hook)
     </li>
     <li class="itemize">An <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">int</span><span 
class="ec-lmtt-10">&#x00A0;entrypoint(void)</span></span></span> function that reads the current file and unpacks it to a new
     file
     </li>
     <li class="itemize">Return 0 from <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">entrypoint</span></span></span> if you want the unpacked file to be scanned
     </li>
     <li class="itemize">(Optional) Other functions and global constants used by <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">entrypoint</span></span></span></li></ul>
<a 
 id="x1-30001r39"></a>
<h4 class="subsectionHead"><span class="titlemark">2.4.2. </span> <a 
 id="x1-310002"></a>Detecting clam.exe via bytecode</h4>
<!--l. 269--><p class="noindent" >Example provided by aCaB:
<a 
 id="x1-31001r40"></a>
<h4 class="subsectionHead"><span class="titlemark">2.4.3. </span> <a 
 id="x1-320003"></a>Detecting clam.exe via bytecode (disasm)</h4>
<!--l. 271--><p class="noindent" >Example provided by aCaB:
<a 
 id="x1-32001r41"></a>
<h4 class="subsectionHead"><span class="titlemark">2.4.4. </span> <a 
 id="x1-330004"></a>A simple unpacker</h4>
<a 
 id="x1-33001r42"></a>
                                                                                

                                                                                
<h4 class="subsectionHead"><span class="titlemark">2.4.5. </span> <a 
 id="x1-340005"></a>Matching PDF javascript</h4>
<a 
 id="x1-34001r43"></a>
<h4 class="subsectionHead"><span class="titlemark">2.4.6. </span> <a 
 id="x1-350006"></a>YC unpacker rewritten as bytecode</h4>
                                                                                

                                                                                
                                                                                

                                                                                
                                                                                

                                                                                
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;3</span><br /><a 
 id="x1-360003"></a>Usage</h2>
<a 
 id="x1-36001r38"></a>
<h3 class="sectionHead"><span class="titlemark">3.1. </span> <a 
 id="x1-370001"></a>Invoking the compiler</h3>
<!--l. 4--><p class="noindent" >Compiling is similar to gcc <span class="footnote-mark"><a 
href="clambc-user7.html#fn1x3"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-37001f1"></a> :
                                                                                

                                                                                
   <div class="verbatim" id="verbatim-8">
$&#x00A0;/usr/local/clamav/bin/clambc-compiler&#x00A0;foo.c&#x00A0;-o&#x00A0;foo.cbc&#x00A0;-O2
</div>
<!--l. 7--><p class="nopar" >
<!--l. 9--><p class="indent" >   This will compile the file <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">foo.c</span></span></span> into a file called <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">foo.cbc</span></span></span>, that can be loaded by ClamAV, and
packed inside a <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">.cvd</span></span></span> file.
<!--l. 12--><p class="indent" >   The compiler by default has all warnings turned on.
<!--l. 14--><p class="indent" >   Supported optimization levels: <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">-O0,</span><span 
class="ec-lmtt-10">&#x00A0;-O1,</span><span 
class="ec-lmtt-10">&#x00A0;-O2,</span><span 
class="ec-lmtt-10">&#x00A0;-O3</span></span></span>.
<span class="footnote-mark"><a 
href="clambc-user8.html#fn2x3"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-37002f1"></a> It is
recommended that you always compile with at least <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">-O1</span></span></span>.
<!--l. 17--><p class="indent" >   Warning options: <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">-Werror</span></span></span> (transforms all warnings into errors).
<!--l. 19--><p class="indent" >   Preprocessor flags:
     <dl class="description"><dt class="description">
<span 
class="ec-lmbx-10">-I &#x003C;directory&#x003E;</span> </dt><dd 
class="description">Searches in the given directory when it encounters a <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">#include</span><span 
class="ec-lmtt-10">&#x00A0;"headerfile"</span></span></span>
     directive in the source code, in addition to the system defined header search directories.
     </dd><dt class="description">
<span 
class="ec-lmbx-10">-D &#x003C;MACRONAME&#x003E;=&#x003C;VALUE&#x003E;</span> </dt><dd 
class="description">Predefine given <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">&#x003C;MACRONAME&#x003E;</span></span></span> to be equal to <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">&#x003C;VALUE&#x003E;</span></span></span>.
     </dd><dt class="description">
<span 
class="ec-lmbx-10">-U &#x003C;MACRONAME&#x003E;</span> </dt><dd 
class="description">Undefine a predefined macro</dd></dl>
<!--l. 27--><p class="indent" >   The compiler also supports some other commandline options (see <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">clambc-compiler</span><span 
class="ec-lmtt-10">&#x00A0;--help</span></span></span> for a
full list), however some of them have no effect when using the ClamAV bytecode backend
(such as the X86 backend options). You shouldn&#8217;t need to use any flags not documented
above.
<a 
 id="x1-37003r44"></a>
<h4 class="subsectionHead"><span class="titlemark">3.1.1. </span> <a 
 id="x1-380001"></a>Compiling C++ files</h4>
<!--l. 32--><p class="noindent" >Filenames with a <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">.cpp</span></span></span> extension are compiled as C++ files, however <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">clang++</span></span></span> is not yet
ready for production use, so this is EXPERIMENTAL currently. For now write bytecodes in
C.
<a 
 id="x1-38001r46"></a>
<h3 class="sectionHead"><span class="titlemark">3.2. </span> <a 
 id="x1-390002"></a>Running compiled bytecode</h3>
<!--l. 37--><p class="noindent" >After compiling a C source file to bytecode, you can load it in ClamAV:
<a 
 id="x1-39001r47"></a>
<h4 class="subsectionHead"><span class="titlemark">3.2.1. </span> <a 
 id="x1-400001"></a>ClamBC</h4>
<!--l. 39--><p class="noindent" >ClamBC is a tool you can use to test whether the bytecode loads, compiles, and can execute its
entrypoint successfully. Usage:
                                                                                

                                                                                
   <div class="verbatim" id="verbatim-9">
&#x00A0;clambc&#x00A0;&#x003C;file&#x003E;&#x00A0;[function]&#x00A0;[param1&#x00A0;...]
</div>
<!--l. 43--><p class="nopar" >
<!--l. 45--><p class="indent" >   For example loading a simple bytecode with 2 functions is done like this:
                                                                                

                                                                                
   <div class="verbatim" id="verbatim-10">
$&#x00A0;clambc&#x00A0;foo.cbc
&#x00A0;<br />LibClamAV&#x00A0;debug:&#x00A0;searching&#x00A0;for&#x00A0;unrar,&#x00A0;user-searchpath:&#x00A0;/usr/local/lib
&#x00A0;<br />LibClamAV&#x00A0;debug:&#x00A0;unrar&#x00A0;support&#x00A0;loaded&#x00A0;from&#x00A0;libclamunrar_iface.so.6.0.4&#x00A0;libclamunrar_iface_so_6_0
&#x00A0;<br />LibClamAV&#x00A0;debug:&#x00A0;bytecode:&#x00A0;Parsed&#x00A0;0&#x00A0;APIcalls,&#x00A0;maxapi&#x00A0;0
&#x00A0;<br />LibClamAV&#x00A0;debug:&#x00A0;Parsed&#x00A0;1&#x00A0;BBs,&#x00A0;2&#x00A0;instructions
&#x00A0;<br />LibClamAV&#x00A0;debug:&#x00A0;Parsed&#x00A0;1&#x00A0;BBs,&#x00A0;2&#x00A0;instructions
&#x00A0;<br />LibClamAV&#x00A0;debug:&#x00A0;Parsed&#x00A0;2&#x00A0;functions
&#x00A0;<br />Bytecode&#x00A0;loaded
&#x00A0;<br />Running&#x00A0;bytecode&#x00A0;function&#x00A0;:0
&#x00A0;<br />Bytecode&#x00A0;run&#x00A0;finished
&#x00A0;<br />Bytecode&#x00A0;returned:&#x00A0;0x8
&#x00A0;<br />Exiting
</div>
<!--l. 59--><p class="nopar" >
<a 
 id="x1-40001r49"></a>
<h4 class="subsectionHead"><span class="titlemark">3.2.2. </span> <a 
 id="x1-410002"></a>clamscan, clamd</h4>
<!--l. 62--><p class="noindent" >You can tell clamscan to load the bytecode as a database directly:
                                                                                

                                                                                
   <div class="verbatim" id="verbatim-11">
$&#x00A0;clamscan&#x00A0;-dfoo.cbc
</div>
<!--l. 65--><p class="nopar" >Or you can instruct it to load all databases from a directory, then clamscan will load all supported
formats, including files with bytecode, which have the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">.cbc</span></span></span> extension.
                                                                                

                                                                                
   <div class="verbatim" id="verbatim-12">
$&#x00A0;clamscan&#x00A0;-ddirectory
</div>
<!--l. 70--><p class="nopar" >
<!--l. 73--><p class="indent" >   You can also put the bytecode files into the default database directory of ClamAV (usually
<span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">/usr/local/share/clamav</span></span></span>) to have it loaded automatically from there. Of course, the bytecode can be
stored inside CVD files, too.
<a 
 id="x1-41001r48"></a>
<h3 class="sectionHead"><span class="titlemark">3.3. </span> <a 
 id="x1-420003"></a>Debugging bytecode</h3>
<a 
 id="x1-42001r50"></a>
<h4 class="subsectionHead"><span class="titlemark">3.3.1. </span> <a 
 id="x1-430001"></a>&#8220;printf&#8221; style debugging</h4>
<!--l. 79--><p class="noindent" >Printf, and printf-like format specifiers are not supported in the bytecode. You can use these functions
instead of printf to print strings and integer to clamscan&#8217;s &#8211;debug output:
<!--l. 83--><p class="indent" >   <a 
href="#bytecode__api_8h_aa6d82179ea15d32450fefbc6d1bd8934">debug_print_str</a>, <a 
href="#bytecode__api_8h_a6e0cdd4d4c76ed46a8627bee56eee1c1">debug_print_uint</a>, <a 
href="#bytecode__api_8h_a43707290a22915315c960422a88ba4d4">debug_print_str_start</a>, <a 
href="#bytecode__api_8h_a02f173e084fc9a4b9eaf3017aa4243ba">debug_print_str_nonl</a>.
<!--l. 88--><p class="indent" >   You can also use the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">debug</span></span></span> convenience wrapper that automatically prints as string or integer
depending on parameter type: <a 
href="#bytecode__local_8h_aa6f11e14ec5677b64c7f623a08a81ceb">debug</a>, <a 
href="#bytecode__local_8h_a7393b44e1359ec29419ccee63a730716">debug</a>, <a 
href="#bytecode__local_8h_a86350ab4540ed8cc1607409355a1b04c">debug</a>.
<!--l. 94--><p class="indent" >   See Program&#x00A0;<a 
href="#x1-43031r7">7<!--tex4ht:ref: prg:debugapi --></a> for an example.
                                                                                

                                                                                
<!--l. 96--><p class="indent" >   <a 
 id="x1-43031r7"></a><hr class="float"><div class="float" 
>
                                                                                

                                                                                
<!--l. 96--><div class="lstinputlisting">
<a 
 id="x1-43001"></a>
<span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43002r1"></a><span 
class="ec-lmr-5">1</span></span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">test</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">debug</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">APIs</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43003r2"></a></span><span 
class="ec-lmtt-8">int</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">entrypoint</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">void</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43004r3"></a><span 
class="ec-lmr-5">3</span></span><span 
class="ec-lmtt-8">{</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43005r4"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">print</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">a</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">debug</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">message</span><span 
class="ec-lmr-8">,</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">followed</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">by</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">newline</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43006r5"></a><span 
class="ec-lmr-5">5</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">debug_print_str</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">bytecode</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">started</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">16)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43007r6"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43008r7"></a><span 
class="ec-lmr-5">7</span></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">start</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">a</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">new</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">debug</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">message</span><span 
class="ec-lmr-8">,</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">don</span><span 
class="ec-lmr-8">&#8217;</span><span 
class="ec-lmr-8">t</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">end</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">with</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">newline</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">yet</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43009r8"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">debug_print_str_start</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">Engine</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">functionality</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">level</span><span 
class="ec-lmtt-8">:</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">28)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43010r9"></a><span 
class="ec-lmr-5">9</span></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">print</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">an</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">integer</span><span 
class="ec-lmr-8">,</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">no</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">newline</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43011r10"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">debug_print_uint</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">engine_functionality_level</span><span 
class="ec-lmtt-8">()</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43012r11"></a><span 
class="ec-lmr-5">11</span></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">print</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">a</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">string</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">without</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">starting</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">a</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">new</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">debug</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">message</span><span 
class="ec-lmr-8">,</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">and</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">without</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43013r12"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">terminating</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">with</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">newline</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43014r13"></a><span 
class="ec-lmr-5">13</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">debug_print_str_nonl</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">dconf</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">functionality</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">level</span><span 
class="ec-lmtt-8">:</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">28)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43015r14"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">debug_print_uint</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">engine_dconf_level</span><span 
class="ec-lmtt-8">()</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43016r15"></a><span 
class="ec-lmr-5">15</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">debug_print_str_nonl</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">\</span><span 
class="ec-lmtt-8">n</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">1)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43017r16"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">debug_print_str_start</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">Engine</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">scan</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">options</span><span 
class="ec-lmtt-8">:</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">21)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43018r17"></a><span 
class="ec-lmr-5">17</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">debug_print_uint</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">engine_scan_options</span><span 
class="ec-lmtt-8">()</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43019r18"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">debug_print_str_nonl</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">db</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">options</span><span 
class="ec-lmtt-8">:</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">13)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43020r19"></a><span 
class="ec-lmr-5">19</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">debug_print_uint</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">engine_db_options</span><span 
class="ec-lmtt-8">()</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43021r20"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">debug_print_str_nonl</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">\</span><span 
class="ec-lmtt-8">n</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">,</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">1)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43022r21"></a><span 
class="ec-lmr-5">21</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43023r22"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">convenience</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">wrapper</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">to</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">just</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">print</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">a</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">string</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43024r23"></a><span 
class="ec-lmr-5">23</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">debug</span><span 
class="ec-lmtt-8">(</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">just</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">print</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">a</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">string</span><span 
class="ec-lmtt-8">"</span><span 
class="ec-lmtt-8">)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43025r24"></a></span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">/</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">convenience</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">wrapper</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">to</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">just</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">print</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">an</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ec-lmr-8">integer</span><span 
class="ec-lmr-8">&#x00A0;</span><span 
class="ts1-lmr8-">&lowast;</span><span 
class="ec-lmr-8">/</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43026r25"></a><span 
class="ec-lmr-5">25</span></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">debug</span><span 
class="ec-lmtt-8">(4)</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43027r26"></a></span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">return</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">0</span><span 
class="ec-lmtt-8">xf00d</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-43028r27"></a><span 
class="ec-lmr-5">27</span></span><span 
class="ec-lmtt-8">}</span>
</div>
<br /> <div class="caption" 
><span class="id">Program 7: </span><span  
class="content">Example of using debug APIs</span></div><!--tex4ht:label?: x1-43031r7 -->
                                                                                

                                                                                
   </div><hr class="endfloat" />
<a 
 id="x1-43032r52"></a>
<h4 class="subsectionHead"><span class="titlemark">3.3.2. </span> <a 
 id="x1-440002"></a>Single-stepping</h4>
<!--l. 108--><p class="noindent" >If you have GDB 7.0 (or newer) you can single-step
<span class="footnote-mark"><a 
href="clambc-user8.html#fn2x3"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-44001f1"></a><span class="footnote-mark"><a 
 id="fn2x3">   <sup class="textsuperscript">1</sup></a></span><span 
class="ec-lmr-8">not yet implemented in libclamav</span>
<span class="footnote-mark"><a 
href="clambc-user8.html#fn2x3"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-44002f2"></a><span class="footnote-mark"><a 
 id="fn2x3">   <sup class="textsuperscript">2</sup></a></span><span 
class="ec-lmr-8">assuming you have JIT support</span>
during the execution of the bytecode.
     <ul class="itemize1">
     <li class="itemize">Run clambc or clamscan under gdb:
                                                                                

                                                                                
     <div class="verbatim" id="verbatim-13">
     $&#x00A0;./libtool&#x00A0;--mode=execute&#x00A0;gdb&#x00A0;clamscan/clamscan
     &#x00A0;<br />...
     &#x00A0;<br />(gdb)&#x00A0;b&#x00A0;cli_vm_execute_jit
     &#x00A0;<br />Are&#x00A0;you&#x00A0;sure&#x00A0;....?&#x00A0;y
     &#x00A0;<br />(gdb)&#x00A0;run&#x00A0;-dfoo.cbc
     &#x00A0;<br />...
     &#x00A0;<br />Breakpoint&#x00A0;....
     &#x00A0;<br />
     &#x00A0;<br />(gdb)&#x00A0;step
     &#x00A0;<br />(gdb)&#x00A0;next
</div>
     <!--l. 123--><p class="nopar" >
     <!--l. 125--><p class="noindent" >You can single-step through the execution of the bytecode, however you can&#8217;t (yet) print values of
     individual variables, you&#8217;ll need to add debug statements in the bytecode to print interesting
     values.
     </li></ul>
                                                                                

                                                                                
                                                                                

                                                                                
                                                                                

                                                                                
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;4</span><br /><a 
 id="x1-450004"></a>ClamAV bytecode language</h2> The bytecode that ClamAV loads is a simplified form of the
LLVM Intermediate Representation, and as such it is language-independent.
<!--l. 4--><p class="noindent" >However currently the only supported language from which such bytecode can be generated is a simplified
form of C <span class="footnote-mark"><a 
href="clambc-user9.html#fn1x4"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-45001f1"></a> 
<!--l. 7--><p class="indent" >   The language supported by the ClamAV bytecode compiler is a restricted set of C99 with some
GNU extensions.
<a 
 id="x1-45002r51"></a>
<h3 class="sectionHead"><span class="titlemark">4.1. </span> <a 
 id="x1-460001"></a>Differences from C99 and GNU C</h3>
<!--l. 11--><p class="noindent" >These restrictions are enforced at compile time:
     <ul class="itemize1">
     <li class="itemize">No standard include files. <span class="footnote-mark"><a 
href="clambc-user10.html#fn2x4"><sup class="textsuperscript">2</sup></a></span><a 
 id="x1-46001f2"></a> 
     </li>
     <li class="itemize">The ClamAV API header files are preincluded.
     </li>
     <li class="itemize">No external function calls, except to the ClamAV API <span class="footnote-mark"><a 
href="clambc-user11.html#fn3x4"><sup class="textsuperscript">3</sup></a></span><a 
 id="x1-46002f3"></a> 
     </li>
     <li class="itemize">No inline assembly <span class="footnote-mark"><a 
href="clambc-user12.html#fn4x4"><sup class="textsuperscript">4</sup></a></span><a 
 id="x1-46003f4"></a> 
     </li>
     <li class="itemize">Globals can only be readonly constants <span class="footnote-mark"><a 
href="clambc-user13.html#fn5x4"><sup class="textsuperscript">5</sup></a></span><a 
 id="x1-46004f5"></a> 
     </li>
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">inline</span></span></span> is C99 inline (equivalent to GNU C89 extern inline), thus it cannot be used outside
     of the definition of the ClamAV API, you should use <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">static</span><span 
class="ec-lmtt-10">&#x00A0;inline</span></span></span>
     </li>
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">sizeof(int)</span><span 
class="ec-lmtt-10">&#x00A0;==</span><span 
class="ec-lmtt-10">&#x00A0;4</span></span></span> always
     </li>
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">sizeof(long)</span><span 
class="ec-lmtt-10">&#x00A0;==</span><span 
class="ec-lmtt-10">&#x00A0;sizeof(long</span><span 
class="ec-lmtt-10">&#x00A0;long)</span><span 
class="ec-lmtt-10">&#x00A0;==</span><span 
class="ec-lmtt-10">&#x00A0;8</span></span></span> always
     </li>
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">ptr_diff_t</span><span 
class="ec-lmtt-10">&#x00A0;=</span><span 
class="ec-lmtt-10">&#x00A0;int</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">intptr_t</span><span 
class="ec-lmtt-10">&#x00A0;=</span><span 
class="ec-lmtt-10">&#x00A0;int</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">intmax_t</span><span 
class="ec-lmtt-10">&#x00A0;=</span><span 
class="ec-lmtt-10">&#x00A0;long</span></span></span>, <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">uintmax_t</span><span 
class="ec-lmtt-10">&#x00A0;=</span><span 
class="ec-lmtt-10">&#x00A0;unsigned</span><span 
class="ec-lmtt-10">&#x00A0;long</span></span></span><span class="footnote-mark"><a 
href="clambc-user14.html#fn6x4"><sup class="textsuperscript">6</sup></a></span><a 
 id="x1-46005f6"></a> 
     </li>
     <li class="itemize">No pointer to integer casts and integer to pointer casts (pointer arithmetic is allowed
     though)
                                                                                

                                                                                
     </li>
     <li class="itemize">No <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">__thread</span></span></span> support
     </li>
     <li class="itemize">Size of memory region associated with each pointer must be known in each function, thus
     if you pass a pointer to a function, you must also pass its allocated size as a parameter.
     </li>
     <li class="itemize">Endianness must be handled via the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">__is_bigendian()</span></span></span> API function call, or via the
     <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">cli_{read,write}int{16,32}</span></span></span> wrappers, and not by casting pointers
     </li>
     <li class="itemize">Predefines <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">__CLAMBC__</span></span></span>
     </li>
     <li class="itemize">All integer types have fixed width
     </li>
     <li class="itemize"><span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">main</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">entrypoint</span></span></span> must have the following prototype: <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">int</span><span 
class="ec-lmtt-10">&#x00A0;main(void)</span></span></span>, the prototype
     <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">int</span><span 
class="ec-lmtt-10">&#x00A0;main(int</span><span 
class="ec-lmtt-10">&#x00A0;argc,</span><span 
class="ec-lmtt-10">&#x00A0;char</span><span 
class="ec-lmtt-10">&#x00A0;*argv[])</span></span></span> is not accepted</li></ul>
<!--l. 39--><p class="indent" >   They are meant to ensure the following:
     <ul class="itemize1">
     <li class="itemize">Thread safe execution of multiple different bytecodes, and multiple instances of the same
     bytecode
     </li>
     <li class="itemize">Portability to multiple CPU architectures and OSes: the bytecode must execute on both
     the libclamav/LLVM JIT where that is supported (x86, x86_64, ppc, arm?), and on the
     libclamav interpreter where that is not supported.
     </li>
     <li class="itemize">No external runtime dependency: libclamav should have everything needed to run the
     bytecode, thus no external calls are allowed, not even to libc!
     </li>
     <li class="itemize">Same behaviour on all platforms: fixed size integers.</li></ul>
<!--l. 48--><p class="indent" >   These restrictions are checked at runtime (checks are inserted at compile time):
     <ul class="itemize1">
     <li class="itemize">Accessing an out-of-bounds pointer will result in a call to <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">abort()</span></span></span>
     </li>
     <li class="itemize">Calling <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">abort()</span></span></span> interrupts the execution of the bytecode in a thread safe manner, and
     doesn&#8217;t halt ClamAV <span class="footnote-mark"><a 
href="clambc-user15.html#fn7x4"><sup class="textsuperscript">1</sup></a></span><a 
 id="x1-46006f1"></a> .</li></ul>
<!--l. 55--><p class="indent" >   The ClamAV API header has further restriction, see the Internals manual.
<!--l. 57--><p class="indent" >   Although the bytecode undergoes a series of automated tests (see Publishing chapter in Internals
manual), the above restrictions don&#8217;t guarantee that the resulting bytecode will execute correctly! You
must still test the code yourself, these restrictions only avoid the most common errors.
Although the compiler and verifier aims to accept only code that won&#8217;t crash ClamAV,
no code is 100% perfect, and a bug in the verifier could allow unsafe code be executed by
ClamAV.
                                                                                

                                                                                
<a 
 id="x1-46007r57"></a>
<h3 class="sectionHead"><span class="titlemark">4.2. </span> <a 
 id="x1-470002"></a>Limitations</h3>
<!--l. 64--><p class="noindent" >The bytecode format has the following limitations:
     <ul class="itemize1">
     <li class="itemize">At most 64k bytecode kinds (hooks)
     </li>
     <li class="itemize">At most 64k types (including pointers, and all nested types)
     </li>
     <li class="itemize">At most 16 parameters to functions, no vararg functions
     </li>
     <li class="itemize">At most 64-bit integers
     </li>
     <li class="itemize">No vector types or vector operations
     </li>
     <li class="itemize">No opaque types
     </li>
     <li class="itemize">No floating point
     </li>
     <li class="itemize">Global variable initializer must be compile-time computable
     </li>
     <li class="itemize">At most 32k global variables (and at most 32k API globals)
     </li>
     <li class="itemize">Pointer  indexing  at  most  15  levels  deep  (can  be  worked  around  if  needed  by  using
     temporaries)
     </li>
     <li class="itemize">No struct return or byval parameters
     </li>
     <li class="itemize">At most 32k instructions in a single function
     </li>
     <li class="itemize">No Variable Length Arrays</li></ul>
<a 
 id="x1-47001r58"></a>
<h3 class="sectionHead"><span class="titlemark">4.3. </span> <a 
 id="x1-480003"></a>Logical signatures</h3>
<!--l. 85--><p class="noindent" >Logical signatures can be used as triggers for executing a bytecode. Instead of describing a logical
signatures as a <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">.ldb</span></span></span> pattern, you use C code which is then translated to a <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">.ldb</span></span></span>-style logical
signature.
<!--l. 89--><p class="indent" >   Logical signatures in ClamAV support the following operations:
     <ul class="itemize1">
     <li class="itemize">Sum the count of logical subsignatures that matched inside a subexpression
                                                                                

                                                                                
     </li>
     <li class="itemize">Sum the number of different subsignatures that matched inside a subexpression
     </li>
     <li class="itemize">Compare the above counts using the <span 
class="lmmi-10">&#x003E;,</span><span 
class="rm-lmr-10">=</span><span 
class="lmmi-10">,&#x003C; </span>relation operators
     </li>
     <li class="itemize">Perform logical <span 
class="rm-lmr-10">&amp;&amp;</span><span 
class="lmmi-10">,</span><span 
class="lmsy-10">|| </span>operations on above boolean values
     </li>
     <li class="itemize">Nest subexpressions
     </li>
     <li class="itemize">Maximum 64 subexpressions</li></ul>
<!--l. 99--><p class="indent" >   Out of the above operations the ClamAV Bytecode Compiler doesn&#8217;t support computing sums of
nested subexpressions, (it does support nesting though).
<!--l. 102--><p class="indent" >   The C code that can be converted into a logical signature must obey these restrictions:
     <ul class="itemize1">
     <li class="itemize">a     function     named     <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">logical_trigger</span></span></span>   with     the     following     prototype:
     <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">bool</span><span 
class="ec-lmtt-10">&#x00A0;logical_trigger(void)</span></span></span>
     </li>
     <li class="itemize">no function calls, except for <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">count_match</span></span></span> and <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">matches</span></span></span>
     </li>
     <li class="itemize">no global variable access (except as done by the above 2 functions internally)
     </li>
     <li class="itemize">return true when signature should trigger, false otherwise
     </li>
     <li class="itemize">use only integer compare instructions, branches, integer <span 
class="ec-lmri-10">add</span>, logical <span 
class="ec-lmri-10">and</span>, logical <span 
class="ec-lmri-10">or</span>, logical
     <span 
class="ec-lmri-10">xor</span>, zero extension, store/load from local variables
     </li>
     <li class="itemize">the  final  boolean  expression  must  be  convertible  to  disjunctive  normal  form  without
     negation
     </li>
     <li class="itemize">the final logical expression must not have more than 64 subexpressions
     </li>
     <li class="itemize">it can have early returns (all true returns are unified using <span 
class="lmsy-10">||</span>)
     </li>
     <li class="itemize">you can freely use comments, they are ignored
     </li>
     <li class="itemize">the final boolean expression cannot be a <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">true</span></span></span> or <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">false</span></span></span> constant</li></ul>
<!--l. 118--><p class="indent" >   The compiler does the following transformations (not necessarily in this order):
     <ul class="itemize1">
     <li class="itemize">convert shortcircuit boolean operations into non-shortcircuit ones (since all operands are
     boolean expressions or local variables, it is safe to execute these unconditionally)
                                                                                

                                                                                
     </li>
     <li class="itemize">propagate constants
     </li>
     <li class="itemize">simplify control flow graph
     </li>
     <li class="itemize">(sparse) conditional constant propagation
     </li>
     <li class="itemize">dead store elimination
     </li>
     <li class="itemize">dead code elimination
     </li>
     <li class="itemize">instruction combining (arithmetic simplifications)
     </li>
     <li class="itemize">jump threading</li></ul>
<!--l. 131--><p class="indent" >   If after this transformation the program meets the requirements outlined above, then it is converted
to a logical signature. The resulting logical signature is simplified using basic properties of boolean
operations, such as associativity, distributivity, De Morgan&#8217;s law.
<!--l. 135--><p class="indent" >   The final logical signature is not unique (there might be another logical signature with identical
behavior), however the boolean part is in a canonical form: it is in disjunctive normal form, with
operands sorted in ascending order.
<!--l. 138--><p class="indent" >   For best results the C code should consist of:
     <ul class="itemize1">
     <li class="itemize">local variables declaring the sums you want to use
     </li>
     <li class="itemize">a series of <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">if</span></span></span> branches that <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">return</span><span 
class="ec-lmtt-10">&#x00A0;true</span></span></span>, where the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">if</span></span></span>&#8217;s condition is a single comparison
     or a logical <span 
class="ec-lmri-10">and </span>of comparisons
     </li>
     <li class="itemize">a final <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">return</span><span 
class="ec-lmtt-10">&#x00A0;false</span></span></span></li></ul>
<!--l. 145--><p class="indent" >   You can use <span 
class="lmsy-10">|| </span>in the <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">if</span></span></span> condition too, but be careful that after expanding to disjunctive normal
form, the number of subexpressions doesn&#8217;t exceed 64.
<!--l. 147--><p class="indent" >   Note that you do not have to use all the subsignatures you declared in <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">logical_trigger</span></span></span>, you can
do more complicated checks (that wouldn&#8217;t obey the above restrictions) in the bytecode itself at
runtime. The <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">logical_trigger</span></span></span> function is fully compiled into a logical signature, it won&#8217;t be a runtime
executed function (hence the restrictions).
<a 
 id="x1-48001r59"></a>
<h3 class="sectionHead"><span class="titlemark">4.4. </span> <a 
 id="x1-490004"></a>Headers and runtime environment</h3>
<!--l. 152--><p class="noindent" >When compiling a bytecode program, <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">bytecode.h</span></span></span> is automatically included, so you don&#8217;t need to
explicitly include it. These headers (and the compiler itself) predefine certain macros, see Appendix&#x00A0;<span 
class="ec-lmbx-10">??</span>
for a full list. In addition the following types are defined: <!--l. 155-->
<div class="lstlisting" id="listing-4"><span class="label"><a 
 id="x1-49001r1"></a></span><span 
class="ec-lmtt-8">typedef</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">unsigned</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">char</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">uint8_t</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-49002r2"></a><span 
class="ec-lmr-5">2</span></span><span 
class="ec-lmtt-8">typedef</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">char</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">int8_t</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-49003r3"></a></span><span 
class="ec-lmtt-8">typedef</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">unsigned</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">short</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">uint16_t</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-49004r4"></a><span 
class="ec-lmr-5">4</span></span><span 
class="ec-lmtt-8">typedef</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">short</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">int16_t</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-49005r5"></a></span><span 
class="ec-lmtt-8">typedef</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">unsigned</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">int</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">uint32_t</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-49006r6"></a><span 
class="ec-lmr-5">6</span></span><span 
class="ec-lmtt-8">typedef</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">int</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">int32_t</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-49007r7"></a></span><span 
class="ec-lmtt-8">typedef</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">unsigned</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">long</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">uint64_t</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-49008r8"></a><span 
class="ec-lmr-5">8</span></span><span 
class="ec-lmtt-8">typedef</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">long</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">int64_t</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-49009r9"></a></span><span 
class="ec-lmtt-8">typedef</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">unsigned</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">int</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">size_t</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-49010r10"></a><span 
class="ec-lmr-5">10</span></span><span 
class="ec-lmtt-8">typedef</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">int</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">off_t</span><span 
class="ec-lmtt-8">;</span><span 
class="ec-lmtt-8">&#x00A0;</span><br /><span class="label"><a 
 id="x1-49011r11"></a></span><span 
class="ec-lmtt-8">typedef</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">struct</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">signature</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">{</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">unsigned</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">id</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">}</span><span 
class="ec-lmtt-8">&#x00A0;</span><span 
class="ec-lmtt-8">__Signature</span><span 
class="ec-lmtt-8">;</span>
                                                                                

                                                                                
   </div>
<!--l. 168--><p class="indent" >   As described in Section&#x00A0;<a 
href="#x1-460001">4.1<!--tex4ht:ref: sec:diffc --></a> the width of integer types are fixed, the above typedefs show
that.
<!--l. 170--><p class="indent" >   A bytecode&#8217;s entrypoint is the function <span class="obeylines-h"><span class="verb"><span 
class="ec-lmtt-10">entrypoint</span></span></span> and it&#8217;s required by ClamAV to load the
bytecode.
<!--l. 172--><p class="indent" >   Bytecode that is triggered by a logical signature must have a list of virusnames and patterns
defined. Bytecodes triggered via hooks can optionally have them, but for example a PE unpacker
doesn&#8217;t need virus names as it only processes the data.
                                                                                

                                                                                
                                                                                

                                                                                
                                                                                

                                                                                
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;5</span><br /><a 
 id="x1-500005"></a>Bytecode security &amp; portability</h2>
                                                                                

                                                                                
                                                                                

                                                                                
                                                                                

                                                                                
<!--l. 1--><p class="indent" >
                                                                                

                                                                                
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;6</span><br /><a 
 id="x1-510006"></a>Reporting bugs</h2>
                                                                                

                                                                                
                                                                                

                                                                                
                                                                                

                                                                                
<!--l. 1--><p class="indent" >
                                                                                

                                                                                
   <h2 class="chapterHead"><span class="titlemark">Chapter&#x00A0;7</span><br /><a 
 id="x1-520007"></a>Bytecode API</h2>
<a 
 id="x1-52001r60"></a>
<h3 class="sectionHead"><span class="titlemark">7.1. </span> <a 
 id="x1-530001"></a>API groups</h3>
<a 
 id="x1-53001r55"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.1. </span> <a 
 id="x1-540001"></a>Bytecode configuration</h4>
<!--l. 6--><p class="noindent" ><a 
 id="config"></a> <a 
 id="config__config000010"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a07318d0dd98e1eea463bb91dcbca277c"><span 
class="ec-lmbx-10">COPYRIGHT</span></a><span 
class="ec-lmbx-10">(c)</span>  This will also prevent the sourcecode from being embedded into
     the bytecode
<!--l. 9--><p class="noindent" ><a 
 id="config__config000007"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a9cc5358469543c230937ff04cb545a72"><span 
class="ec-lmbx-10">DECLARE_SIGNATURE</span></a><span 
class="ec-lmbx-10">(name)</span>
<!--l. 16--><p class="noindent" ><a 
 id="config__config000016"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_af17ef9c55c87be7943edda3732ed34b4"><span 
class="ec-lmbx-10">DEFINE_SIGNATURE</span></a><span 
class="ec-lmbx-10">(name, hex)</span>
<!--l. 23--><p class="noindent" ><a 
 id="config__config000014"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_afc471efa427277a2b96a2a06ba647aa9"><span 
class="ec-lmbx-10">FUNCTIONALITY_LEVEL_MAX</span></a><span 
class="ec-lmbx-10">(m)</span>
<!--l. 30--><p class="noindent" ><a 
 id="config__config000013"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a550536f35a9af1cf46db818baffe7912"><span 
class="ec-lmbx-10">FUNCTIONALITY_LEVEL_MIN</span></a><span 
class="ec-lmbx-10">(m)</span>
<!--l. 37--><p class="noindent" ><a 
 id="config__config000011"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a543de9b69d68ba528f60634777f72a5d"><span 
class="ec-lmbx-10">ICONGROUP1</span></a><span 
class="ec-lmbx-10">(group)</span>
<!--l. 44--><p class="noindent" ><a 
 id="config__config000012"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a655d7e9c6fcfec9b860d0acc56066326"><span 
class="ec-lmbx-10">ICONGROUP2</span></a><span 
class="ec-lmbx-10">(group)</span>
<!--l. 51--><p class="noindent" ><a 
 id="config__config000004"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a96c0aeeec87fbf8c08a2dd17c86f4cb0"><span 
class="ec-lmbx-10">PDF_HOOK_DECLARE</span></a>  This hook is called several times, use <a 
href="#bytecode__api_8h_af7eb372ae4bc42a552e543ea2a306f5e">pdf_get_phase()</a>
     to find out in which phase you got called.
<!--l. 58--><p class="noindent" ><a 
 id="config__config000005"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_aab7294d18a5e7d7c16234c4afe573d44"><span 
class="ec-lmbx-10">PE_HOOK_DECLARE</span></a>
<!--l. 65--><p class="noindent" ><a 
 id="config__config000003"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_adab197e0485a688211ac7f6add222691"><span 
class="ec-lmbx-10">PE_UNPACKER_DECLARE</span></a>
<!--l. 72--><p class="noindent" ><a 
 id="config__config000006"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a9d8dab26434a3a759f8934956f87c822"><span 
class="ec-lmbx-10">SIGNATURES_DECL_BEGIN</span></a>
                                                                                

                                                                                
<!--l. 79--><p class="noindent" ><a 
 id="config__config000008"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a75c0ab3e5d9f66a1e134c823200d295d"><span 
class="ec-lmbx-10">SIGNATURES_DECL_END</span></a>
<!--l. 86--><p class="noindent" ><a 
 id="config__config000015"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_af75911dca13ab8a873fe2bafd57a705a"><span 
class="ec-lmbx-10">SIGNATURES_DEF_BEGIN</span></a>
<!--l. 93--><p class="noindent" ><a 
 id="config__config000017"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ac9b976f78a0dac8a6996cbb31571044f"><span 
class="ec-lmbx-10">SIGNATURES_END</span></a>
<!--l. 100--><p class="noindent" ><a 
 id="config__config000009"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a8f4214a187b6ecb97ad7eef2317ebd3f"><span 
class="ec-lmbx-10">TARGET</span></a><span 
class="ec-lmbx-10">(tgt)</span>
<!--l. 107--><p class="noindent" ><a 
 id="config__config000001"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_af46256c8838bde91b834ae7323f325c9"><span 
class="ec-lmbx-10">VIRUSNAME_PREFIX</span></a><span 
class="ec-lmbx-10">(name)</span>
<!--l. 114--><p class="noindent" ><a 
 id="config__config000002"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a07e03751d8c0faf422b28d7138f69a57"><span 
class="ec-lmbx-10">VIRUSNAMES</span></a><span 
class="ec-lmbx-10">(...)</span>
<a 
 id="x1-54001r65"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.2. </span> <a 
 id="x1-550002"></a>Data structure handling functions</h4>
<!--l. 10--><p class="noindent" ><a 
 id="adt"></a> <a 
 id="adt__adt000016"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a984890c1d3b68b99e68c2e6b1a7704d0"><span 
class="ec-lmbx-10">buffer_pipe_done</span></a><span 
class="ec-lmbx-10">(int32_t id)</span>  After this all attempts to use this buffer will result
     in error. All buffer_pipes are automatically deallocated when bytecode finishes execution.
<!--l. 9--><p class="noindent" ><a 
 id="adt__adt000008"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_ae755b425ff65feddef7b86092dcdeed7"><span 
class="ec-lmbx-10">buffer_pipe_new</span></a><span 
class="ec-lmbx-10">(uint32_t size)</span>
<!--l. 16--><p class="noindent" ><a 
 id="adt__adt000009"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_adccae1152247859c54706b7d1753b689"><span 
class="ec-lmbx-10">buffer_pipe_new_fromfile</span></a><span 
class="ec-lmbx-10">(uint32_t pos)</span>
<!--l. 23--><p class="noindent" ><a 
 id="adt__adt000010"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a53de1d976b1536c5b6a0d5d31de201b2"><span 
class="ec-lmbx-10">buffer_pipe_read_avail</span></a><span 
class="ec-lmbx-10">(int32_t id)</span>
<!--l. 30--><p class="noindent" ><a 
 id="adt__adt000011"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_ac4df62495f080f7885911d71c6a379c7"><span 
class="ec-lmbx-10">buffer_pipe_read_get</span></a><span 
class="ec-lmbx-10">(int32_t id, uint32_t amount)</span>  The              &#8217;amount&#8217;
     parameter should be obtained by a call to <a 
href="#bytecode__api_8h_a53de1d976b1536c5b6a0d5d31de201b2">buffer_pipe_read_avail()</a>.
<!--l. 37--><p class="noindent" ><a 
 id="adt__adt000012"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_ae67b360d1ab3c9dc4ac9d0f90208f6fe"><span 
class="ec-lmbx-10">buffer_pipe_read_stopped</span></a><span 
class="ec-lmbx-10">(int32_t id, uint32_t amount)</span>  Updates       read
     cursor in buffer_pipe.
                                                                                

                                                                                
<!--l. 44--><p class="noindent" ><a 
 id="adt__adt000013"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a1b9d87fbb40620d92b57549e24b189e6"><span 
class="ec-lmbx-10">buffer_pipe_write_avail</span></a><span 
class="ec-lmbx-10">(int32_t id)</span>
<!--l. 51--><p class="noindent" ><a 
 id="adt__adt000014"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a8268aaabee12eed25ab561f678128ddd"><span 
class="ec-lmbx-10">buffer_pipe_write_get</span></a><span 
class="ec-lmbx-10">(int32_t id, uint32_t size)</span>  Returns pointer to writable
     buffer. The &#8217;amount&#8217; parameter should be obtained by a call to <a 
href="#bytecode__api_8h_a1b9d87fbb40620d92b57549e24b189e6">buffer_pipe_write_avail()</a>.
<!--l. 58--><p class="noindent" ><a 
 id="adt__adt000015"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a57b76f82f0fb9bdabaad6c3d98037e94"><span 
class="ec-lmbx-10">buffer_pipe_write_stopped</span></a><span 
class="ec-lmbx-10">(int32_t id, uint32_t amount)</span>
<!--l. 65--><p class="noindent" ><a 
 id="adt__adt000032"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a50ecabc9fb33d2194b257d68fc136eed"><span 
class="ec-lmbx-10">cli_readint16</span></a><span 
class="ec-lmbx-10">(const void </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">buff)</span>
<!--l. 72--><p class="noindent" ><a 
 id="adt__adt000031"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a3d6a38ce39dd509a2526a67f8f00f845"><span 
class="ec-lmbx-10">cli_readint32</span></a><span 
class="ec-lmbx-10">(const void </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">buff)</span>
<!--l. 79--><p class="noindent" ><a 
 id="adt__adt000033"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ae275f25ed41739954c981ed4717ebd22"><span 
class="ec-lmbx-10">cli_writeint32</span></a><span 
class="ec-lmbx-10">(void </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">offset, uint32_t v)</span>
<!--l. 86--><p class="noindent" ><a 
 id="adt__adt000003"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_adb42ee13e5883410846a392513d6866b"><span 
class="ec-lmbx-10">hashset_add</span></a><span 
class="ec-lmbx-10">(int32_t hs, uint32_t key)</span>
<!--l. 93--><p class="noindent" ><a 
 id="adt__adt000005"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a0907920e08ec8e80f3ff829e8aaf58de"><span 
class="ec-lmbx-10">hashset_contains</span></a><span 
class="ec-lmbx-10">(int32_t hs, uint32_t key)</span>
<!--l. 100--><p class="noindent" ><a 
 id="adt__adt000006"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_abd5e701c80bf5346a72fb145834b865a"><span 
class="ec-lmbx-10">hashset_done</span></a><span 
class="ec-lmbx-10">(int32_t id)</span>  Trying to use the hashset after this will result in an
     error. The hashset may not be used after this. All hashsets are automatically deallocated
     when bytecode finishes execution.
<!--l. 107--><p class="noindent" ><a 
 id="adt__adt000007"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a854fcc65ad8cc0578c55aea6bc88b193"><span 
class="ec-lmbx-10">hashset_empty</span></a><span 
class="ec-lmbx-10">(int32_t id)</span>
<!--l. 114--><p class="noindent" ><a 
 id="adt__adt000002"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_ab791b1626efae568e0fb62c36ce8aa74"><span 
class="ec-lmbx-10">hashset_new</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 121--><p class="noindent" ><a 
 id="adt__adt000004"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a06c14cce8ec4cc839a02094547964a00"><span 
class="ec-lmbx-10">hashset_remove</span></a><span 
class="ec-lmbx-10">(int32_t hs, uint32_t key)</span>
<!--l. 128--><p class="noindent" ><a 
 id="adt__adt000019"></a>
                                                                                

                                                                                
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a123c12ca76a5b736217b68fdb126066e"><span 
class="ec-lmbx-10">inflate_done</span></a><span 
class="ec-lmbx-10">(int32_t id)</span>
<!--l. 135--><p class="noindent" ><a 
 id="adt__adt000017"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a65eec3722a1e992e9e4104c037503fdc"><span 
class="ec-lmbx-10">inflate_init</span></a><span 
class="ec-lmbx-10">(int32_t from_buffer, int32_t to_buffer, int32_t windowBits)</span>
     &#8217;from_buffer&#8217; and writing uncompressed uncompressed data &#8217;to_buffer&#8217;.
<!--l. 142--><p class="noindent" ><a 
 id="adt__adt000018"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a10ad344e58c26566defe1780b303f0a4"><span 
class="ec-lmbx-10">inflate_process</span></a><span 
class="ec-lmbx-10">(int32_t id)</span>
<!--l. 149--><p class="noindent" ><a 
 id="adt__adt000030"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a9e0a2862823999029c872ee352df036d"><span 
class="ec-lmbx-10">le16_to_host</span></a><span 
class="ec-lmbx-10">(uint16_t v)</span>
<!--l. 156--><p class="noindent" ><a 
 id="adt__adt000028"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a9d6c63ead621ba606fe4d01b4558a9dc"><span 
class="ec-lmbx-10">le32_to_host</span></a><span 
class="ec-lmbx-10">(uint32_t v)</span>
<!--l. 163--><p class="noindent" ><a 
 id="adt__adt000029"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a574fdd0c27b3c4d8289f346edb2ffc2e"><span 
class="ec-lmbx-10">le64_to_host</span></a><span 
class="ec-lmbx-10">(uint64_t v)</span>
<!--l. 170--><p class="noindent" ><a 
 id="adt__adt000001"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a8704c31c2d7a73953f3c1c320447c24a"><span 
class="ec-lmbx-10">malloc</span></a><span 
class="ec-lmbx-10">(uint32_t size)</span>
<!--l. 177--><p class="noindent" ><a 
 id="adt__adt000021"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a962d8bc4658ba7dd411c75d7561c2fee"><span 
class="ec-lmbx-10">map_addkey</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">key, int32_t ksize, int32_t id)</span>
<!--l. 184--><p class="noindent" ><a 
 id="adt__adt000027"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a2603885df2096dc840d887461c3b1aac"><span 
class="ec-lmbx-10">map_done</span></a><span 
class="ec-lmbx-10">(int32_t id)</span>
<!--l. 191--><p class="noindent" ><a 
 id="adt__adt000024"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_ac45a2c7ac861578b8001b2116eee10aa"><span 
class="ec-lmbx-10">map_find</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">key, int32_t ksize, int32_t id)</span>
<!--l. 198--><p class="noindent" ><a 
 id="adt__adt000026"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a6a8bbb58c0ccad537eec575949e5f9f7"><span 
class="ec-lmbx-10">map_getvalue</span></a><span 
class="ec-lmbx-10">(int32_t id, int32_t size)</span>
<!--l. 205--><p class="noindent" ><a 
 id="adt__adt000025"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_aac4176bebb0d4896ad64452bec023012"><span 
class="ec-lmbx-10">map_getvaluesize</span></a><span 
class="ec-lmbx-10">(int32_t id)</span>
<!--l. 212--><p class="noindent" ><a 
 id="adt__adt000020"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a8350ff5a10c6d2b8aa5c9b20bd0b032f"><span 
class="ec-lmbx-10">map_new</span></a><span 
class="ec-lmbx-10">(int32_t keysize, int32_t valuesize)</span>
                                                                                

                                                                                
<!--l. 219--><p class="noindent" ><a 
 id="adt__adt000023"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_aeadbaac505160a820fe766cdaf95aba6"><span 
class="ec-lmbx-10">map_remove</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">key, int32_t ksize, int32_t id)</span>
<!--l. 226--><p class="noindent" ><a 
 id="adt__adt000022"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_afdae99c4fa909e017962e8b869950005"><span 
class="ec-lmbx-10">map_setvalue</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">value, int32_t vsize, int32_t id)</span>
<a 
 id="x1-55001r66"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.3. </span> <a 
 id="x1-560003"></a>Disassemble APIs</h4>
<!--l. 14--><p class="noindent" ><a 
 id="disasm"></a> <a 
 id="disasm__disasm000003"></a>
<span 
class="ec-lmbx-10">Class </span><a 
href="#struct_d_i_s__arg"><span 
class="ec-lmbx-10">DIS_arg</span></a>
<!--l. 9--><p class="noindent" ><a 
 id="disasm__disasm000004"></a>
<span 
class="ec-lmbx-10">Class </span><a 
href="#struct_d_i_s__fixed"><span 
class="ec-lmbx-10">DIS_fixed</span></a>
<!--l. 16--><p class="noindent" ><a 
 id="disasm__disasm000002"></a>
<span 
class="ec-lmbx-10">Class </span><a 
href="#struct_d_i_s__mem__arg"><span 
class="ec-lmbx-10">DIS_mem_arg</span></a>
<!--l. 23--><p class="noindent" ><a 
 id="disasm__disasm000001"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a95e7d1048a56c98dec19335a6aa7afca"><span 
class="ec-lmbx-10">disasm_x86</span></a><span 
class="ec-lmbx-10">(struct </span><a 
href="#struct_d_i_s_a_s_m___r_e_s_u_l_t"><span 
class="ec-lmbx-10">DISASM_RESULT</span></a> <span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">result, uint32_t len)</span>
<!--l. 30--><p class="noindent" ><a 
 id="disasm__disasm000005"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a1a801c0806f1cb7ed433f139e5769f99"><span 
class="ec-lmbx-10">DisassembleAt</span></a><span 
class="ec-lmbx-10">(struct </span><a 
href="#struct_d_i_s__fixed"><span 
class="ec-lmbx-10">DIS_fixed</span></a> <span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">result, uint32_t offset, uint32_t len)</span>
<a 
 id="x1-56001r67"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.4. </span> <a 
 id="x1-570004"></a>Engine queries</h4>
<!--l. 18--><p class="noindent" ><a 
 id="engineq"></a> <a 
 id="engineq__engineq000005"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a3bee86d89c2e0d16b706f62ec0c2d716"><span 
class="ec-lmbx-10">count_match</span></a><span 
class="ec-lmbx-10">(__Signature sig)</span>
<!--l. 9--><p class="noindent" ><a 
 id="engineq__engineq000004"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_afc1eab4e86797378b5c1e7186894c1a7"><span 
class="ec-lmbx-10">engine_db_options</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 16--><p class="noindent" ><a 
 id="engineq__engineq000002"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a4fa59c900fefd4a4441fcc4b3e44830d"><span 
class="ec-lmbx-10">engine_dconf_level</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 23--><p class="noindent" ><a 
 id="engineq__engineq000001"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_addc54afadb3d660c92e4e350548086d8"><span 
class="ec-lmbx-10">engine_functionality_level</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 30--><p class="noindent" ><a 
 id="engineq__engineq000003"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a0cd507ebdbadaa5899ca032cb5f69e3c"><span 
class="ec-lmbx-10">engine_scan_options</span></a><span 
class="ec-lmbx-10">(void)</span>
                                                                                

                                                                                
<!--l. 37--><p class="noindent" ><a 
 id="engineq__engineq000007"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a0731ae7f531521a4c8609d75a21d3edd"><span 
class="ec-lmbx-10">match_location</span></a><span 
class="ec-lmbx-10">(__Signature sig, uint32_t goback)</span>
<!--l. 44--><p class="noindent" ><a 
 id="engineq__engineq000008"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ae815c917305f5ce574b0e759f605819b"><span 
class="ec-lmbx-10">match_location_check</span></a><span 
class="ec-lmbx-10">(__Signature sig, uint32_t goback, const char </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">static_start, uint32_t static_len)</span>
     It is recommended to use this for safety and compatibility with 0.96.1
<!--l. 51--><p class="noindent" ><a 
 id="engineq__engineq000006"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_afb7a07b6a6a5826f43f624fa1af2a8c6"><span 
class="ec-lmbx-10">matches</span></a><span 
class="ec-lmbx-10">(__Signature sig)</span>
<a 
 id="x1-57001r68"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.5. </span> <a 
 id="x1-580005"></a>Environment detection functions</h4>
<!--l. 22--><p class="noindent" ><a 
 id="envdet"></a> <a 
 id="envdet__envdet000006"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_af3a7e5cbd0c798faf98a03ee7c72e661"><span 
class="ec-lmbx-10">__is_bigendian</span></a><span 
class="ec-lmbx-10">(void) __attribute__((const )) __attribute__((nothrow))</span>
<!--l. 9--><p class="noindent" ><a 
 id="envdet__envdet000005"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a9b52373152ee8dd8fd45ea6b242e5698"><span 
class="ec-lmbx-10">check_platform</span></a><span 
class="ec-lmbx-10">(uint32_t a, uint32_t b, uint32_t c)</span>
<!--l. 16--><p class="noindent" ><a 
 id="envdet__envdet000002"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a1b9af8b47763bc3e2d0323a605209702"><span 
class="ec-lmbx-10">disable_bytecode_if</span></a><span 
class="ec-lmbx-10">(const int8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">reason, uint32_t len, uint32_t cond)</span>
<!--l. 23--><p class="noindent" ><a 
 id="envdet__envdet000003"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_acccb9f64252a40f3857007f0e382f8eb"><span 
class="ec-lmbx-10">disable_jit_if</span></a><span 
class="ec-lmbx-10">(const int8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">reason, uint32_t len, uint32_t cond)</span>
<!--l. 30--><p class="noindent" ><a 
 id="envdet__envdet000001"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a4e38f5731d8d7578399d6bcf97ec1a27"><span 
class="ec-lmbx-10">get_environment</span></a><span 
class="ec-lmbx-10">(struct cli_environment </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">env, uint32_t len)</span>
<!--l. 37--><p class="noindent" ><a 
 id="envdet__envdet000004"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a18a8ecdd5235c80782b7e3e1892553ef"><span 
class="ec-lmbx-10">version_compare</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">lhs, uint32_t lhs_len, const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">rhs, uint32_t rhs_len)</span>
<a 
 id="x1-58001r69"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.6. </span> <a 
 id="x1-590006"></a>File operations</h4>
<!--l. 26--><p class="noindent" ><a 
 id="fileops"></a> <a 
 id="fileops__fileops000008"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_adccae1152247859c54706b7d1753b689"><span 
class="ec-lmbx-10">buffer_pipe_new_fromfile</span></a><span 
class="ec-lmbx-10">(uint32_t pos)</span>  to  the  current  file,  at  the  specified
     position.
<!--l. 9--><p class="noindent" ><a 
 id="fileops__fileops000005"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a1e192cd4fe94e68dbac5023a1e2481c9"><span 
class="ec-lmbx-10">file_byteat</span></a><span 
class="ec-lmbx-10">(uint32_t offset)</span>
                                                                                

                                                                                
<!--l. 16--><p class="noindent" ><a 
 id="fileops__fileops000004"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a56355a07d9fb739dd483dd756f7fe821"><span 
class="ec-lmbx-10">file_find</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">data, uint32_t len)</span>
<!--l. 23--><p class="noindent" ><a 
 id="fileops__fileops000009"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_ad7479f2fd346e59217f50726be9502a3"><span 
class="ec-lmbx-10">file_find_limit</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">data, uint32_t len, int32_t maxpos)</span>
<!--l. 30--><p class="noindent" ><a 
 id="fileops__fileops000006"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a5c25c11f12899883af10f3ba75cfc5c5"><span 
class="ec-lmbx-10">fill_buffer</span></a><span 
class="ec-lmbx-10">(uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">buffer, uint32_t len, uint32_t filled, uint32_t cursor, uint32_t fill)</span>
<!--l. 37--><p class="noindent" ><a 
 id="fileops__fileops000010"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a4dfb3482a7f04ae1e51942755253d720"><span 
class="ec-lmbx-10">getFilesize</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 44--><p class="noindent" ><a 
 id="fileops__fileops000001"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_afa4f1c799291804204aea54ce23077d6"><span 
class="ec-lmbx-10">read</span></a><span 
class="ec-lmbx-10">(uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">data, int32_t size)</span>
<!--l. 51--><p class="noindent" ><a 
 id="fileops__fileops000007"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a50b84b15fbaf03aa39b41ef7ffb5243e"><span 
class="ec-lmbx-10">read_number</span></a><span 
class="ec-lmbx-10">(uint32_t radix)</span>  Non-numeric characters are ignored.
<!--l. 58--><p class="noindent" ><a 
 id="fileops__fileops000003"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_aac5ea598a656985291c56321ad2140ea"><span 
class="ec-lmbx-10">seek</span></a><span 
class="ec-lmbx-10">(int32_t pos, uint32_t whence)</span>
<!--l. 65--><p class="noindent" ><a 
 id="fileops__fileops000002"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a01d98e416d08e0eabd02d2e8aa56f28e"><span 
class="ec-lmbx-10">write</span></a><span 
class="ec-lmbx-10">(uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">data, int32_t size)</span>
<a 
 id="x1-59001r70"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.7. </span> <a 
 id="x1-600007"></a>Global variables</h4>
<!--l. 30--><p class="noindent" ><a 
 id="globals"></a> <a 
 id="globals__globals000004"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_ab8d6c50474be3ba69906161a3e520ce7"><span 
class="ec-lmbx-10">__clambc_filesize</span></a><span 
class="ec-lmbx-10">[</span><span 
class="ec-lmbx-10">1</span><span 
class="ec-lmbx-10">]</span>
<!--l. 9--><p class="noindent" ><a 
 id="globals__globals000005"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a6eb3802e21949cfdf6b91570d3c62c99"><span 
class="ec-lmbx-10">__clambc_kind</span></a>
<!--l. 16--><p class="noindent" ><a 
 id="globals__globals000001"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a35a0a4f1219a792c77b7207924c3c4ec"><span 
class="ec-lmbx-10">__clambc_match_counts</span></a><span 
class="ec-lmbx-10">[</span><span 
class="ec-lmbx-10">64</span><span 
class="ec-lmbx-10">]</span>
<!--l. 23--><p class="noindent" ><a 
 id="globals__globals000002"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_ae39872934c5879706b3cedaef090d227"><span 
class="ec-lmbx-10">__clambc_match_offsets</span></a><span 
class="ec-lmbx-10">[</span><span 
class="ec-lmbx-10">64</span><span 
class="ec-lmbx-10">]</span>
                                                                                

                                                                                
<!--l. 30--><p class="noindent" ><a 
 id="globals__globals000003"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a3d386181912bdbc2b90ee559b0cccde3"><span 
class="ec-lmbx-10">__clambc_pedata</span></a>
<a 
 id="x1-60001r71"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.8. </span> <a 
 id="x1-610008"></a>Icon matcher APIs</h4>
<!--l. 34--><p class="noindent" ><a 
 id="icon"></a> <a 
 id="icon__icon000001"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a8e0bc8430adb57c0808bbf916e49185f"><span 
class="ec-lmbx-10">matchicon</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">group1, int32_t group1_len, const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">group2, int32_t group2_len)</span>
<a 
 id="x1-61001r72"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.9. </span> <a 
 id="x1-620009"></a>JS normalize API</h4>
<!--l. 38--><p class="noindent" ><a 
 id="js"></a> <a 
 id="js__js000003"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a7445bceea42b0a4d1d841b2c8826db4a"><span 
class="ec-lmbx-10">jsnorm_done</span></a><span 
class="ec-lmbx-10">(int32_t id)</span>
<!--l. 9--><p class="noindent" ><a 
 id="js__js000001"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_afb97628e1638c524b0cf45190403553d"><span 
class="ec-lmbx-10">jsnorm_init</span></a><span 
class="ec-lmbx-10">(int32_t from_buffer)</span>
<!--l. 16--><p class="noindent" ><a 
 id="js__js000002"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a5c0da722aa4ccb9618052c5a2361ed8e"><span 
class="ec-lmbx-10">jsnorm_process</span></a><span 
class="ec-lmbx-10">(int32_t id)</span>
<a 
 id="x1-62001r73"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.10. </span> <a 
 id="x1-6300010"></a>Math functions</h4>
<!--l. 42--><p class="noindent" ><a 
 id="math"></a> <a 
 id="math__math000005"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a6aeece8bfb39a8499b44d67c8bebb716"><span 
class="ec-lmbx-10">icos</span></a><span 
class="ec-lmbx-10">(int32_t a, int32_t b, int32_t c)</span>
<!--l. 9--><p class="noindent" ><a 
 id="math__math000003"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a5d986d8e22cce16cfd2bb0cef0ac111e"><span 
class="ec-lmbx-10">iexp</span></a><span 
class="ec-lmbx-10">(int32_t a, int32_t b, int32_t c)</span>
<!--l. 16--><p class="noindent" ><a 
 id="math__math000001"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a59893a4520a13171c94d6ce63fce6c4b"><span 
class="ec-lmbx-10">ilog2</span></a><span 
class="ec-lmbx-10">(uint32_t a, uint32_t b)</span>
<!--l. 23--><p class="noindent" ><a 
 id="math__math000002"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_abd69b1aa30157a6d87658db53ece8f5a"><span 
class="ec-lmbx-10">ipow</span></a><span 
class="ec-lmbx-10">(int32_t a, int32_t b, int32_t c)</span>
<!--l. 30--><p class="noindent" ><a 
 id="math__math000004"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_acca08245d3d1a190375a92d5c51b2a90"><span 
class="ec-lmbx-10">isin</span></a><span 
class="ec-lmbx-10">(int32_t a, int32_t b, int32_t c)</span>
<a 
 id="x1-63001r74"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.11. </span> <a 
 id="x1-6400011"></a>PDF handling functions</h4>
<!--l. 46--><p class="noindent" ><a 
 id="pdfg"></a> <a 
 id="pdfg__pdfg000008"></a>
                                                                                

                                                                                
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_aaa88ff051b0da6314c9655da624bb0f5"><span 
class="ec-lmbx-10">pdf_get_dumpedobjid</span></a><span 
class="ec-lmbx-10">(void)</span>  Valid only in PDF_PHASE_POSTDUMP.
<!--l. 9--><p class="noindent" ><a 
 id="pdfg__pdfg000002"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a854b697b5e662b79c5931a7864ce0709"><span 
class="ec-lmbx-10">pdf_get_flags</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 16--><p class="noindent" ><a 
 id="pdfg__pdfg000001"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_aca9074092cae6ed378ffdc5ba7cfc77e"><span 
class="ec-lmbx-10">pdf_get_obj_num</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 23--><p class="noindent" ><a 
 id="pdfg__pdfg000007"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_af7eb372ae4bc42a552e543ea2a306f5e"><span 
class="ec-lmbx-10">pdf_get_phase</span></a><span 
class="ec-lmbx-10">(void)</span>  Identifies at which phase this bytecode was called.
<!--l. 30--><p class="noindent" ><a 
 id="pdfg__pdfg000006"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a6504bd64de6bee96e9606260753a6ac0"><span 
class="ec-lmbx-10">pdf_getobj</span></a><span 
class="ec-lmbx-10">(int32_t objidx, uint32_t amount)</span>  Meant  only  for  reading,  write
     modifies the fmap buffer, so avoid!
<!--l. 37--><p class="noindent" ><a 
 id="pdfg__pdfg000005"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a0270605365fe5bb2f721eefe6f703255"><span 
class="ec-lmbx-10">pdf_getobjsize</span></a><span 
class="ec-lmbx-10">(int32_t objidx)</span>
<!--l. 44--><p class="noindent" ><a 
 id="pdfg__pdfg000004"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a06f5560acc053270453250c387692068"><span 
class="ec-lmbx-10">pdf_lookupobj</span></a><span 
class="ec-lmbx-10">(uint32_t id)</span>
<!--l. 51--><p class="noindent" ><a 
 id="pdfg__pdfg000003"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a1524216162135a13acfecc0cbc82ac03"><span 
class="ec-lmbx-10">pdf_set_flags</span></a><span 
class="ec-lmbx-10">(int32_t flags)</span>
<a 
 id="x1-64001r75"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.12. </span> <a 
 id="x1-6500012"></a>PE functions</h4>
<!--l. 50--><p class="noindent" ><a 
 id="pe"></a> <a 
 id="pe__pe000004"></a>
<span 
class="ec-lmbx-10">Class </span><a 
href="#structcli__exe__info"><span 
class="ec-lmbx-10">cli_exe_info</span></a>
<!--l. 9--><p class="noindent" ><a 
 id="pe__pe000003"></a>
<span 
class="ec-lmbx-10">Class </span><a 
href="#structcli__exe__section"><span 
class="ec-lmbx-10">cli_exe_section</span></a>
<!--l. 16--><p class="noindent" ><a 
 id="pe__pe000059"></a>
<span 
class="ec-lmbx-10">Class </span><a 
href="#structcli__pe__hook__data"><span 
class="ec-lmbx-10">cli_pe_hook_data</span></a>
<!--l. 23--><p class="noindent" ><a 
 id="pe__pe000002"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_ae7e5e9cef42c34a52cfe814910a1e293"><span 
class="ec-lmbx-10">get_pe_section</span></a><span 
class="ec-lmbx-10">(struct </span><a 
href="#structcli__exe__section"><span 
class="ec-lmbx-10">cli_exe_section</span></a> <span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">section, uint32_t num)</span>
<!--l. 30--><p class="noindent" ><a 
 id="pe__pe000047"></a>
                                                                                

                                                                                
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ad26217bb0fe3c43d933bf48b9957bc53"><span 
class="ec-lmbx-10">getEntryPoint</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 37--><p class="noindent" ><a 
 id="pe__pe000048"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ae06107422b3a2bd8a9a07fb344e8a8da"><span 
class="ec-lmbx-10">getExeOffset</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 44--><p class="noindent" ><a 
 id="pe__pe000049"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a20fbd92de54ff30ade353ca8381ec766"><span 
class="ec-lmbx-10">getImageBase</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 51--><p class="noindent" ><a 
 id="pe__pe000044"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_acc59dfc3eb084259883225674083e553"><span 
class="ec-lmbx-10">getNumberOfSections</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 58--><p class="noindent" ><a 
 id="pe__pe000013"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a4856f8c8b2250e9ff7a15bfc651e9dc5"><span 
class="ec-lmbx-10">getPEBaseOfCode</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 65--><p class="noindent" ><a 
 id="pe__pe000014"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a906067648342e627e35608446ae28faf"><span 
class="ec-lmbx-10">getPEBaseOfData</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 72--><p class="noindent" ><a 
 id="pe__pe000040"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ab93887618aa8cebb250f28574634093a"><span 
class="ec-lmbx-10">getPECharacteristics</span></a><span 
class="ec-lmbx-10">()</span>
<!--l. 79--><p class="noindent" ><a 
 id="pe__pe000027"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a07f9eaa84e03e09a833facf15d170bff"><span 
class="ec-lmbx-10">getPECheckSum</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 86--><p class="noindent" ><a 
 id="pe__pe000042"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ab9e2deafba57fe896c13e38e5d45be9e"><span 
class="ec-lmbx-10">getPEDataDirRVA</span></a><span 
class="ec-lmbx-10">(unsigned n)</span>
<!--l. 93--><p class="noindent" ><a 
 id="pe__pe000043"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a19dd537d51a4bfe23f58a92b2332ed02"><span 
class="ec-lmbx-10">getPEDataDirSize</span></a><span 
class="ec-lmbx-10">(unsigned n)</span>
<!--l. 100--><p class="noindent" ><a 
 id="pe__pe000029"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a307bc20f197de9d15bb6e08e9d8f3785"><span 
class="ec-lmbx-10">getPEDllCharacteristics</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 107--><p class="noindent" ><a 
 id="pe__pe000017"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a3d3676596ffad052f01ed7355062921c"><span 
class="ec-lmbx-10">getPEFileAlignment</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 114--><p class="noindent" ><a 
 id="pe__pe000015"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a5be87a6ddd3f434c8755a54b441da600"><span 
class="ec-lmbx-10">getPEImageBase</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 121--><p class="noindent" ><a 
 id="pe__pe000041"></a>
                                                                                

                                                                                
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a027ee938f8372e45d6fe6197d10ecc96"><span 
class="ec-lmbx-10">getPEisDLL</span></a><span 
class="ec-lmbx-10">()</span>
<!--l. 128--><p class="noindent" ><a 
 id="pe__pe000045"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a0ed633b358ee0280504b9e2b55492a8d"><span 
class="ec-lmbx-10">getPELFANew</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 135--><p class="noindent" ><a 
 id="pe__pe000034"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_adae84c4057d5721d9606218d3eed5e34"><span 
class="ec-lmbx-10">getPELoaderFlags</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 142--><p class="noindent" ><a 
 id="pe__pe000035"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a01fe1e273462c9386b45f7661d15b55a"><span 
class="ec-lmbx-10">getPEMachine</span></a><span 
class="ec-lmbx-10">()</span>
<!--l. 149--><p class="noindent" ><a 
 id="pe__pe000020"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_aea163191c14a5af87883231d7358070f"><span 
class="ec-lmbx-10">getPEMajorImageVersion</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 156--><p class="noindent" ><a 
 id="pe__pe000008"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a0563ea1400d07e675a20ab0dcfd905eb"><span 
class="ec-lmbx-10">getPEMajorLinkerVersion</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 163--><p class="noindent" ><a 
 id="pe__pe000018"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a220d77f9285699cf6bfda4b629193aea"><span 
class="ec-lmbx-10">getPEMajorOperatingSystemVersion</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 170--><p class="noindent" ><a 
 id="pe__pe000022"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a9c6364f035901ed9983edc13a709f8f4"><span 
class="ec-lmbx-10">getPEMajorSubsystemVersion</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 177--><p class="noindent" ><a 
 id="pe__pe000021"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a3c2af71ce767165317d0da8f8a23dc24"><span 
class="ec-lmbx-10">getPEMinorImageVersion</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 184--><p class="noindent" ><a 
 id="pe__pe000009"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ac77d151a09c2de3b1d803567d24892b3"><span 
class="ec-lmbx-10">getPEMinorLinkerVersion</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 191--><p class="noindent" ><a 
 id="pe__pe000019"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a5b621a2c5114f83e6e1b2a2648b17909"><span 
class="ec-lmbx-10">getPEMinorOperatingSystemVersion</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 198--><p class="noindent" ><a 
 id="pe__pe000023"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ab8516cf0fd00093557a6b84e766f21cf"><span 
class="ec-lmbx-10">getPEMinorSubsystemVersion</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 205--><p class="noindent" ><a 
 id="pe__pe000038"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a49632081cf680004297e0b2ce99c6cb8"><span 
class="ec-lmbx-10">getPENumberOfSymbols</span></a><span 
class="ec-lmbx-10">()</span>
<!--l. 212--><p class="noindent" ><a 
 id="pe__pe000037"></a>
                                                                                

                                                                                
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a3edd1734cfe7362eb26f6d6630fefb00"><span 
class="ec-lmbx-10">getPEPointerToSymbolTable</span></a><span 
class="ec-lmbx-10">()</span>
<!--l. 219--><p class="noindent" ><a 
 id="pe__pe000016"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a564b495dcdeaccf29a0ad97046be73c1"><span 
class="ec-lmbx-10">getPESectionAlignment</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 226--><p class="noindent" ><a 
 id="pe__pe000010"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ad9f53af41bcca14d46ce507e2e6ab16c"><span 
class="ec-lmbx-10">getPESizeOfCode</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 233--><p class="noindent" ><a 
 id="pe__pe000026"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a80cc732b7672ea102d4704946c6eb2aa"><span 
class="ec-lmbx-10">getPESizeOfHeaders</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 240--><p class="noindent" ><a 
 id="pe__pe000033"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ae9c031fc42de436f574943f089c508c5"><span 
class="ec-lmbx-10">getPESizeOfHeapCommit</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 247--><p class="noindent" ><a 
 id="pe__pe000032"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_aea6b290ae054a0b872887071b4b0f9f2"><span 
class="ec-lmbx-10">getPESizeOfHeapReserve</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 254--><p class="noindent" ><a 
 id="pe__pe000025"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a2a8e7a0acac5e007bfb4e28d57f3170f"><span 
class="ec-lmbx-10">getPESizeOfImage</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 261--><p class="noindent" ><a 
 id="pe__pe000011"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a50cf975bcf2f8fff010b8a8a26bb8ada"><span 
class="ec-lmbx-10">getPESizeOfInitializedData</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 268--><p class="noindent" ><a 
 id="pe__pe000039"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a22825914a55dbe5d5548a5e07bb0b24d"><span 
class="ec-lmbx-10">getPESizeOfOptionalHeader</span></a><span 
class="ec-lmbx-10">()</span>
<!--l. 275--><p class="noindent" ><a 
 id="pe__pe000031"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ae99c81416872de61956e064fc1e32550"><span 
class="ec-lmbx-10">getPESizeOfStackCommit</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 282--><p class="noindent" ><a 
 id="pe__pe000030"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a61370982c310e3aeed974dd0abe02284"><span 
class="ec-lmbx-10">getPESizeOfStackReserve</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 289--><p class="noindent" ><a 
 id="pe__pe000012"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a8bcd1876daa53ee94772ada292b039d8"><span 
class="ec-lmbx-10">getPESizeOfUninitializedData</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 296--><p class="noindent" ><a 
 id="pe__pe000028"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a4027528d4bc10b3b736bf733db903dd1"><span 
class="ec-lmbx-10">getPESubsystem</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 303--><p class="noindent" ><a 
 id="pe__pe000036"></a>
                                                                                

                                                                                
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a28e4809837328528a644c53d8a864fc6"><span 
class="ec-lmbx-10">getPETimeDateStamp</span></a><span 
class="ec-lmbx-10">()</span>
<!--l. 310--><p class="noindent" ><a 
 id="pe__pe000024"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a20c5188f3da8c956592847265abc287b"><span 
class="ec-lmbx-10">getPEWin32VersionValue</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 317--><p class="noindent" ><a 
 id="pe__pe000051"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_aedc2fa35d4664099b528c68653f593f2"><span 
class="ec-lmbx-10">getSectionRVA</span></a><span 
class="ec-lmbx-10">(unsigned i)</span>  .
<!--l. 324--><p class="noindent" ><a 
 id="pe__pe000052"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ad81443723d60b2eaf56aa13718a0bf47"><span 
class="ec-lmbx-10">getSectionVirtualSize</span></a><span 
class="ec-lmbx-10">(unsigned i)</span>  .
<!--l. 331--><p class="noindent" ><a 
 id="pe__pe000050"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a488ebd9cda9e8ba46ba5daae94ddb453"><span 
class="ec-lmbx-10">getVirtualEntryPoint</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 338--><p class="noindent" ><a 
 id="pe__pe000005"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a6241ff42b1300527c64034931f027738"><span 
class="ec-lmbx-10">hasExeInfo</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 345--><p class="noindent" ><a 
 id="pe__pe000006"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_abfb2cd189ec07a4e521a906581e421e6"><span 
class="ec-lmbx-10">hasPEInfo</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 352--><p class="noindent" ><a 
 id="pe__pe000007"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a7480d681206faafd4c0f1923938dd5fe"><span 
class="ec-lmbx-10">isPE64</span></a><span 
class="ec-lmbx-10">(void)</span>
<!--l. 359--><p class="noindent" ><a 
 id="pe__pe000055"></a>
<span 
class="ec-lmbx-10">Class </span><a 
href="#structpe__image__data__dir"><span 
class="ec-lmbx-10">pe_image_data_dir</span></a>
<!--l. 366--><p class="noindent" ><a 
 id="pe__pe000054"></a>
<span 
class="ec-lmbx-10">Class </span><a 
href="#structpe__image__file__hdr"><span 
class="ec-lmbx-10">pe_image_file_hdr</span></a>
<!--l. 373--><p class="noindent" ><a 
 id="pe__pe000056"></a>
<span 
class="ec-lmbx-10">Class </span><a 
href="#structpe__image__optional__hdr32"><span 
class="ec-lmbx-10">pe_image_optional_hdr32</span></a>
<!--l. 380--><p class="noindent" ><a 
 id="pe__pe000057"></a>
<span 
class="ec-lmbx-10">Class </span><a 
href="#structpe__image__optional__hdr64"><span 
class="ec-lmbx-10">pe_image_optional_hdr64</span></a>
<!--l. 387--><p class="noindent" ><a 
 id="pe__pe000058"></a>
<span 
class="ec-lmbx-10">Class </span><a 
href="#structpe__image__section__hdr"><span 
class="ec-lmbx-10">pe_image_section_hdr</span></a>
<!--l. 394--><p class="noindent" ><a 
 id="pe__pe000001"></a>
                                                                                

                                                                                
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a0d081f8f58263eb99d68690f1f9b2a81"><span 
class="ec-lmbx-10">pe_rawaddr</span></a><span 
class="ec-lmbx-10">(uint32_t rva)</span>
<!--l. 401--><p class="noindent" ><a 
 id="pe__pe000046"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a783b0c34b69dfcdcc3c00e0172e53938"><span 
class="ec-lmbx-10">readPESectionName</span></a><span 
class="ec-lmbx-10">(unsigned char name</span><span 
class="ec-lmbx-10">[</span><span 
class="ec-lmbx-10">8</span><span 
class="ec-lmbx-10">]</span><span 
class="ec-lmbx-10">, unsigned n)</span>
<!--l. 408--><p class="noindent" ><a 
 id="pe__pe000053"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a59c863dbbe659efa59f38a45dfc0094c"><span 
class="ec-lmbx-10">readRVA</span></a><span 
class="ec-lmbx-10">(uint32_t rva, void </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">buf, size_t bufsize)</span>
<a 
 id="x1-65001r76"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.13. </span> <a 
 id="x1-6600013"></a>Scan control functions</h4>
<!--l. 54--><p class="noindent" ><a 
 id="scanc"></a> <a 
 id="scanc__scanc000003"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_ad7ea886d4274f1f389acf0d5cdc50b7d"><span 
class="ec-lmbx-10">bytecode_rt_error</span></a><span 
class="ec-lmbx-10">(int32_t locationid)</span>
<!--l. 9--><p class="noindent" ><a 
 id="scanc__scanc000002"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_aed98502eb13f9e2209d9c6b1620eb17a"><span 
class="ec-lmbx-10">extract_new</span></a><span 
class="ec-lmbx-10">(int32_t id)</span>
<!--l. 16--><p class="noindent" ><a 
 id="scanc__scanc000004"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a0f6e898d3a55355835fccb1f6d15abc1"><span 
class="ec-lmbx-10">extract_set_container</span></a><span 
class="ec-lmbx-10">(uint32_t container)</span>
<!--l. 23--><p class="noindent" ><a 
 id="scanc__scanc000006"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a95f6c4104903cf54fead01646fd7f9d2"><span 
class="ec-lmbx-10">foundVirus</span></a><span 
class="ec-lmbx-10">(const char </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">virusname)</span>
<!--l. 30--><p class="noindent" ><a 
 id="scanc__scanc000005"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a86179c9beb10be3f66cb5cae9902fec3"><span 
class="ec-lmbx-10">input_switch</span></a><span 
class="ec-lmbx-10">(int32_t extracted_file)</span>
<!--l. 37--><p class="noindent" ><a 
 id="scanc__scanc000001"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a77cd19560715e7a2f658fc3ac519d18e"><span 
class="ec-lmbx-10">setvirusname</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">name, uint32_t len)</span>
<a 
 id="x1-66001r77"></a>
<h4 class="subsectionHead"><span class="titlemark">7.1.14. </span> <a 
 id="x1-6700014"></a>String operations</h4>
<!--l. 58--><p class="noindent" ><a 
 id="stringops"></a> <a 
 id="stringops__stringops000005"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_aa07799442f1560666449446eac438ee4"><span 
class="ec-lmbx-10">atoi</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">str, int32_t size)</span>
<!--l. 9--><p class="noindent" ><a 
 id="stringops__stringops000001"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_aa6d82179ea15d32450fefbc6d1bd8934"><span 
class="ec-lmbx-10">debug_print_str</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">str, uint32_t len)</span>
<!--l. 16--><p class="noindent" ><a 
 id="stringops__stringops000007"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a02f173e084fc9a4b9eaf3017aa4243ba"><span 
class="ec-lmbx-10">debug_print_str_nonl</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">str, uint32_t len)</span>
                                                                                

                                                                                
<!--l. 23--><p class="noindent" ><a 
 id="stringops__stringops000006"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a43707290a22915315c960422a88ba4d4"><span 
class="ec-lmbx-10">debug_print_str_start</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">str, uint32_t len)</span>
<!--l. 30--><p class="noindent" ><a 
 id="stringops__stringops000002"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a6e0cdd4d4c76ed46a8627bee56eee1c1"><span 
class="ec-lmbx-10">debug_print_uint</span></a><span 
class="ec-lmbx-10">(uint32_t a)</span>
<!--l. 37--><p class="noindent" ><a 
 id="stringops__stringops000008"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a2df1f1f4823085b4956f1bce3f5b059c"><span 
class="ec-lmbx-10">entropy_buffer</span></a><span 
class="ec-lmbx-10">(uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">buffer, int32_t size)</span>
<!--l. 44--><p class="noindent" ><a 
 id="stringops__stringops000004"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a231265b2ef73573c38d51a385697ae57"><span 
class="ec-lmbx-10">hex2ui</span></a><span 
class="ec-lmbx-10">(uint32_t hex1, uint32_t hex2)</span>
<!--l. 51--><p class="noindent" ><a 
 id="stringops__stringops000009"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a2a215ee7d930373a5df739a91ffdc10f"><span 
class="ec-lmbx-10">memchr</span></a><span 
class="ec-lmbx-10">(const void </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">s, int c, size_t n)</span>
<!--l. 58--><p class="noindent" ><a 
 id="stringops__stringops000013"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a275fa6d98ae5fb2c574d7b4cfdf0ec6c"><span 
class="ec-lmbx-10">memcmp</span></a><span 
class="ec-lmbx-10">(const void </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">s1, const void </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">s2, uint32_t n) __attribute__((__nothrow__)) __attribute__((__pure__)) __attribute__((__nonnull__(1</span>
<!--l. 65--><p class="noindent" ><a 
 id="stringops__stringops000012"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_ac230c6c8d1f7ec41aed26b482001523c"><span 
class="ec-lmbx-10">memcpy</span></a><span 
class="ec-lmbx-10">(void </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">restrict dst, const void </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">restrict src, uintptr_t n) __attribute__((__nothrow__)) __attribute__((__nonnull__(1</span>
<!--l. 72--><p class="noindent" ><a 
 id="stringops__stringops000011"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a39f394f696d30ad1fe11cf7855d33427"><span 
class="ec-lmbx-10">memmove</span></a><span 
class="ec-lmbx-10">(void </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">dst, const void </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">src, uintptr_t n) __attribute__((__nothrow__)) __attribute__((__nonnull__(1</span>
<!--l. 79--><p class="noindent" ><a 
 id="stringops__stringops000010"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__local_8h_a9877bb88a253a26e4dbbeeff654475a7"><span 
class="ec-lmbx-10">memset</span></a><span 
class="ec-lmbx-10">(void </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">src, int c, uintptr_t n) __attribute__((nothrow)) __attribute__((__nonnull__((1))))</span>
<!--l. 86--><p class="noindent" ><a 
 id="stringops__stringops000003"></a>
<span 
class="ec-lmbx-10">Global </span><a 
href="#bytecode__api_8h_a5d46e3fbbec8277f894d998a9b0dfdbc"><span 
class="ec-lmbx-10">memstr</span></a><span 
class="ec-lmbx-10">(const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">haystack, int32_t haysize, const uint8_t </span><span 
class="lmsy-10">&lowast;</span><span 
class="ec-lmbx-10">needle, int32_t needlesize)</span>
<a 
 id="x1-67001r64"></a>
<h3 class="sectionHead"><span class="titlemark">7.2. </span> <a 
 id="x1-680002"></a>Structure types</h3>
<!--l. 4--><p class="noindent" ><a 
 id="structcli__exe__info">
<a 
 id="x1-68001r78"></a>
                                                                                

                                                                                
<h4 class="subsectionHead"><span class="titlemark">7.2.1. </span> <a 
 id="x1-690001"></a>cli_exe_info Struct Reference</h4>
<!--l. 4--><p class="noindent" ></a> <a 
 id="Q1-1-81"></a>
<h5 class="likesubsubsectionHead"><a 
 id="x1-700001"></a>Data Fields</h5>
     <ul class="itemize1">
     <li class="itemize">struct <a 
href="#structcli__exe__section">cli_exe_section</a> <span 
class="lmsy-10">&lowast; </span><a 
href="#structcli__exe__info_a1c449c2a02971006b72d8ab755684716">section</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__exe__info_a894bdfa2d603d8343f8ef01dda6fcd23">offset</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__exe__info_afaed4671662028c061ab84eefcce0546">ep</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structcli__exe__info_aa4af5e526457df524fc9a4ba46803a70">nsections</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__exe__info_ac0f1b36bb8a1eeb981958dc4643f67dd">res_addr</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__exe__info_af2492dd421362ffced98eb583964b310">hdr_size</a></li></ul>
<a 
 id="x1-70001r1"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.1.1. </span> <a 
 id="x1-710001"></a>Detailed Description</h5>
<!--l. 23--><p class="noindent" >Executable file information
    <dl class="list1"><dt class="list">
<a 
href="#pe__pe000004"><span 
class="ec-lmbx-10">PE</span></a>
    </dt><dd 
class="list">
    <!--l. 24--><p class="noindent" ></dd></dl>
<a 
 id="x1-71001r83"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.1.2. </span> <a 
 id="x1-720002"></a>Field Documentation</h5>
<!--l. 31--><p class="noindent" ><a 
 id="structcli__exe__info_afaed4671662028c061ab84eefcce0546">
<!--l. 31--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-730007.2.1.2.1"></a><span 
class="ec-lmbx-10">uint32_t ep</span></span>
</a> Entrypoint of executable <a 
 id="structcli__exe__info_af2492dd421362ffced98eb583964b310">
<!--l. 36--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-740007.2.1.2.2"></a><span 
class="ec-lmbx-10">uint32_t hdr_size</span></span>
</a> Address size - PE ONLY <a 
 id="structcli__exe__info_aa4af5e526457df524fc9a4ba46803a70">
<!--l. 41--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-750007.2.1.2.3"></a><span 
class="ec-lmbx-10">uint16_t nsections</span></span>
</a> Number of sections <a 
 id="structcli__exe__info_a894bdfa2d603d8343f8ef01dda6fcd23">
<!--l. 46--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-760007.2.1.2.4"></a><span 
class="ec-lmbx-10">uint32_t offset</span></span>
</a> Offset where this executable start in file (nonzero if embedded) <a 
 id="structcli__exe__info_ac0f1b36bb8a1eeb981958dc4643f67dd">
<!--l. 51--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-770007.2.1.2.5"></a><span 
class="ec-lmbx-10">uint32_t res_addr</span></span>
</a> Resrources RVA - PE ONLY <a 
 id="structcli__exe__info_a1c449c2a02971006b72d8ab755684716">
<!--l. 56--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-780007.2.1.2.6"></a><span 
class="ec-lmbx-10">struct cli_exe_section</span><span 
class="lmsy-10">&lowast; </span><span 
class="ec-lmbx-10">section</span></span>
</a> Information about all the sections of this file. This array has <span 
class="ec-lmtt-10">nsection </span>elements  <a 
 id="structcli__exe__section">
<a 
 id="x1-78001r80"></a>
                                                                                

                                                                                
<h4 class="subsectionHead"><span class="titlemark">7.2.2. </span> <a 
 id="x1-790002"></a>cli_exe_section Struct Reference</h4>
 </a> <a 
 id="Q1-1-92"></a>
<h5 class="likesubsubsectionHead"><a 
 id="x1-800002"></a>Data Fields</h5>
     <ul class="itemize1">
     <li class="itemize">uint32_t <a 
href="#structcli__exe__section_a428af6b898632e49e1a78a6b75c35597">rva</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__exe__section_a4e9a2c96ba84fd9dedbed61c9865cbc7">vsz</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__exe__section_a0a595268561edc58e347ca8387000bc6">raw</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__exe__section_a9d1a35dea930f9ddac78908ca3dce76b">rsz</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__exe__section_a0737a11eee3c5a5d691fade6df9f5094">chr</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__exe__section_a932862bb5ce030d0e6f007068e7817d6">urva</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__exe__section_a4241ef43b0b01fea785fe76ba7054a37">uvsz</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__exe__section_a1c392d2998c0846b21909814e4706a1e">uraw</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__exe__section_a69f4a0067dad89980f815b5704f5f8da">ursz</a></li></ul>
<a 
 id="x1-80001r84"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.2.1. </span> <a 
 id="x1-810001"></a>Detailed Description</h5>
<!--l. 29--><p class="noindent" >Section of executable file.
    <dl class="list1"><dt class="list">
<a 
href="#pe__pe000003"><span 
class="ec-lmbx-10">PE</span></a>
    </dt><dd 
class="list">
    <!--l. 30--><p class="noindent" ></dd></dl>
<a 
 id="x1-81001r94"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.2.2. </span> <a 
 id="x1-820002"></a>Field Documentation</h5>
<!--l. 37--><p class="noindent" ><a 
 id="structcli__exe__section_a0737a11eee3c5a5d691fade6df9f5094">
<!--l. 37--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-830007.2.2.2.1"></a><span 
class="ec-lmbx-10">uint32_t chr</span></span>
</a> Section characteristics <a 
 id="structcli__exe__section_a0a595268561edc58e347ca8387000bc6">
<!--l. 42--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-840007.2.2.2.2"></a><span 
class="ec-lmbx-10">uint32_t raw</span></span>
</a> Raw offset (in file) <a 
 id="structcli__exe__section_a9d1a35dea930f9ddac78908ca3dce76b">
<!--l. 47--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-850007.2.2.2.3"></a><span 
class="ec-lmbx-10">uint32_t rsz</span></span>
</a> Raw size (in file) <a 
 id="structcli__exe__section_a428af6b898632e49e1a78a6b75c35597">
<!--l. 52--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-860007.2.2.2.4"></a><span 
class="ec-lmbx-10">uint32_t rva</span></span>
</a> Relative VirtualAddress <a 
 id="structcli__exe__section_a1c392d2998c0846b21909814e4706a1e">
                                                                                

                                                                                
<!--l. 57--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-870007.2.2.2.5"></a><span 
class="ec-lmbx-10">uint32_t uraw</span></span>
</a> PE - unaligned PointerToRawData <a 
 id="structcli__exe__section_a69f4a0067dad89980f815b5704f5f8da">
<!--l. 62--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-880007.2.2.2.6"></a><span 
class="ec-lmbx-10">uint32_t ursz</span></span>
</a> PE - unaligned SizeOfRawData <a 
 id="structcli__exe__section_a932862bb5ce030d0e6f007068e7817d6">
<!--l. 67--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-890007.2.2.2.7"></a><span 
class="ec-lmbx-10">uint32_t urva</span></span>
</a> PE - unaligned VirtualAddress <a 
 id="structcli__exe__section_a4241ef43b0b01fea785fe76ba7054a37">
<!--l. 72--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-900007.2.2.2.8"></a><span 
class="ec-lmbx-10">uint32_t uvsz</span></span>
</a> PE - unaligned VirtualSize <a 
 id="structcli__exe__section_a4e9a2c96ba84fd9dedbed61c9865cbc7">
<!--l. 77--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-910007.2.2.2.9"></a><span 
class="ec-lmbx-10">uint32_t vsz</span></span>
</a> VirtualSize  <a 
 id="structcli__pe__hook__data">
<a 
 id="x1-91001r91"></a>
<h4 class="subsectionHead"><span class="titlemark">7.2.3. </span> <a 
 id="x1-920003"></a>cli_pe_hook_data Struct Reference</h4>
 </a> <a 
 id="Q1-1-106"></a>
<h5 class="likesubsubsectionHead"><a 
 id="x1-930003"></a>Data Fields</h5>
     <ul class="itemize1">
     <li class="itemize">uint32_t <a 
href="#structcli__pe__hook__data_afaed4671662028c061ab84eefcce0546">ep</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structcli__pe__hook__data_aa4af5e526457df524fc9a4ba46803a70">nsections</a>
     </li>
     <li class="itemize">struct <a 
href="#structpe__image__file__hdr">pe_image_file_hdr</a> <a 
href="#structcli__pe__hook__data_a3b996731cad79e0040fc0e4613d20533">file_hdr</a>
     </li>
     <li class="itemize">struct <a 
href="#structpe__image__optional__hdr32">pe_image_optional_hdr32</a> <a 
href="#structcli__pe__hook__data_a5c990dffd52525141865f02731eadf68">opt32</a>
     </li>
     <li class="itemize">struct <a 
href="#structpe__image__optional__hdr64">pe_image_optional_hdr64</a> <a 
href="#structcli__pe__hook__data_ae7195772fb9257482b56b5a65114a479">opt64</a>
     </li>
     <li class="itemize">struct <a 
href="#structpe__image__data__dir">pe_image_data_dir</a> <a 
href="#structcli__pe__hook__data_aacc309d29c73dbd6ac72ee719e331097">dirs</a> [16]
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__pe__hook__data_a3d0539adcc53a30b31c2a18bc8b84e00">e_lfanew</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__pe__hook__data_af169b0060e4ed3e78fd7ef2588aa7ef6">overlays</a>
     </li>
     <li class="itemize">int32_t <a 
href="#structcli__pe__hook__data_aed2bc0e93b8e8e291987fc1a2ef801d1">overlays_sz</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structcli__pe__hook__data_af2492dd421362ffced98eb583964b310">hdr_size</a></li></ul>
<a 
 id="x1-93001r95"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.3.1. </span> <a 
 id="x1-940001"></a>Detailed Description</h5>
<!--l. 31--><p class="noindent" >Data for the bytecode PE hook
                                                                                

                                                                                
    <dl class="list1"><dt class="list">
<a 
href="#pe__pe000059"><span 
class="ec-lmbx-10">PE</span></a>
    </dt><dd 
class="list">
    <!--l. 32--><p class="noindent" ></dd></dl>
<a 
 id="x1-94001r108"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.3.2. </span> <a 
 id="x1-950002"></a>Field Documentation</h5>
<!--l. 39--><p class="noindent" ><a 
 id="structcli__pe__hook__data_aacc309d29c73dbd6ac72ee719e331097">
<!--l. 39--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-960007.2.3.2.1"></a><span 
class="ec-lmbx-10">struct pe_image_data_dir dirs</span><span 
class="ec-lmbx-10">[</span><span 
class="ec-lmbx-10">16</span><span 
class="ec-lmbx-10">]</span></span>
</a> PE data directory header <a 
 id="structcli__pe__hook__data_a3d0539adcc53a30b31c2a18bc8b84e00">
<!--l. 44--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-970007.2.3.2.2"></a><span 
class="ec-lmbx-10">uint32_t e_lfanew</span></span>
</a> address of new exe header <a 
 id="structcli__pe__hook__data_afaed4671662028c061ab84eefcce0546">
<!--l. 49--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-980007.2.3.2.3"></a><span 
class="ec-lmbx-10">uint32_t ep</span></span>
</a> EntryPoint as file offset <a 
 id="structcli__pe__hook__data_a3b996731cad79e0040fc0e4613d20533">
<!--l. 54--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-990007.2.3.2.4"></a><span 
class="ec-lmbx-10">struct pe_image_file_hdr file_hdr</span></span>
</a> Header for this PE file <a 
 id="structcli__pe__hook__data_af2492dd421362ffced98eb583964b310">
<!--l. 59--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1000007.2.3.2.5"></a><span 
class="ec-lmbx-10">uint32_t hdr_size</span></span>
</a> internally needed by rawaddr <a 
 id="structcli__pe__hook__data_aa4af5e526457df524fc9a4ba46803a70">
<!--l. 64--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1010007.2.3.2.6"></a><span 
class="ec-lmbx-10">uint16_t nsections</span></span>
</a> Number of sections <a 
 id="structcli__pe__hook__data_a5c990dffd52525141865f02731eadf68">
<!--l. 69--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1020007.2.3.2.7"></a><span 
class="ec-lmbx-10">struct pe_image_optional_hdr32 opt32</span></span>
</a> 32-bit PE optional header <a 
 id="structcli__pe__hook__data_ae7195772fb9257482b56b5a65114a479">
<!--l. 74--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1030007.2.3.2.8"></a><span 
class="ec-lmbx-10">struct pe_image_optional_hdr64 opt64</span></span>
</a> 64-bit PE optional header <a 
 id="structcli__pe__hook__data_af169b0060e4ed3e78fd7ef2588aa7ef6">
<!--l. 79--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1040007.2.3.2.9"></a><span 
class="ec-lmbx-10">uint32_t overlays</span></span>
</a> number of overlays <a 
 id="structcli__pe__hook__data_aed2bc0e93b8e8e291987fc1a2ef801d1">
<!--l. 84--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1050007.2.3.2.10"></a><span 
class="ec-lmbx-10">int32_t overlays_sz</span></span>
</a> size of overlays  <a 
 id="struct_d_i_s__arg">
<a 
 id="x1-105001r105"></a>
<h4 class="subsectionHead"><span class="titlemark">7.2.4. </span> <a 
 id="x1-1060004"></a>DIS_arg Struct Reference</h4>
 </a> <a 
 id="Q1-1-121"></a>
                                                                                

                                                                                
<h5 class="likesubsubsectionHead"><a 
 id="x1-1070004"></a>Data Fields</h5>
     <ul class="itemize1">
     <li class="itemize">enum <a 
href="#bytecode__disasm_8h_a3dcc05be268362b3f772b1675e0a882c">DIS_ACCESS</a> <a 
href="#struct_d_i_s__arg_a5a7d33b48f73c1d560377f10471d8b00">access_type</a>
     </li>
     <li class="itemize">enum <a 
href="#bytecode__disasm_8h_a6a0d419b6b61630b1f76a25ff39df84d">DIS_SIZE</a> <a 
href="#struct_d_i_s__arg_abe85ed51a3596cdb3a868a284c3d961f">access_size</a>
     </li>
     <li class="itemize">struct <a 
href="#struct_d_i_s__mem__arg">DIS_mem_arg</a> <a 
href="#struct_d_i_s__arg_a883edefb091b4875ffd7bb1f1e61dea3">mem</a>
     </li>
     <li class="itemize">enum <a 
href="#bytecode__disasm_8h_a87af2e927a80478796188d9d8d813d82">X86REGS</a> <a 
href="#struct_d_i_s__arg_a426daf7e6de8cea3128731107457d2cf">reg</a>
     </li>
     <li class="itemize">uint64_t <a 
href="#struct_d_i_s__arg_aabf8b24bd58cc13ea953e9add24d4387">other</a></li></ul>
<a 
 id="x1-107001r109"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.4.1. </span> <a 
 id="x1-1080001"></a>Detailed Description</h5>
<!--l. 21--><p class="noindent" >disassembled operand
    <dl class="list1"><dt class="list">
<a 
href="#disasm__disasm000003"><span 
class="ec-lmbx-10">Disassemble</span></a>
    </dt><dd 
class="list">
    <!--l. 22--><p class="noindent" ></dd></dl>
<a 
 id="x1-108001r123"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.4.2. </span> <a 
 id="x1-1090002"></a>Field Documentation</h5>
<!--l. 29--><p class="noindent" ><a 
 id="struct_d_i_s__arg_abe85ed51a3596cdb3a868a284c3d961f">
<!--l. 29--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1100007.2.4.2.1"></a><span 
class="ec-lmbx-10">enum DIS_SIZE access_size</span></span>
</a> size of access <a 
 id="struct_d_i_s__arg_a5a7d33b48f73c1d560377f10471d8b00">
<!--l. 34--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1110007.2.4.2.2"></a><span 
class="ec-lmbx-10">enum DIS_ACCESS access_type</span></span>
</a> type of access <a 
 id="struct_d_i_s__arg_a883edefb091b4875ffd7bb1f1e61dea3">
<!--l. 39--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1120007.2.4.2.3"></a><span 
class="ec-lmbx-10">struct DIS_mem_arg mem</span></span>
</a> memory operand <a 
 id="struct_d_i_s__arg_aabf8b24bd58cc13ea953e9add24d4387">
<!--l. 44--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1130007.2.4.2.4"></a><span 
class="ec-lmbx-10">uint64_t other</span></span>
</a> other operand <a 
 id="struct_d_i_s__arg_a426daf7e6de8cea3128731107457d2cf">
<!--l. 49--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1140007.2.4.2.5"></a><span 
class="ec-lmbx-10">enum X86REGS reg</span></span>
</a> register operand  <a 
 id="struct_d_i_s__fixed">
<a 
 id="x1-114001r120"></a>
<h4 class="subsectionHead"><span class="titlemark">7.2.5. </span> <a 
 id="x1-1150005"></a>DIS_fixed Struct Reference</h4>
 </a> <a 
 id="Q1-1-131"></a>
                                                                                

                                                                                
<h5 class="likesubsubsectionHead"><a 
 id="x1-1160005"></a>Data Fields</h5>
     <ul class="itemize1">
     <li class="itemize">enum <a 
href="#bytecode__disasm_8h_a6bf8b2b4d6261f0e88170a7d0585a5e2">X86OPS</a> <a 
href="#struct_d_i_s__fixed_a372354efff5b025dc9324a03625338a2">x86_opcode</a>
     </li>
     <li class="itemize">enum <a 
href="#bytecode__disasm_8h_a6a0d419b6b61630b1f76a25ff39df84d">DIS_SIZE</a> <a 
href="#struct_d_i_s__fixed_a1a17e54c88513da8e5b1175a785c51ae">operation_size</a>
     </li>
     <li class="itemize">enum <a 
href="#bytecode__disasm_8h_a6a0d419b6b61630b1f76a25ff39df84d">DIS_SIZE</a> <a 
href="#struct_d_i_s__fixed_a772bedb1977f1ae07b9f55991f318bd8">address_size</a>
     </li>
     <li class="itemize">uint8_t <a 
href="#struct_d_i_s__fixed_afbf231e07d12db4d0ebf0bc223679ae5">segment</a></li></ul>
<a 
 id="x1-116001r124"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.5.1. </span> <a 
 id="x1-1170001"></a>Detailed Description</h5>
<!--l. 19--><p class="noindent" >disassembled instruction.
    <dl class="list1"><dt class="list">
<a 
href="#disasm__disasm000004"><span 
class="ec-lmbx-10">Disassemble</span></a>
    </dt><dd 
class="list">
    <!--l. 20--><p class="noindent" ></dd></dl>
<a 
 id="x1-117001r133"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.5.2. </span> <a 
 id="x1-1180002"></a>Field Documentation</h5>
<!--l. 27--><p class="noindent" ><a 
 id="struct_d_i_s__fixed_a772bedb1977f1ae07b9f55991f318bd8">
<!--l. 27--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1190007.2.5.2.1"></a><span 
class="ec-lmbx-10">enum DIS_SIZE address_size</span></span>
</a> size of address <a 
 id="struct_d_i_s__fixed_a1a17e54c88513da8e5b1175a785c51ae">
<!--l. 32--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1200007.2.5.2.2"></a><span 
class="ec-lmbx-10">enum DIS_SIZE operation_size</span></span>
</a> size of operation <a 
 id="struct_d_i_s__fixed_afbf231e07d12db4d0ebf0bc223679ae5">
<!--l. 37--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1210007.2.5.2.3"></a><span 
class="ec-lmbx-10">uint8_t segment</span></span>
</a> segment <a 
 id="struct_d_i_s__fixed_a372354efff5b025dc9324a03625338a2">
<!--l. 42--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1220007.2.5.2.4"></a><span 
class="ec-lmbx-10">enum X86OPS x86_opcode</span></span>
</a> opcode of X86 instruction  <a 
 id="struct_d_i_s__mem__arg">
<a 
 id="x1-122001r130"></a>
<h4 class="subsectionHead"><span class="titlemark">7.2.6. </span> <a 
 id="x1-1230006"></a>DIS_mem_arg Struct Reference</h4>
 </a> <a 
 id="Q1-1-140"></a>
<h5 class="likesubsubsectionHead"><a 
 id="x1-1240006"></a>Data Fields</h5>
     <ul class="itemize1">
     <li class="itemize">enum <a 
href="#bytecode__disasm_8h_a6a0d419b6b61630b1f76a25ff39df84d">DIS_SIZE</a> <a 
href="#struct_d_i_s__mem__arg_abe85ed51a3596cdb3a868a284c3d961f">access_size</a>
     </li>
     <li class="itemize">enum <a 
href="#bytecode__disasm_8h_a87af2e927a80478796188d9d8d813d82">X86REGS</a> <a 
href="#struct_d_i_s__mem__arg_afb3d2d6aee6f877fd62b8ffc576d9351">scale_reg</a>
     </li>
     <li class="itemize">enum <a 
href="#bytecode__disasm_8h_a87af2e927a80478796188d9d8d813d82">X86REGS</a> <a 
href="#struct_d_i_s__mem__arg_abdbd08c3d265ff494ad5ff1006cc6a73">add_reg</a>
                                                                                

                                                                                
     </li>
     <li class="itemize">uint8_t <a 
href="#struct_d_i_s__mem__arg_a616c0a72f0e4af38b93c736773ac7210">scale</a>
     </li>
     <li class="itemize">int32_t <a 
href="#struct_d_i_s__mem__arg_a241d2c58aca95f8589148d4acf97406d">displacement</a></li></ul>
<a 
 id="x1-124001r134"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.6.1. </span> <a 
 id="x1-1250001"></a>Detailed Description</h5>
<!--l. 21--><p class="noindent" >disassembled memory operand: scale_reg<span 
class="lmsy-10">&lowast;</span>scale + add_reg + displacement
    <dl class="list1"><dt class="list">
<a 
href="#disasm__disasm000002"><span 
class="ec-lmbx-10">Disassemble</span></a>
    </dt><dd 
class="list">
    <!--l. 22--><p class="noindent" ></dd></dl>
<a 
 id="x1-125001r142"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.6.2. </span> <a 
 id="x1-1260002"></a>Field Documentation</h5>
<!--l. 29--><p class="noindent" ><a 
 id="struct_d_i_s__mem__arg_abe85ed51a3596cdb3a868a284c3d961f">
<!--l. 29--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1270007.2.6.2.1"></a><span 
class="ec-lmbx-10">enum DIS_SIZE access_size</span></span>
</a> size of access <a 
 id="struct_d_i_s__mem__arg_abdbd08c3d265ff494ad5ff1006cc6a73">
<!--l. 34--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1280007.2.6.2.2"></a><span 
class="ec-lmbx-10">enum X86REGS add_reg</span></span>
</a> register used as displacemenet <a 
 id="struct_d_i_s__mem__arg_a241d2c58aca95f8589148d4acf97406d">
<!--l. 39--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1290007.2.6.2.3"></a><span 
class="ec-lmbx-10">int32_t displacement</span></span>
</a> displacement as immediate number <a 
 id="struct_d_i_s__mem__arg_a616c0a72f0e4af38b93c736773ac7210">
<!--l. 44--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1300007.2.6.2.4"></a><span 
class="ec-lmbx-10">uint8_t scale</span></span>
</a> scale as immediate number <a 
 id="struct_d_i_s__mem__arg_afb3d2d6aee6f877fd62b8ffc576d9351">
<!--l. 49--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1310007.2.6.2.5"></a><span 
class="ec-lmbx-10">enum X86REGS scale_reg</span></span>
</a> register used as scale  <a 
 id="struct_d_i_s_a_s_m___r_e_s_u_l_t">
<a 
 id="x1-131001r139"></a>
<h4 class="subsectionHead"><span class="titlemark">7.2.7. </span> <a 
 id="x1-1320007"></a>DISASM_RESULT Struct Reference</h4>
 </a>
<a 
 id="x1-132001r143"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.7.1. </span> <a 
 id="x1-1330001"></a>Detailed Description</h5>
<!--l. 8--><p class="noindent" >disassembly result, 64-byte, matched by type-8 signatures  <a 
 id="structpe__image__data__dir">
<a 
 id="x1-133001r149"></a>
<h4 class="subsectionHead"><span class="titlemark">7.2.8. </span> <a 
 id="x1-1340008"></a>pe_image_data_dir Struct Reference</h4>
<!--l. 4--><p class="noindent" ></a>
<a 
 id="x1-134001r150"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.8.1. </span> <a 
 id="x1-1350001"></a>Detailed Description</h5>
<!--l. 8--><p class="noindent" >PE data directory header
                                                                                

                                                                                
    <dl class="list1"><dt class="list">
<a 
href="#pe__pe000055"><span 
class="ec-lmbx-10">PE</span></a>
    </dt><dd 
class="list">
    <!--l. 9--><p class="noindent" ></dd></dl>
<!--l. 4--><p class="noindent" ><a 
 id="structpe__image__file__hdr">
<a 
 id="x1-135001r151"></a>
<h4 class="subsectionHead"><span class="titlemark">7.2.9. </span> <a 
 id="x1-1360009"></a>pe_image_file_hdr Struct Reference</h4>
<!--l. 4--><p class="noindent" ></a> <a 
 id="Q1-1-154"></a>
<h5 class="likesubsubsectionHead"><a 
 id="x1-1370009"></a>Data Fields</h5>
     <ul class="itemize1">
     <li class="itemize">uint32_t <a 
href="#structpe__image__file__hdr_aacdf4d16fc118936413e1bfe23b9e444">Magic</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structpe__image__file__hdr_a51d503029c67ea2862fe31a71cd4212d">Machine</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structpe__image__file__hdr_aad0798860a6f2bc09b927345db02e074">NumberOfSections</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__file__hdr_ac83cc1a91ccb0a2a67bab786974b7cb0">TimeDateStamp</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__file__hdr_a6d4bc2ab7b55577dd6f5491a8b21ef97">PointerToSymbolTable</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__file__hdr_a4dbc3cb95c8f5dfe95a9c7d346db9844">NumberOfSymbols</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structpe__image__file__hdr_a4333c57f9c44ac4ca60e99b04dbed87d">SizeOfOptionalHeader</a></li></ul>
<a 
 id="x1-137001r152"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.9.1. </span> <a 
 id="x1-1380001"></a>Detailed Description</h5>
<!--l. 25--><p class="noindent" >Header for this PE file
    <dl class="list1"><dt class="list">
<a 
href="#pe__pe000054"><span 
class="ec-lmbx-10">PE</span></a>
    </dt><dd 
class="list">
    <!--l. 26--><p class="noindent" ></dd></dl>
<a 
 id="x1-138001r156"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.9.2. </span> <a 
 id="x1-1390002"></a>Field Documentation</h5>
<!--l. 33--><p class="noindent" ><a 
 id="structpe__image__file__hdr_a51d503029c67ea2862fe31a71cd4212d">
<!--l. 33--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1400007.2.9.2.1"></a><span 
class="ec-lmbx-10">uint16_t Machine</span></span>
</a> CPU this executable runs on, see libclamav/pe.c for possible values <a 
 id="structpe__image__file__hdr_aacdf4d16fc118936413e1bfe23b9e444">
<!--l. 38--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1410007.2.9.2.2"></a><span 
class="ec-lmbx-10">uint32_t Magic</span></span>
</a> PE magic header: PE<span 
class="lmsy-10">\</span>0<span 
class="lmsy-10">\</span>0 <a 
 id="structpe__image__file__hdr_aad0798860a6f2bc09b927345db02e074">
<!--l. 43--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1420007.2.9.2.3"></a><span 
class="ec-lmbx-10">uint16_t NumberOfSections</span></span>
</a> Number of sections in this executable <a 
 id="structpe__image__file__hdr_a4dbc3cb95c8f5dfe95a9c7d346db9844">
                                                                                

                                                                                
<!--l. 48--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1430007.2.9.2.4"></a><span 
class="ec-lmbx-10">uint32_t NumberOfSymbols</span></span>
</a> debug <a 
 id="structpe__image__file__hdr_a6d4bc2ab7b55577dd6f5491a8b21ef97">
<!--l. 53--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1440007.2.9.2.5"></a><span 
class="ec-lmbx-10">uint32_t PointerToSymbolTable</span></span>
</a> debug <a 
 id="structpe__image__file__hdr_a4333c57f9c44ac4ca60e99b04dbed87d">
<!--l. 58--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1450007.2.9.2.6"></a><span 
class="ec-lmbx-10">uint16_t SizeOfOptionalHeader</span></span>
</a> == 224 <a 
 id="structpe__image__file__hdr_ac83cc1a91ccb0a2a67bab786974b7cb0">
<!--l. 63--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1460007.2.9.2.7"></a><span 
class="ec-lmbx-10">uint32_t TimeDateStamp</span></span>
</a> Unreliable  <a 
 id="structpe__image__optional__hdr32">
<a 
 id="x1-146001r153"></a>
<h4 class="subsectionHead"><span class="titlemark">7.2.10. </span> <a 
 id="x1-14700010"></a>pe_image_optional_hdr32 Struct Reference</h4>
 </a> <a 
 id="Q1-1-166"></a>
<h5 class="likesubsubsectionHead"><a 
 id="x1-14800010"></a>Data Fields</h5>
     <ul class="itemize1">
     <li class="itemize">uint8_t <a 
href="#structpe__image__optional__hdr32_a9fe20c528b23d8a85a250c33c761b840">MajorLinkerVersion</a>
     </li>
     <li class="itemize">uint8_t <a 
href="#structpe__image__optional__hdr32_a0cc5019694053488b343a458fbc0b657">MinorLinkerVersion</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr32_abee9ed2d772fb9bec9f70e22d8f85c23">SizeOfCode</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr32_a042c05a92b0c90acf2e1ee4672857153">SizeOfInitializedData</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr32_aa82afa1757a8a7b76df97b35b4afea84">SizeOfUninitializedData</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr32_a29eb1ba379985eaa71d0c25142f90b50">ImageBase</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr32_ae19363fc9558f4fe8d710789d031f9ac">SectionAlignment</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr32_a52c4f3c684bea4212e4fb8289794eb0d">FileAlignment</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structpe__image__optional__hdr32_a47b3939102eef106f0fc4d6a96c3ad14">MajorOperatingSystemVersion</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structpe__image__optional__hdr32_a8eb1d37329b3c54e63e8eb7832e30ba7">MinorOperatingSystemVersion</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structpe__image__optional__hdr32_a2902b4670e5eab8fcc2dc47c7fca868b">MajorImageVersion</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structpe__image__optional__hdr32_a7b61bcb8b63930c239079916325ae734">MinorImageVersion</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr32_ab09f6da5ce2f33ac63606127b1bb2760">CheckSum</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr32_a51e6fb2cbc64a53b2bb577f2dd2f677f">NumberOfRvaAndSizes</a></li></ul>
                                                                                

                                                                                
<a 
 id="x1-148001r157"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.10.1. </span> <a 
 id="x1-1490001"></a>Detailed Description</h5>
<!--l. 39--><p class="noindent" >32-bit PE optional header
    <dl class="list1"><dt class="list">
<a 
href="#pe__pe000056"><span 
class="ec-lmbx-10">PE</span></a>
    </dt><dd 
class="list">
    <!--l. 40--><p class="noindent" ></dd></dl>
<a 
 id="x1-149001r168"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.10.2. </span> <a 
 id="x1-1500002"></a>Field Documentation</h5>
<!--l. 47--><p class="noindent" ><a 
 id="structpe__image__optional__hdr32_ab09f6da5ce2f33ac63606127b1bb2760">
<!--l. 47--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1510007.2.10.2.1"></a><span 
class="ec-lmbx-10">uint32_t CheckSum</span></span>
</a> NT drivers only <a 
 id="structpe__image__optional__hdr32_a52c4f3c684bea4212e4fb8289794eb0d">
<!--l. 52--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1520007.2.10.2.2"></a><span 
class="ec-lmbx-10">uint32_t FileAlignment</span></span>
</a> usually 32 or 512 <a 
 id="structpe__image__optional__hdr32_a29eb1ba379985eaa71d0c25142f90b50">
<!--l. 57--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1530007.2.10.2.3"></a><span 
class="ec-lmbx-10">uint32_t ImageBase</span></span>
</a> multiple of 64 KB <a 
 id="structpe__image__optional__hdr32_a2902b4670e5eab8fcc2dc47c7fca868b">
<!--l. 62--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1540007.2.10.2.4"></a><span 
class="ec-lmbx-10">uint16_t MajorImageVersion</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr32_a9fe20c528b23d8a85a250c33c761b840">
<!--l. 67--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1550007.2.10.2.5"></a><span 
class="ec-lmbx-10">uint8_t MajorLinkerVersion</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr32_a47b3939102eef106f0fc4d6a96c3ad14">
<!--l. 72--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1560007.2.10.2.6"></a><span 
class="ec-lmbx-10">uint16_t MajorOperatingSystemVersion</span></span>
</a> not used <a 
 id="structpe__image__optional__hdr32_a7b61bcb8b63930c239079916325ae734">
<!--l. 77--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1570007.2.10.2.7"></a><span 
class="ec-lmbx-10">uint16_t MinorImageVersion</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr32_a0cc5019694053488b343a458fbc0b657">
<!--l. 82--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1580007.2.10.2.8"></a><span 
class="ec-lmbx-10">uint8_t MinorLinkerVersion</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr32_a8eb1d37329b3c54e63e8eb7832e30ba7">
<!--l. 87--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1590007.2.10.2.9"></a><span 
class="ec-lmbx-10">uint16_t MinorOperatingSystemVersion</span></span>
</a> not used <a 
 id="structpe__image__optional__hdr32_a51e6fb2cbc64a53b2bb577f2dd2f677f">
<!--l. 92--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1600007.2.10.2.10"></a><span 
class="ec-lmbx-10">uint32_t NumberOfRvaAndSizes</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr32_ae19363fc9558f4fe8d710789d031f9ac">
<!--l. 97--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1610007.2.10.2.11"></a><span 
class="ec-lmbx-10">uint32_t SectionAlignment</span></span>
</a> usually 32 or 4096 <a 
 id="structpe__image__optional__hdr32_abee9ed2d772fb9bec9f70e22d8f85c23">
                                                                                

                                                                                
<!--l. 102--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1620007.2.10.2.12"></a><span 
class="ec-lmbx-10">uint32_t SizeOfCode</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr32_a042c05a92b0c90acf2e1ee4672857153">
<!--l. 107--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1630007.2.10.2.13"></a><span 
class="ec-lmbx-10">uint32_t SizeOfInitializedData</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr32_aa82afa1757a8a7b76df97b35b4afea84">
<!--l. 112--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1640007.2.10.2.14"></a><span 
class="ec-lmbx-10">uint32_t SizeOfUninitializedData</span></span>
</a> unreliable  <a 
 id="structpe__image__optional__hdr64">
<a 
 id="x1-164001r165"></a>
<h4 class="subsectionHead"><span class="titlemark">7.2.11. </span> <a 
 id="x1-16500011"></a>pe_image_optional_hdr64 Struct Reference</h4>
 </a> <a 
 id="Q1-1-185"></a>
<h5 class="likesubsubsectionHead"><a 
 id="x1-16600011"></a>Data Fields</h5>
     <ul class="itemize1">
     <li class="itemize">uint8_t <a 
href="#structpe__image__optional__hdr64_a9fe20c528b23d8a85a250c33c761b840">MajorLinkerVersion</a>
     </li>
     <li class="itemize">uint8_t <a 
href="#structpe__image__optional__hdr64_a0cc5019694053488b343a458fbc0b657">MinorLinkerVersion</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr64_abee9ed2d772fb9bec9f70e22d8f85c23">SizeOfCode</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr64_a042c05a92b0c90acf2e1ee4672857153">SizeOfInitializedData</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr64_aa82afa1757a8a7b76df97b35b4afea84">SizeOfUninitializedData</a>
     </li>
     <li class="itemize">uint64_t <a 
href="#structpe__image__optional__hdr64_af8df9953c8c190fdb02a4319088284c3">ImageBase</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr64_ae19363fc9558f4fe8d710789d031f9ac">SectionAlignment</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr64_a52c4f3c684bea4212e4fb8289794eb0d">FileAlignment</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structpe__image__optional__hdr64_a47b3939102eef106f0fc4d6a96c3ad14">MajorOperatingSystemVersion</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structpe__image__optional__hdr64_a8eb1d37329b3c54e63e8eb7832e30ba7">MinorOperatingSystemVersion</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structpe__image__optional__hdr64_a2902b4670e5eab8fcc2dc47c7fca868b">MajorImageVersion</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structpe__image__optional__hdr64_a7b61bcb8b63930c239079916325ae734">MinorImageVersion</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr64_ab09f6da5ce2f33ac63606127b1bb2760">CheckSum</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__optional__hdr64_a51e6fb2cbc64a53b2bb577f2dd2f677f">NumberOfRvaAndSizes</a></li></ul>
<a 
 id="x1-166001r169"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.11.1. </span> <a 
 id="x1-1670001"></a>Detailed Description</h5>
<!--l. 39--><p class="noindent" >PE 64-bit optional header
                                                                                

                                                                                
    <dl class="list1"><dt class="list">
<a 
href="#pe__pe000057"><span 
class="ec-lmbx-10">PE</span></a>
    </dt><dd 
class="list">
    <!--l. 40--><p class="noindent" ></dd></dl>
<a 
 id="x1-167001r187"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.11.2. </span> <a 
 id="x1-1680002"></a>Field Documentation</h5>
<!--l. 47--><p class="noindent" ><a 
 id="structpe__image__optional__hdr64_ab09f6da5ce2f33ac63606127b1bb2760">
<!--l. 47--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1690007.2.11.2.1"></a><span 
class="ec-lmbx-10">uint32_t CheckSum</span></span>
</a> NT drivers only <a 
 id="structpe__image__optional__hdr64_a52c4f3c684bea4212e4fb8289794eb0d">
<!--l. 52--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1700007.2.11.2.2"></a><span 
class="ec-lmbx-10">uint32_t FileAlignment</span></span>
</a> usually 32 or 512 <a 
 id="structpe__image__optional__hdr64_af8df9953c8c190fdb02a4319088284c3">
<!--l. 57--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1710007.2.11.2.3"></a><span 
class="ec-lmbx-10">uint64_t ImageBase</span></span>
</a> multiple of 64 KB <a 
 id="structpe__image__optional__hdr64_a2902b4670e5eab8fcc2dc47c7fca868b">
<!--l. 62--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1720007.2.11.2.4"></a><span 
class="ec-lmbx-10">uint16_t MajorImageVersion</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr64_a9fe20c528b23d8a85a250c33c761b840">
<!--l. 67--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1730007.2.11.2.5"></a><span 
class="ec-lmbx-10">uint8_t MajorLinkerVersion</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr64_a47b3939102eef106f0fc4d6a96c3ad14">
<!--l. 72--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1740007.2.11.2.6"></a><span 
class="ec-lmbx-10">uint16_t MajorOperatingSystemVersion</span></span>
</a> not used <a 
 id="structpe__image__optional__hdr64_a7b61bcb8b63930c239079916325ae734">
<!--l. 77--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1750007.2.11.2.7"></a><span 
class="ec-lmbx-10">uint16_t MinorImageVersion</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr64_a0cc5019694053488b343a458fbc0b657">
<!--l. 82--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1760007.2.11.2.8"></a><span 
class="ec-lmbx-10">uint8_t MinorLinkerVersion</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr64_a8eb1d37329b3c54e63e8eb7832e30ba7">
<!--l. 87--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1770007.2.11.2.9"></a><span 
class="ec-lmbx-10">uint16_t MinorOperatingSystemVersion</span></span>
</a> not used <a 
 id="structpe__image__optional__hdr64_a51e6fb2cbc64a53b2bb577f2dd2f677f">
<!--l. 92--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1780007.2.11.2.10"></a><span 
class="ec-lmbx-10">uint32_t NumberOfRvaAndSizes</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr64_ae19363fc9558f4fe8d710789d031f9ac">
<!--l. 97--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1790007.2.11.2.11"></a><span 
class="ec-lmbx-10">uint32_t SectionAlignment</span></span>
</a> usually 32 or 4096 <a 
 id="structpe__image__optional__hdr64_abee9ed2d772fb9bec9f70e22d8f85c23">
<!--l. 102--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1800007.2.11.2.12"></a><span 
class="ec-lmbx-10">uint32_t SizeOfCode</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr64_a042c05a92b0c90acf2e1ee4672857153">
                                                                                

                                                                                
<!--l. 107--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1810007.2.11.2.13"></a><span 
class="ec-lmbx-10">uint32_t SizeOfInitializedData</span></span>
</a> unreliable <a 
 id="structpe__image__optional__hdr64_aa82afa1757a8a7b76df97b35b4afea84">
<!--l. 112--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1820007.2.11.2.14"></a><span 
class="ec-lmbx-10">uint32_t SizeOfUninitializedData</span></span>
</a> unreliable  <a 
 id="structpe__image__section__hdr">
<a 
 id="x1-182001r184"></a>
<h4 class="subsectionHead"><span class="titlemark">7.2.12. </span> <a 
 id="x1-18300012"></a>pe_image_section_hdr Struct Reference</h4>
 </a> <a 
 id="Q1-1-204"></a>
<h5 class="likesubsubsectionHead"><a 
 id="x1-18400012"></a>Data Fields</h5>
     <ul class="itemize1">
     <li class="itemize">uint8_t <a 
href="#structpe__image__section__hdr_a79e9d42a9e6a01c699c484f2cece532a">Name</a> [8]
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__section__hdr_a03c427e0322a24cf373c072103d32cc4">SizeOfRawData</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__section__hdr_a21ccdce4c43b139ed19515ea22df5e8a">PointerToRawData</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__section__hdr_a752b4666b67ff2f4cc18a1ce05387476">PointerToRelocations</a>
     </li>
     <li class="itemize">uint32_t <a 
href="#structpe__image__section__hdr_a1715d816f809a04d4c3d9c916901607d">PointerToLinenumbers</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structpe__image__section__hdr_a36dad90fe664cb9db300c599825302a6">NumberOfRelocations</a>
     </li>
     <li class="itemize">uint16_t <a 
href="#structpe__image__section__hdr_a6d575e60c835602f16da7715ad36d3e7">NumberOfLinenumbers</a></li></ul>
<a 
 id="x1-184001r188"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.12.1. </span> <a 
 id="x1-1850001"></a>Detailed Description</h5>
<!--l. 25--><p class="noindent" >PE section header
    <dl class="list1"><dt class="list">
<a 
href="#pe__pe000058"><span 
class="ec-lmbx-10">PE</span></a>
    </dt><dd 
class="list">
    <!--l. 26--><p class="noindent" ></dd></dl>
<a 
 id="x1-185001r206"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.2.12.2. </span> <a 
 id="x1-1860002"></a>Field Documentation</h5>
<!--l. 33--><p class="noindent" ><a 
 id="structpe__image__section__hdr_a79e9d42a9e6a01c699c484f2cece532a">
<!--l. 33--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1870007.2.12.2.1"></a><span 
class="ec-lmbx-10">uint8_t Name</span><span 
class="ec-lmbx-10">[</span><span 
class="ec-lmbx-10">8</span><span 
class="ec-lmbx-10">]</span></span>
</a> may not end with NULL <a 
 id="structpe__image__section__hdr_a6d575e60c835602f16da7715ad36d3e7">
<!--l. 38--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1880007.2.12.2.2"></a><span 
class="ec-lmbx-10">uint16_t NumberOfLinenumbers</span></span>
</a> object files only <a 
 id="structpe__image__section__hdr_a36dad90fe664cb9db300c599825302a6">
<!--l. 43--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1890007.2.12.2.3"></a><span 
class="ec-lmbx-10">uint16_t NumberOfRelocations</span></span>
</a> object files only <a 
 id="structpe__image__section__hdr_a1715d816f809a04d4c3d9c916901607d">
                                                                                

                                                                                
<!--l. 48--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1900007.2.12.2.4"></a><span 
class="ec-lmbx-10">uint32_t PointerToLinenumbers</span></span>
</a> object files only <a 
 id="structpe__image__section__hdr_a21ccdce4c43b139ed19515ea22df5e8a">
<!--l. 53--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1910007.2.12.2.5"></a><span 
class="ec-lmbx-10">uint32_t PointerToRawData</span></span>
</a> offset to the section&#8217;s data <a 
 id="structpe__image__section__hdr_a752b4666b67ff2f4cc18a1ce05387476">
<!--l. 58--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1920007.2.12.2.6"></a><span 
class="ec-lmbx-10">uint32_t PointerToRelocations</span></span>
</a> object files only <a 
 id="structpe__image__section__hdr_a03c427e0322a24cf373c072103d32cc4">
<!--l. 63--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-1930007.2.12.2.7"></a><span 
class="ec-lmbx-10">uint32_t SizeOfRawData</span></span>
</a> multiple of FileAlignment
<a 
 id="x1-193001r79"></a>
<h3 class="sectionHead"><span class="titlemark">7.3. </span> <a 
 id="x1-1940003"></a>Low level API</h3>
&#x00A0;    <a 
 id="bytecode__api_8h">
<a 
 id="x1-194001r203"></a>
<h4 class="subsectionHead"><span class="titlemark">7.3.1. </span> <a 
 id="x1-1950001"></a>bytecode_api.h File Reference</h4>
<!--l. 4--><p class="noindent" ></a> <a 
 id="Q1-1-217"></a>
<h5 class="likesubsubsectionHead"><a 
 id="x1-1960001"></a>Enumerations</h5>
     <ul class="itemize1">
     <li class="itemize">enum <a 
href="#bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91">BytecodeKind</a> { <a 
href="#bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91aff84fbd05d167a1cf9e146d155ac90b7">BC_GENERIC</a> = 0 , <a 
href="#bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91aa6c849ba6dbd80a2af04a38eeea8d5c3">BC_LOGICAL</a> = 256, <a 
href="#bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91ae6b6910f9706526e49807a022b7125f1">BC_PE_UNPACKER</a>
     }
     </li>
     <li class="itemize">enum { <a 
href="#bytecode__api_8h_a06fc87d81c62e9abb8790b6e5713c55bacb5d73f23c5c13bca1ae5fdfbaa22d43">PE_INVALID_RVA</a> = 0xFFFFFFFF }
     </li>
     <li class="itemize">enum <a 
href="#bytecode__api_8h_ac2cd51dc61c1ddf642d596c7f73a6999">FunctionalityLevels</a>
     </li>
     <li class="itemize">enum <a 
href="#bytecode__api_8h_a8146b4e22199a811df993111bc8afc45">pdf_phase</a>
     </li>
     <li class="itemize">enum <a 
href="#bytecode__api_8h_a5597245ed8666431babaa5371fe7e009">pdf_flag</a>
     </li>
     <li class="itemize">enum <a 
href="#bytecode__api_8h_abf356e8393462916811603aaf950bf0a">pdf_objflags</a>
     </li>
     <li class="itemize">enum { <a 
href="#bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7a7f53e3798ec48e79c0897ba5138f9b05">SEEK_SET</a> = 0, <a 
href="#bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7af3091144c125782cf17bcd3eb84e454c">SEEK_CUR</a>, <a 
href="#bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7a060e45245be703e272d7264bafcfdc63">SEEK_END</a> }</li></ul>
<a 
 id="Q1-1-219"></a>
<h5 class="likesubsubsectionHead"><a 
 id="x1-1970001"></a>Functions</h5>
     <ul class="itemize1">
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_af445932f85a581e254806f034225ecf1">test1</a> (uint32_t a, uint32_t b)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_afa4f1c799291804204aea54ce23077d6">read</a> (uint8_t <span 
class="lmsy-10">&lowast;</span>data, int32_t size)
       <dl class="list2"><dt class="list">
       </dt><dd 
class="list">
                                                                                

                                                                                
       <!--l. 35--><p class="noindent" ><span 
class="ec-lmri-9">Reads specified amount of bytes from the current file into a buffer. Also moves current position</span>
       <span 
class="ec-lmri-9">in the file.</span></dd></dl>
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a01d98e416d08e0eabd02d2e8aa56f28e">write</a> (uint8_t <span 
class="lmsy-10">&lowast;</span>data, int32_t size)
       <dl class="list2"><dt class="list">
       </dt><dd 
class="list">
       <!--l. 37--><p class="noindent" ><span 
class="ec-lmri-9">Writes the specified amount of bytes from a buffer to the current temporary file.</span></dd></dl>
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_aac5ea598a656985291c56321ad2140ea">seek</a> (int32_t pos, uint32_t whence)
       <dl class="list2"><dt class="list">
       </dt><dd 
class="list">
       <!--l. 39--><p class="noindent" ><span 
class="ec-lmri-9">Changes the current file position to the specified one.</span></dd></dl>
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a77cd19560715e7a2f658fc3ac519d18e">setvirusname</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>name, uint32_t len)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_aa6d82179ea15d32450fefbc6d1bd8934">debug_print_str</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>str, uint32_t len)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a6e0cdd4d4c76ed46a8627bee56eee1c1">debug_print_uint</a> (uint32_t a)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a95e7d1048a56c98dec19335a6aa7afca">disasm_x86</a> (struct <a 
href="#struct_d_i_s_a_s_m___r_e_s_u_l_t">DISASM_RESULT</a> <span 
class="lmsy-10">&lowast;</span>result, uint32_t len)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a0d081f8f58263eb99d68690f1f9b2a81">pe_rawaddr</a> (uint32_t rva)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a56355a07d9fb739dd483dd756f7fe821">file_find</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>data, uint32_t len)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a1e192cd4fe94e68dbac5023a1e2481c9">file_byteat</a> (uint32_t offset)
     </li>
     <li class="itemize">void <span 
class="lmsy-10">&lowast; </span><a 
href="#bytecode__api_8h_a8704c31c2d7a73953f3c1c320447c24a">malloc</a> (uint32_t size)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_abf709b9bcdfd2da159ec288df9dc7ad9">test2</a> (uint32_t a)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_ae7e5e9cef42c34a52cfe814910a1e293">get_pe_section</a> (struct <a 
href="#structcli__exe__section">cli_exe_section</a> <span 
class="lmsy-10">&lowast;</span>section, uint32_t num)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a5c25c11f12899883af10f3ba75cfc5c5">fill_buffer</a> (uint8_t <span 
class="lmsy-10">&lowast;</span>buffer, uint32_t len, uint32_t filled, uint32_t cursor, uint32_t
     fill)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_aed98502eb13f9e2209d9c6b1620eb17a">extract_new</a> (int32_t id)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a50b84b15fbaf03aa39b41ef7ffb5243e">read_number</a> (uint32_t radix)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_ab791b1626efae568e0fb62c36ce8aa74">hashset_new</a> (void)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_adb42ee13e5883410846a392513d6866b">hashset_add</a> (int32_t hs, uint32_t key)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a06c14cce8ec4cc839a02094547964a00">hashset_remove</a> (int32_t hs, uint32_t key)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a0907920e08ec8e80f3ff829e8aaf58de">hashset_contains</a> (int32_t hs, uint32_t key)
                                                                                

                                                                                
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_abd5e701c80bf5346a72fb145834b865a">hashset_done</a> (int32_t id)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a854fcc65ad8cc0578c55aea6bc88b193">hashset_empty</a> (int32_t id)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_ae755b425ff65feddef7b86092dcdeed7">buffer_pipe_new</a> (uint32_t size)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_adccae1152247859c54706b7d1753b689">buffer_pipe_new_fromfile</a> (uint32_t pos)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a53de1d976b1536c5b6a0d5d31de201b2">buffer_pipe_read_avail</a> (int32_t id)
     </li>
     <li class="itemize">uint8_t <span 
class="lmsy-10">&lowast; </span><a 
href="#bytecode__api_8h_ac4df62495f080f7885911d71c6a379c7">buffer_pipe_read_get</a> (int32_t id, uint32_t amount)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_ae67b360d1ab3c9dc4ac9d0f90208f6fe">buffer_pipe_read_stopped</a> (int32_t id, uint32_t amount)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a1b9d87fbb40620d92b57549e24b189e6">buffer_pipe_write_avail</a> (int32_t id)
     </li>
     <li class="itemize">uint8_t <span 
class="lmsy-10">&lowast; </span><a 
href="#bytecode__api_8h_a8268aaabee12eed25ab561f678128ddd">buffer_pipe_write_get</a> (int32_t id, uint32_t size)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a57b76f82f0fb9bdabaad6c3d98037e94">buffer_pipe_write_stopped</a> (int32_t id, uint32_t amount)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a984890c1d3b68b99e68c2e6b1a7704d0">buffer_pipe_done</a> (int32_t id)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a65eec3722a1e992e9e4104c037503fdc">inflate_init</a> (int32_t from_buffer, int32_t to_buffer, int32_t windowBits)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a10ad344e58c26566defe1780b303f0a4">inflate_process</a> (int32_t id)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a123c12ca76a5b736217b68fdb126066e">inflate_done</a> (int32_t id)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_ad7ea886d4274f1f389acf0d5cdc50b7d">bytecode_rt_error</a> (int32_t locationid)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_afb97628e1638c524b0cf45190403553d">jsnorm_init</a> (int32_t from_buffer)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a5c0da722aa4ccb9618052c5a2361ed8e">jsnorm_process</a> (int32_t id)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a7445bceea42b0a4d1d841b2c8826db4a">jsnorm_done</a> (int32_t id)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a59893a4520a13171c94d6ce63fce6c4b">ilog2</a> (uint32_t a, uint32_t b)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_abd69b1aa30157a6d87658db53ece8f5a">ipow</a> (int32_t a, int32_t b, int32_t c)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a5d986d8e22cce16cfd2bb0cef0ac111e">iexp</a> (int32_t a, int32_t b, int32_t c)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_acca08245d3d1a190375a92d5c51b2a90">isin</a> (int32_t a, int32_t b, int32_t c)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a6aeece8bfb39a8499b44d67c8bebb716">icos</a> (int32_t a, int32_t b, int32_t c)
                                                                                

                                                                                
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a5d46e3fbbec8277f894d998a9b0dfdbc">memstr</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>haystack, int32_t haysize, const uint8_t <span 
class="lmsy-10">&lowast;</span>needle, int32_t
     needlesize)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a231265b2ef73573c38d51a385697ae57">hex2ui</a> (uint32_t hex1, uint32_t hex2)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_aa07799442f1560666449446eac438ee4">atoi</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>str, int32_t size)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a43707290a22915315c960422a88ba4d4">debug_print_str_start</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>str, uint32_t len)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a02f173e084fc9a4b9eaf3017aa4243ba">debug_print_str_nonl</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>str, uint32_t len)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a2df1f1f4823085b4956f1bce3f5b059c">entropy_buffer</a> (uint8_t <span 
class="lmsy-10">&lowast;</span>buffer, int32_t size)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a8350ff5a10c6d2b8aa5c9b20bd0b032f">map_new</a> (int32_t keysize, int32_t valuesize)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a962d8bc4658ba7dd411c75d7561c2fee">map_addkey</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>key, int32_t ksize, int32_t id)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_afdae99c4fa909e017962e8b869950005">map_setvalue</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>value, int32_t vsize, int32_t id)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_aeadbaac505160a820fe766cdaf95aba6">map_remove</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>key, int32_t ksize, int32_t id)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_ac45a2c7ac861578b8001b2116eee10aa">map_find</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>key, int32_t ksize, int32_t id)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_aac4176bebb0d4896ad64452bec023012">map_getvaluesize</a> (int32_t id)
     </li>
     <li class="itemize">uint8_t <span 
class="lmsy-10">&lowast; </span><a 
href="#bytecode__api_8h_a6a8bbb58c0ccad537eec575949e5f9f7">map_getvalue</a> (int32_t id, int32_t size)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a2603885df2096dc840d887461c3b1aac">map_done</a> (int32_t id)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_ad7479f2fd346e59217f50726be9502a3">file_find_limit</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>data, uint32_t len, int32_t maxpos)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_addc54afadb3d660c92e4e350548086d8">engine_functionality_level</a> (void)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a4fa59c900fefd4a4441fcc4b3e44830d">engine_dconf_level</a> (void)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a0cd507ebdbadaa5899ca032cb5f69e3c">engine_scan_options</a> (void)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_afc1eab4e86797378b5c1e7186894c1a7">engine_db_options</a> (void)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a0f6e898d3a55355835fccb1f6d15abc1">extract_set_container</a> (uint32_t container)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a86179c9beb10be3f66cb5cae9902fec3">input_switch</a> (int32_t extracted_file)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a4e38f5731d8d7578399d6bcf97ec1a27">get_environment</a> (struct cli_environment <span 
class="lmsy-10">&lowast;</span>env, uint32_t len)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a1b9af8b47763bc3e2d0323a605209702">disable_bytecode_if</a> (const int8_t <span 
class="lmsy-10">&lowast;</span>reason, uint32_t len, uint32_t cond)
                                                                                

                                                                                
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_acccb9f64252a40f3857007f0e382f8eb">disable_jit_if</a> (const int8_t <span 
class="lmsy-10">&lowast;</span>reason, uint32_t len, uint32_t cond)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a18a8ecdd5235c80782b7e3e1892553ef">version_compare</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>lhs, uint32_t lhs_len, const uint8_t <span 
class="lmsy-10">&lowast;</span>rhs, uint32_t
     rhs_len)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a9b52373152ee8dd8fd45ea6b242e5698">check_platform</a> (uint32_t a, uint32_t b, uint32_t c)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_aca9074092cae6ed378ffdc5ba7cfc77e">pdf_get_obj_num</a> (void)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a854b697b5e662b79c5931a7864ce0709">pdf_get_flags</a> (void)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a1524216162135a13acfecc0cbc82ac03">pdf_set_flags</a> (int32_t flags)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a06f5560acc053270453250c387692068">pdf_lookupobj</a> (uint32_t id)
     </li>
     <li class="itemize">uint32_t <a 
href="#bytecode__api_8h_a0270605365fe5bb2f721eefe6f703255">pdf_getobjsize</a> (int32_t objidx)
     </li>
     <li class="itemize">uint8_t <span 
class="lmsy-10">&lowast; </span><a 
href="#bytecode__api_8h_a6504bd64de6bee96e9606260753a6ac0">pdf_getobj</a> (int32_t objidx, uint32_t amount)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_af7eb372ae4bc42a552e543ea2a306f5e">pdf_get_phase</a> (void)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_aaa88ff051b0da6314c9655da624bb0f5">pdf_get_dumpedobjid</a> (void)
     </li>
     <li class="itemize">int32_t <a 
href="#bytecode__api_8h_a8e0bc8430adb57c0808bbf916e49185f">matchicon</a> (const uint8_t <span 
class="lmsy-10">&lowast;</span>group1, int32_t group1_len, const uint8_t <span 
class="lmsy-10">&lowast;</span>group2, int32_t
     group2_len)</li></ul>
<a 
 id="Q1-1-221"></a>
<h5 class="likesubsubsectionHead"><a 
 id="x1-1980001"></a>Variables</h5>
     <ul class="itemize1">
     <li class="itemize">const uint32_t <a 
href="#bytecode__api_8h_a35a0a4f1219a792c77b7207924c3c4ec">__clambc_match_counts</a> [64]
       <dl class="list2"><dt class="list">
       </dt><dd 
class="list">
       <!--l. 194--><p class="noindent" ><span 
class="ec-lmri-9">Logical signature match counts.</span></dd></dl>
     </li>
     <li class="itemize">const uint32_t <a 
href="#bytecode__api_8h_ae39872934c5879706b3cedaef090d227">__clambc_match_offsets</a> [64]
       <dl class="list2"><dt class="list">
       </dt><dd 
class="list">
       <!--l. 196--><p class="noindent" ><span 
class="ec-lmri-9">Logical signature match offsets This is a low-level variable, use the Macros in </span><a 
href="#bytecode__local_8h"><span 
class="ec-lmri-9">bytecode_local.h</span></a>
       <span 
class="ec-lmri-9">instead to access it.</span></dd></dl>
     </li>
     <li class="itemize">struct <a 
href="#structcli__pe__hook__data">cli_pe_hook_data</a> <a 
href="#bytecode__api_8h_a3d386181912bdbc2b90ee559b0cccde3">__clambc_pedata</a>
     </li>
     <li class="itemize">const uint32_t <a 
href="#bytecode__api_8h_ab8d6c50474be3ba69906161a3e520ce7">__clambc_filesize</a> [1]
     </li>
     <li class="itemize">const uint16_t <a 
href="#bytecode__api_8h_a6eb3802e21949cfdf6b91570d3c62c99">__clambc_kind</a></li></ul>
<a 
 id="x1-198001r207"></a>
                                                                                

                                                                                
<h5 class="subsubsectionHead"><span class="titlemark">7.3.1.1. </span> <a 
 id="x1-1990001"></a>Detailed Description</h5>
<a 
 id="x1-199001r223"></a>
<h5 class="subsubsectionHead"><span class="titlemark">7.3.1.2. </span> <a 
 id="x1-2000002"></a>Enumeration Type Documentation</h5>
<!--l. 210--><p class="noindent" ><a 
 id="bytecode__api_8h_a06fc87d81c62e9abb8790b6e5713c55b">
<!--l. 210--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-2010007.3.1.2.1"></a><span 
class="ec-lmbx-10">anonymous enum</span></span>
</a>
    <dl class="list1"><dt class="list">
<span 
class="ec-lmbx-10">Enumerator:</span>
    </dt><dd 
class="list">
    <!--l. 213--><p class="noindent" >
        <dl class="description"><dt class="description">
    <a 
 id="bytecode__api_8h_a06fc87d81c62e9abb8790b6e5713c55bacb5d73f23c5c13bca1ae5fdfbaa22d43"> <span 
class="ec-lmbxi-10">PE_INVALID_RVA</span></a>   </dt><dd 
class="description">Invalid RVA specified</dd></dl>
    </dd></dl>
<!--l. 223--><p class="noindent" ><a 
 id="bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7">
<!--l. 223--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-2020007.3.1.2.2"></a><span 
class="ec-lmbx-10">anonymous enum</span></span>
</a>
    <dl class="list1"><dt class="list">
<span 
class="ec-lmbx-10">Enumerator:</span>
    </dt><dd 
class="list">
    <!--l. 226--><p class="noindent" >
        <dl class="description"><dt class="description">
    <a 
 id="bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7a7f53e3798ec48e79c0897ba5138f9b05"> <span 
class="ec-lmbxi-10">SEEK_SET</span></a>   </dt><dd 
class="description">set file position to specified absolute position
        </dd><dt class="description">
    <a 
 id="bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7af3091144c125782cf17bcd3eb84e454c"> <span 
class="ec-lmbxi-10">SEEK_CUR</span></a>   </dt><dd 
class="description">set file position relative to current position
        </dd><dt class="description">
    <a 
 id="bytecode__api_8h_adf764cbdea00d65edcd07bb9953ad2b7a060e45245be703e272d7264bafcfdc63"> <span 
class="ec-lmbxi-10">SEEK_END</span></a>   </dt><dd 
class="description">set file position relative to file end</dd></dl>
    </dd></dl>
<!--l. 246--><p class="noindent" ><a 
 id="bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91">
<!--l. 246--><p class="noindent" ><span class="paragraphHead"><a 
 id="x1-2030007.3.1.2.3"></a><span 
class="ec-lmbx-10">enum BytecodeKind</span></span>
</a> Bytecode trigger kind
    <dl class="list1"><dt class="list">
<span 
class="ec-lmbx-10">Enumerator:</span>
    </dt><dd 
class="list">
    <!--l. 249--><p class="noindent" >
        <dl class="description"><dt class="description">
    <a 
 id="bytecode__api_8h_a108e33201873c25ef45b59b519f1ff91aff84fbd05d167a1cf9e146d155ac90b7"> <span 
class="ec-lmbxi-10">BC_GENERIC</span></a>   </dt><dd 
class="description">generic bytecode, not tied a specific hook
                                                                                


